<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Addressable::URI</title>

	<link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

	<script src="../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../lib/addressable/uri_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/addressable/uri.rb">lib/addressable/uri.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			
			<div id="namespace-list-section" class="section">
				<h3 class="section-header">Namespace</h3>
				<ul class="link-list">
					
					<li><span class="type">MODULE</span> <a href="URI/CharacterClasses.html">Addressable::URI::CharacterClasses</a></li>
					
					<li><span class="type">CLASS</span> <a href="URI/InvalidURIError.html">Addressable::URI::InvalidURIError</a></li>
					
				</ul>
			</div>
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-convert_path">::convert_path</a></li>
					
					<li><a href="#method-c-encode">::encode</a></li>
					
					<li><a href="#method-c-encode_component">::encode_component</a></li>
					
					<li><a href="#method-c-form_encode">::form_encode</a></li>
					
					<li><a href="#method-c-form_unencode">::form_unencode</a></li>
					
					<li><a href="#method-c-heuristic_parse">::heuristic_parse</a></li>
					
					<li><a href="#method-c-ip_based_schemes">::ip_based_schemes</a></li>
					
					<li><a href="#method-c-join">::join</a></li>
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-c-normalize_component">::normalize_component</a></li>
					
					<li><a href="#method-c-normalize_path">::normalize_path</a></li>
					
					<li><a href="#method-c-normalized_encode">::normalized_encode</a></li>
					
					<li><a href="#method-c-parse">::parse</a></li>
					
					<li><a href="#method-c-port_mapping">::port_mapping</a></li>
					
					<li><a href="#method-c-unencode">::unencode</a></li>
					
					<li><a href="#method-i-%2B">#+</a></li>
					
					<li><a href="#method-i-%3D%3D">#==</a></li>
					
					<li><a href="#method-i-%3D%3D%3D">#===</a></li>
					
					<li><a href="#method-i-absolute%3F">#absolute?</a></li>
					
					<li><a href="#method-i-authority">#authority</a></li>
					
					<li><a href="#method-i-authority%3D">#authority=</a></li>
					
					<li><a href="#method-i-basename">#basename</a></li>
					
					<li><a href="#method-i-defer_validation">#defer_validation</a></li>
					
					<li><a href="#method-i-display_uri">#display_uri</a></li>
					
					<li><a href="#method-i-dup">#dup</a></li>
					
					<li><a href="#method-i-eql%3F">#eql?</a></li>
					
					<li><a href="#method-i-extname">#extname</a></li>
					
					<li><a href="#method-i-fragment">#fragment</a></li>
					
					<li><a href="#method-i-fragment%3D">#fragment=</a></li>
					
					<li><a href="#method-i-freeze">#freeze</a></li>
					
					<li><a href="#method-i-hash">#hash</a></li>
					
					<li><a href="#method-i-host">#host</a></li>
					
					<li><a href="#method-i-host%3D">#host=</a></li>
					
					<li><a href="#method-i-hostname">#hostname</a></li>
					
					<li><a href="#method-i-hostname%3D">#hostname=</a></li>
					
					<li><a href="#method-i-inferred_port">#inferred_port</a></li>
					
					<li><a href="#method-i-inspect">#inspect</a></li>
					
					<li><a href="#method-i-ip_based%3F">#ip_based?</a></li>
					
					<li><a href="#method-i-join">#join</a></li>
					
					<li><a href="#method-i-join%21">#join!</a></li>
					
					<li><a href="#method-i-merge">#merge</a></li>
					
					<li><a href="#method-i-merge%21">#merge!</a></li>
					
					<li><a href="#method-i-normalize">#normalize</a></li>
					
					<li><a href="#method-i-normalize%21">#normalize!</a></li>
					
					<li><a href="#method-i-normalized_authority">#normalized_authority</a></li>
					
					<li><a href="#method-i-normalized_fragment">#normalized_fragment</a></li>
					
					<li><a href="#method-i-normalized_host">#normalized_host</a></li>
					
					<li><a href="#method-i-normalized_password">#normalized_password</a></li>
					
					<li><a href="#method-i-normalized_path">#normalized_path</a></li>
					
					<li><a href="#method-i-normalized_port">#normalized_port</a></li>
					
					<li><a href="#method-i-normalized_query">#normalized_query</a></li>
					
					<li><a href="#method-i-normalized_scheme">#normalized_scheme</a></li>
					
					<li><a href="#method-i-normalized_site">#normalized_site</a></li>
					
					<li><a href="#method-i-normalized_user">#normalized_user</a></li>
					
					<li><a href="#method-i-normalized_userinfo">#normalized_userinfo</a></li>
					
					<li><a href="#method-i-omit">#omit</a></li>
					
					<li><a href="#method-i-omit%21">#omit!</a></li>
					
					<li><a href="#method-i-origin">#origin</a></li>
					
					<li><a href="#method-i-password">#password</a></li>
					
					<li><a href="#method-i-password%3D">#password=</a></li>
					
					<li><a href="#method-i-path">#path</a></li>
					
					<li><a href="#method-i-path%3D">#path=</a></li>
					
					<li><a href="#method-i-port">#port</a></li>
					
					<li><a href="#method-i-port%3D">#port=</a></li>
					
					<li><a href="#method-i-query">#query</a></li>
					
					<li><a href="#method-i-query%3D">#query=</a></li>
					
					<li><a href="#method-i-query_values">#query_values</a></li>
					
					<li><a href="#method-i-query_values%3D">#query_values=</a></li>
					
					<li><a href="#method-i-relative%3F">#relative?</a></li>
					
					<li><a href="#method-i-replace_self">#replace_self</a></li>
					
					<li><a href="#method-i-request_uri">#request_uri</a></li>
					
					<li><a href="#method-i-request_uri%3D">#request_uri=</a></li>
					
					<li><a href="#method-i-route_from">#route_from</a></li>
					
					<li><a href="#method-i-route_to">#route_to</a></li>
					
					<li><a href="#method-i-scheme">#scheme</a></li>
					
					<li><a href="#method-i-scheme%3D">#scheme=</a></li>
					
					<li><a href="#method-i-site">#site</a></li>
					
					<li><a href="#method-i-site%3D">#site=</a></li>
					
					<li><a href="#method-i-to_hash">#to_hash</a></li>
					
					<li><a href="#method-i-to_s">#to_s</a></li>
					
					<li><a href="#method-i-to_str">#to_str</a></li>
					
					<li><a href="#method-i-user">#user</a></li>
					
					<li><a href="#method-i-user%3D">#user=</a></li>
					
					<li><a href="#method-i-userinfo">#userinfo</a></li>
					
					<li><a href="#method-i-userinfo%3D">#userinfo=</a></li>
					
					<li><a href="#method-i-validate">#validate</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../Addressable.html">Addressable</a></li>
				
					<li><a href="../Addressable/IDNA.html">Addressable::IDNA</a></li>
				
					<li><a href="../Addressable/IDNA/PunycodeBadInput.html">Addressable::IDNA::PunycodeBadInput</a></li>
				
					<li><a href="../Addressable/IDNA/PunycodeBigOutput.html">Addressable::IDNA::PunycodeBigOutput</a></li>
				
					<li><a href="../Addressable/IDNA/PunycodeOverflow.html">Addressable::IDNA::PunycodeOverflow</a></li>
				
					<li><a href="../Addressable/Template.html">Addressable::Template</a></li>
				
					<li><a href="../Addressable/Template/InvalidTemplateOperatorError.html">Addressable::Template::InvalidTemplateOperatorError</a></li>
				
					<li><a href="../Addressable/Template/InvalidTemplateValueError.html">Addressable::Template::InvalidTemplateValueError</a></li>
				
					<li><a href="../Addressable/Template/MatchData.html">Addressable::Template::MatchData</a></li>
				
					<li><a href="../Addressable/Template/TemplateOperatorAbortedError.html">Addressable::Template::TemplateOperatorAbortedError</a></li>
				
					<li><a href="../Addressable/URI.html">Addressable::URI</a></li>
				
					<li><a href="../Addressable/URI/CharacterClasses.html">Addressable::URI::CharacterClasses</a></li>
				
					<li><a href="../Addressable/URI/InvalidURIError.html">Addressable::URI::InvalidURIError</a></li>
				
					<li><a href="../Addressable/VERSION.html">Addressable::VERSION</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Addressable::URI</h1>

		<div id="description">
			<p>
This is an implementation of a <a href="URI.html">URI</a> parser based on
<a href=&#8220;<a
href="http://www.ietf.org/rfc/rfc3986.txt">RFC">www.ietf.org/rfc/rfc3986.txt">RFC</a>
3986</a>, <a href=&#8220;<a
href="http://www.ietf.org/rfc/rfc3987.txt">RFC">www.ietf.org/rfc/rfc3987.txt">RFC</a>
3987</a>.
</p>

		</div>

		<!-- Constants -->
		
		<div id="constants-list" class="section">
			<h3 class="section-header">Constants</h3>
			<dl>
			
				<dt><a name="SLASH">SLASH</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="EMPTY_STR">EMPTY_STR</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="URIREGEX">URIREGEX</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="PORT_MAPPING">PORT_MAPPING</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="NORMPATH">NORMPATH</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="SELF_REF">SELF_REF</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="PARENT">PARENT</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="RULE_2A">RULE_2A</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="RULE_2B_2C">RULE_2B_2C</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="RULE_2D">RULE_2D</a></dt>
				
				<dd class="description"></dd>
				
			
				<dt><a name="RULE_PREFIXED_PARENT">RULE_PREFIXED_PARENT</a></dt>
				
				<dd class="description"></dd>
				
			
			</dl>
		</div>
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="convert-path-method" class="method-detail ">
				<a name="method-c-convert_path"></a>

				<div class="method-heading">
				
					<span class="method-name">convert_path</span><span
						class="method-args">(path)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Converts a path to a file scheme <a href="URI.html">URI</a>. If the path
supplied is relative, it will be returned as a relative <a
href="URI.html">URI</a>. If the path supplied is actually a non-file <a
href="URI.html">URI</a>, it will parse the <a href="URI.html">URI</a> as if
it had been parsed with <tt>Addressable::URI.parse</tt>. Handles all of the
various Microsoft-specific formats for specifying paths.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] path
</p>
<pre>
  Typically a &lt;code&gt;String&lt;/code&gt; path to a file or directory, but
  will return a sensible return value if an absolute URI is supplied
  instead.
</pre>
<p>
@return [Addressable::URI]
</p>
<pre>
  The parsed file scheme URI or the original URI if some other URI
  scheme was provided.
</pre>
<p>
@example
</p>
<pre>
  base = Addressable::URI.convert_path(&quot;/absolute/path/&quot;)
  uri = Addressable::URI.convert_path(&quot;relative/path&quot;)
  (base + uri).to_s
  #=&gt; &quot;file:///absolute/path/relative/path&quot;

  Addressable::URI.convert_path(
    &quot;c:\\windows\\My Documents 100%20\\foo.txt&quot;
  ).to_s
  #=&gt; &quot;file:///c:/windows/My%20Documents%20100%20/foo.txt&quot;

  Addressable::URI.convert_path(&quot;http://example.com/&quot;).to_s
  #=&gt; &quot;http://example.com/&quot;</pre>
					

					
					<div class="method-source-code"
						id="convert-path-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 229</span>
229:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">convert_path</span>(<span class="ruby-identifier">path</span>)
230:       <span class="ruby-comment cmt"># If we were given nil, return nil.</span>
231:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">path</span>
232:       <span class="ruby-comment cmt"># If a URI object is passed, just return itself.</span>
233:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>)
234:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">path</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
235:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{path.class} into String.&quot;</span>
236:       <span class="ruby-keyword kw">end</span>
237:       <span class="ruby-comment cmt"># Otherwise, convert to a String</span>
238:       <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>
239: 
240:       <span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^file:\/?\/?/</span>, <span class="ruby-constant">EMPTY_STR</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^file:\/?\/?/</span>
241:       <span class="ruby-identifier">path</span> = <span class="ruby-constant">SLASH</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">path</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^([a-zA-Z])[\|:]/</span>
242:       <span class="ruby-identifier">uri</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">path</span>)
243: 
244:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
245:         <span class="ruby-comment cmt"># Adjust windows-style uris</span>
246:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^\/?([a-zA-Z])[\|:][\\\/]/</span>) <span class="ruby-keyword kw">do</span>
247:           <span class="ruby-node">&quot;/#{$1.downcase}:/&quot;</span>
248:         <span class="ruby-keyword kw">end</span>
249:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\\/</span>, <span class="ruby-constant">SLASH</span>)
250:         <span class="ruby-keyword kw">if</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>) <span class="ruby-operator">&amp;&amp;</span>
251:             <span class="ruby-constant">File</span>.<span class="ruby-identifier">stat</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>).<span class="ruby-identifier">directory?</span>
252:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\/$/</span>, <span class="ruby-constant">EMPTY_STR</span>)
253:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">+</span> <span class="ruby-value str">'/'</span>
254:         <span class="ruby-keyword kw">end</span>
255: 
256:         <span class="ruby-comment cmt"># If the path is absolute, set the scheme and host.</span>
257:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\//</span>
258:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-value str">&quot;file&quot;</span>
259:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> = <span class="ruby-constant">EMPTY_STR</span>
260:         <span class="ruby-keyword kw">end</span>
261:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize!</span>
262:       <span class="ruby-keyword kw">end</span>
263: 
264:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">uri</span>
265:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="encode-method" class="method-detail ">
				<a name="method-c-encode"></a>

				<div class="method-heading">
				
					<span class="method-name">encode</span><span
						class="method-args">(uri, returning=String)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Percent encodes any special characters in the <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri
</p>
<pre>
  The URI to encode.
</pre>
<p>
@param [Class] returning
</p>
<pre>
  The type of object to return.
  This value may only be set to &lt;code&gt;String&lt;/code&gt; or
  &lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
  to &lt;code&gt;String&lt;/code&gt;.
</pre>
<p>
@return [String, Addressable::URI]
</p>
<pre>
  The encoded URI.
  The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
					

					
					<div class="method-source-code"
						id="encode-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 490</span>
490:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
491:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">nil?</span>
492: 
493:       <span class="ruby-keyword kw">begin</span>
494:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
495:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
496:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
497:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
498: 
499:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
500:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
501:           <span class="ruby-value str">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
502:           <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
503:       <span class="ruby-keyword kw">end</span>
504:       <span class="ruby-identifier">uri_object</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
505:       <span class="ruby-identifier">encoded_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
506:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">scheme</span>,
507:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>),
508:         <span class="ruby-value">:authority</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">authority</span>,
509:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">AUTHORITY</span>),
510:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">path</span>,
511:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH</span>),
512:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">query</span>,
513:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>),
514:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">fragment</span>,
515:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>)
516:       )
517:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
518:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">encoded_uri</span>.<span class="ruby-identifier">to_s</span>
519:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
520:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">encoded_uri</span>
521:       <span class="ruby-keyword kw">end</span>
522:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="encode-component-method" class="method-detail ">
				<a name="method-c-encode_component"></a>

				<div class="method-heading">
				
					<span class="method-name">encode_component</span><span
						class="method-args">(component, character_class= CharacterClasses::RESERVED + CharacterClasses::UNRESERVED)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Percent encodes a <a href="URI.html">URI</a> component.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] component The <a
href="URI.html">URI</a> component to encode.
</p>
<p>
@param [String, Regexp] character_class
</p>
<pre>
  The characters which are not percent encoded. If a &lt;code&gt;String&lt;/code&gt;
  is passed, the &lt;code&gt;String&lt;/code&gt; must be formatted as a regular
  expression character class. (Do not include the surrounding square
  brackets.)  For example, &lt;code&gt;&quot;b-zB-Z0-9&quot;&lt;/code&gt; would cause
  everything but the letters 'b' through 'z' and the numbers '0' through
 '9' to be percent encoded. If a &lt;code&gt;Regexp&lt;/code&gt; is passed, the
  value &lt;code&gt;/[^b-zB-Z0-9]/&lt;/code&gt; would have the same effect. A set of
  useful &lt;code&gt;String&lt;/code&gt; values may be found in the
  &lt;code&gt;Addressable::URI::CharacterClasses&lt;/code&gt; module. The default
  value is the reserved plus unreserved character classes specified in
  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3986.txt&quot;&gt;RFC 3986&lt;/a&gt;.
</pre>
<p>
@return [String] The encoded component.
</p>
<p>
@example
</p>
<pre>
  Addressable::URI.encode_component(&quot;simple/example&quot;, &quot;b-zB-Z0-9&quot;)
  =&gt; &quot;simple%2Fex%61mple&quot;
  Addressable::URI.encode_component(&quot;simple/example&quot;, /[^b-zB-Z0-9]/)
  =&gt; &quot;simple%2Fex%61mple&quot;
  Addressable::URI.encode_component(
    &quot;simple/example&quot;, Addressable::URI::CharacterClasses::UNRESERVED
  )
  =&gt; &quot;simple%2Fexample&quot;</pre>
					

					
					<div class="method-source-code"
						id="encode-component-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 323</span>
323:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">component</span>, <span class="ruby-identifier">character_class</span>=
324:         <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">RESERVED</span> <span class="ruby-operator">+</span> <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>)
325:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">nil?</span>
326: 
327:       <span class="ruby-keyword kw">begin</span>
328:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Symbol</span>) <span class="ruby-operator">||</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Numeric</span>)
329:           <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_s</span>
330:         <span class="ruby-keyword kw">else</span>
331:           <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_str</span>
332:         <span class="ruby-keyword kw">end</span>
333:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-constant">NoMethodError</span>
334:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{component.class} into String.&quot;</span>
335:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">component</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
336: 
337:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-constant">Regexp</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">class</span>)
338:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
339:           <span class="ruby-node">&quot;Expected String or Regexp, got #{character_class.inspect}&quot;</span>
340:       <span class="ruby-keyword kw">end</span>
341:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
342:         <span class="ruby-identifier">character_class</span> = <span class="ruby-node">/[^#{character_class}]/</span>
343:       <span class="ruby-keyword kw">end</span>
344:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
345:         <span class="ruby-comment cmt"># We can't perform regexps on invalid UTF sequences, but</span>
346:         <span class="ruby-comment cmt"># here we need to, so switch to ASCII.</span>
347:         <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">dup</span>
348:         <span class="ruby-identifier">component</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span>)
349:       <span class="ruby-keyword kw">end</span>
350:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-identifier">character_class</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sequence</span><span class="ruby-operator">|</span>
351:         (<span class="ruby-identifier">sequence</span>.<span class="ruby-identifier">unpack</span>(<span class="ruby-value str">'C*'</span>).<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-value str">&quot;%&quot;</span> <span class="ruby-operator">+</span> (<span class="ruby-value str">&quot;%02x&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">c</span>).<span class="ruby-identifier">upcase</span> }).<span class="ruby-identifier">join</span>
352:       <span class="ruby-keyword kw">end</span>
353:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="form-encode-method" class="method-detail ">
				<a name="method-c-form_encode"></a>

				<div class="method-heading">
				
					<span class="method-name">form_encode</span><span
						class="method-args">(form_values, sort=false)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Encodes a set of key/value pairs according to the rules for the
<tt>application/x-www-form-urlencoded</tt> MIME type.
</p>
<p>
@param [<a href="URI.html#method-i-to_hash">#</a>, #] form_values
</p>
<pre>
  The form values to encode.
</pre>
<p>
@param [TrueClass, FalseClass] sort
</p>
<pre>
  Sort the key/value pairs prior to encoding.
  Defaults to &lt;code&gt;false&lt;/code&gt;.
</pre>
<p>
@return [String]
</p>
<pre>
  The encoded value.</pre>
					

					
					<div class="method-source-code"
						id="form-encode-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 614</span>
614:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">form_encode</span>(<span class="ruby-identifier">form_values</span>, <span class="ruby-identifier">sort</span>=<span class="ruby-keyword kw">false</span>)
615:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
616:         <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">to_hash</span>.<span class="ruby-identifier">to_a</span>
617:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_ary</span>)
618:         <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">to_ary</span>
619:       <span class="ruby-keyword kw">else</span>
620:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{form_values.class} into Array.&quot;</span>
621:       <span class="ruby-keyword kw">end</span>
622: 
623:       <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accu</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
624:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Array</span>)
625:           <span class="ruby-identifier">value</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span>
626:             <span class="ruby-identifier">accu</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_s</span>]
627:           <span class="ruby-keyword kw">end</span>
628:         <span class="ruby-keyword kw">else</span>
629:           <span class="ruby-identifier">accu</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>]
630:         <span class="ruby-keyword kw">end</span>
631:         <span class="ruby-identifier">accu</span>
632:       <span class="ruby-keyword kw">end</span>
633: 
634:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sort</span>
635:         <span class="ruby-comment cmt"># Useful for OAuth and optimizing caching systems</span>
636:         <span class="ruby-identifier">form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">sort</span>
637:       <span class="ruby-keyword kw">end</span>
638:       <span class="ruby-identifier">escaped_form_values</span> = <span class="ruby-identifier">form_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
639:         <span class="ruby-comment cmt"># Line breaks are CRLF pairs</span>
640:         [
641:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(
642:             <span class="ruby-identifier">key</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\r\n|\n|\r)/</span>, <span class="ruby-value str">&quot;\r\n&quot;</span>),
643:             <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
644:           ).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;%20&quot;</span>, <span class="ruby-value str">&quot;+&quot;</span>),
645:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(
646:             <span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\r\n|\n|\r)/</span>, <span class="ruby-value str">&quot;\r\n&quot;</span>),
647:             <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
648:           ).<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;%20&quot;</span>, <span class="ruby-value str">&quot;+&quot;</span>)
649:         ]
650:       <span class="ruby-keyword kw">end</span>
651:       <span class="ruby-keyword kw">return</span> (<span class="ruby-identifier">escaped_form_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
652:         <span class="ruby-node">&quot;#{key}=#{value}&quot;</span>
653:       <span class="ruby-keyword kw">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>)
654:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="form-unencode-method" class="method-detail ">
				<a name="method-c-form_unencode"></a>

				<div class="method-heading">
				
					<span class="method-name">form_unencode</span><span
						class="method-args">(encoded_value)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Decodes a <tt>String</tt> according to the rules for the
<tt>application/x-www-form-urlencoded</tt> MIME type.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] encoded_value
</p>
<pre>
  The form values to decode.
</pre>
<p>
@return [Array]
</p>
<pre>
  The decoded values.
  This is not a &lt;code&gt;Hash&lt;/code&gt; because of the possibility for
  duplicate keys.</pre>
					

					
					<div class="method-source-code"
						id="form-unencode-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 667</span>
667:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">form_unencode</span>(<span class="ruby-identifier">encoded_value</span>)
668:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
669:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{encoded_value.class} into String.&quot;</span>
670:       <span class="ruby-keyword kw">end</span>
671:       <span class="ruby-identifier">encoded_value</span> = <span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">to_str</span>
672:       <span class="ruby-identifier">split_values</span> = <span class="ruby-identifier">encoded_value</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
673:         <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>, <span class="ruby-value">2</span>)
674:       <span class="ruby-keyword kw">end</span>
675:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">split_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
676:         [
677:           <span class="ruby-identifier">key</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(
678:             <span class="ruby-identifier">key</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;+&quot;</span>, <span class="ruby-value str">&quot;%20&quot;</span>)).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\r\n|\n|\r)/</span>, <span class="ruby-value str">&quot;\n&quot;</span>) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
679:           <span class="ruby-identifier">value</span> <span class="ruby-operator">?</span> (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(
680:             <span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot;+&quot;</span>, <span class="ruby-value str">&quot;%20&quot;</span>)).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/(\r\n|\n|\r)/</span>, <span class="ruby-value str">&quot;\n&quot;</span>)) <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
681:         ]
682:       <span class="ruby-keyword kw">end</span>
683:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="heuristic-parse-method" class="method-detail ">
				<a name="method-c-heuristic_parse"></a>

				<div class="method-heading">
				
					<span class="method-name">heuristic_parse</span><span
						class="method-args">(uri, hints={})</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Converts an input to a <a href="URI.html">URI</a>. The input does not have
to be a valid <a href="URI.html">URI</a> â€” the method will use heuristics
to guess what <a href="URI.html">URI</a> was intended. This is not
standards-compliant, merely user-friendly.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri
</p>
<pre>
  The URI string to parse.
  No parsing is performed if the object is already an
  &lt;code&gt;Addressable::URI&lt;/code&gt;.
</pre>
<p>
@param [Hash] hints
</p>
<pre>
  A &lt;code&gt;Hash&lt;/code&gt; of hints to the heuristic parser.
  Defaults to &lt;code&gt;{:scheme =&gt; &quot;http&quot;}&lt;/code&gt;.
</pre>
<p>
@return [Addressable::URI] The parsed <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="heuristic-parse-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 156</span>
156:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">heuristic_parse</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">hints</span>={})
157:       <span class="ruby-comment cmt"># If we were given nil, return nil.</span>
158:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">uri</span>
159:       <span class="ruby-comment cmt"># If a URI object is passed, just return itself.</span>
160:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>)
161:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
162:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
163:       <span class="ruby-keyword kw">end</span>
164:       <span class="ruby-comment cmt"># Otherwise, convert to a String</span>
165:       <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">dup</span>
166:       <span class="ruby-identifier">hints</span> = {
167:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value str">&quot;http&quot;</span>
168:       }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hints</span>)
169:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">uri</span>
170:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^http:\/+/</span>
171:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^http:\/+/</span>, <span class="ruby-value str">&quot;http://&quot;</span>)
172:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^https:\/+/</span>
173:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^https:\/+/</span>, <span class="ruby-value str">&quot;https://&quot;</span>)
174:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^feed:\/+http:\/+/</span>
175:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^feed:\/+http:\/+/</span>, <span class="ruby-value str">&quot;feed:http://&quot;</span>)
176:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^feed:\/+/</span>
177:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^feed:\/+/</span>, <span class="ruby-value str">&quot;feed://&quot;</span>)
178:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^file:\/+/</span>
179:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/^file:\/+/</span>, <span class="ruby-value str">&quot;file:///&quot;</span>)
180:       <span class="ruby-keyword kw">end</span>
181:       <span class="ruby-identifier">parsed</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
182:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-node">/^[^\/?#\.]+\.[^\/?#]+$/</span>
183:         <span class="ruby-identifier">parsed</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">hints</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;://&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>)
184:       <span class="ruby-keyword kw">end</span>
185:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;.&quot;</span>)
186:         <span class="ruby-identifier">new_host</span> = <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>[<span class="ruby-regexp re">/^([^\/]+\.[^\/]*)/</span>, <span class="ruby-value">1</span>]
187:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_host</span>
188:           <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword kw">do</span>
189:             <span class="ruby-identifier">new_path</span> = <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">gsub</span>(
190:               <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;^&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">new_host</span>)), <span class="ruby-constant">EMPTY_STR</span>)
191:             <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">host</span> = <span class="ruby-identifier">new_host</span>
192:             <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">new_path</span>
193:             <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">hints</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">parsed</span>.<span class="ruby-identifier">scheme</span>
194:           <span class="ruby-keyword kw">end</span>
195:         <span class="ruby-keyword kw">end</span>
196:       <span class="ruby-keyword kw">end</span>
197:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">parsed</span>
198:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="ip-based-schemes-method" class="method-detail ">
				<a name="method-c-ip_based_schemes"></a>

				<div class="method-heading">
				
					<span class="method-name">ip_based_schemes</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns an array of known ip-based schemes. These schemes typically use a
similar <a href="URI.html">URI</a> form:
<tt>//&lt;user&gt;:&lt;password&gt;@&lt;host&gt;:&lt;port&gt;/&lt;url-path&gt;</tt>
</p>
					

					
					<div class="method-source-code"
						id="ip-based-schemes-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1137</span>
1137:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">ip_based_schemes</span>
1138:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port_mapping</span>.<span class="ruby-identifier">keys</span>
1139:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="join-method" class="method-detail ">
				<a name="method-c-join"></a>

				<div class="method-heading">
				
					<span class="method-name">join</span><span
						class="method-args">(*uris)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Joins several URIs together.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] *uris
</p>
<pre>
  The URIs to join.
</pre>
<p>
@return [Addressable::URI] The joined <a href="URI.html">URI</a>.
</p>
<p>
@example
</p>
<pre>
  base = &quot;http://example.com/&quot;
  uri = Addressable::URI.parse(&quot;relative/path&quot;)
  Addressable::URI.join(base, uri)
  #=&gt; #&lt;Addressable::URI:0xcab390 URI:http://example.com/relative/path&gt;</pre>
					

					
					<div class="method-source-code"
						id="join-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 280</span>
280:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">join</span>(*<span class="ruby-identifier">uris</span>)
281:       <span class="ruby-identifier">uri_objects</span> = <span class="ruby-identifier">uris</span>.<span class="ruby-identifier">collect</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">uri</span><span class="ruby-operator">|</span>
282:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
283:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
284:         <span class="ruby-keyword kw">end</span>
285:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>)
286:       <span class="ruby-keyword kw">end</span>
287:       <span class="ruby-identifier">result</span> = <span class="ruby-identifier">uri_objects</span>.<span class="ruby-identifier">shift</span>.<span class="ruby-identifier">dup</span>
288:       <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">uri</span> <span class="ruby-keyword kw">in</span> <span class="ruby-identifier">uri_objects</span>
289:         <span class="ruby-identifier">result</span>.<span class="ruby-identifier">join!</span>(<span class="ruby-identifier">uri</span>)
290:       <span class="ruby-keyword kw">end</span>
291:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
292:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(options={})</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Creates a new uri object from component parts.
</p>
<p>
@option [String, <a href="URI.html#method-i-to_str">#</a>] scheme The
scheme component. @option [String, <a
href="URI.html#method-i-to_str">#</a>] user The user component. @option
[String, <a href="URI.html#method-i-to_str">#</a>] password The password
component. @option [String, <a href="URI.html#method-i-to_str">#</a>]
userinfo
</p>
<pre>
  The userinfo component. If this is supplied, the user and password
  components must be omitted.
</pre>
<p>
@option [String, <a href="URI.html#method-i-to_str">#</a>] host The host
component. @option [String, <a href="URI.html#method-i-to_str">#</a>] port
The port component. @option [String, <a
href="URI.html#method-i-to_str">#</a>] authority
</p>
<pre>
  The authority component. If this is supplied, the user, password,
  userinfo, host, and port components must be omitted.
</pre>
<p>
@option [String, <a href="URI.html#method-i-to_str">#</a>] path The path
component. @option [String, <a href="URI.html#method-i-to_str">#</a>] query
The query component. @option [String, <a
href="URI.html#method-i-to_str">#</a>] fragment The fragment component.
</p>
<p>
@return [Addressable::URI] The constructed <a href="URI.html">URI</a>
object.
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 704</span>
704:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">options</span>={})
705:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
706:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:userinfo</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>]).<span class="ruby-identifier">any?</span>
707:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
708:             <span class="ruby-value str">&quot;Cannot specify both an authority and any of the components &quot;</span> <span class="ruby-operator">+</span>
709:             <span class="ruby-value str">&quot;within the authority.&quot;</span>
710:         <span class="ruby-keyword kw">end</span>
711:       <span class="ruby-keyword kw">end</span>
712:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
713:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">options</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>]).<span class="ruby-identifier">any?</span>
714:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
715:             <span class="ruby-value str">&quot;Cannot specify both a userinfo and either the user or password.&quot;</span>
716:         <span class="ruby-keyword kw">end</span>
717:       <span class="ruby-keyword kw">end</span>
718: 
719:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword kw">do</span>
720:         <span class="ruby-comment cmt"># Bunch of crazy logic required because of the composite components</span>
721:         <span class="ruby-comment cmt"># like userinfo and authority.</span>
722:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:scheme</span>]
723:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:user</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:user</span>]
724:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:password</span>]
725:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">userinfo</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:userinfo</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:userinfo</span>]
726:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:host</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:host</span>]
727:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:port</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:port</span>]
728:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:authority</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:authority</span>]
729:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:path</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:path</span>]
730:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:query</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:query</span>]
731:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query_values</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:query_values</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:query_values</span>]
732:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span> = <span class="ruby-identifier">options</span>[<span class="ruby-value">:fragment</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:fragment</span>]
733:       <span class="ruby-keyword kw">end</span>
734:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalize-component-method" class="method-detail ">
				<a name="method-c-normalize_component"></a>

				<div class="method-heading">
				
					<span class="method-name">normalize_component</span><span
						class="method-args">(component, character_class= CharacterClasses::RESERVED + CharacterClasses::UNRESERVED)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Normalizes the encoding of a <a href="URI.html">URI</a> component.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] component The <a
href="URI.html">URI</a> component to encode.
</p>
<p>
@param [String, Regexp] character_class
</p>
<pre>
  The characters which are not percent encoded. If a &lt;code&gt;String&lt;/code&gt;
  is passed, the &lt;code&gt;String&lt;/code&gt; must be formatted as a regular
  expression character class. (Do not include the surrounding square
  brackets.)  For example, &lt;code&gt;&quot;b-zB-Z0-9&quot;&lt;/code&gt; would cause
  everything but the letters 'b' through 'z' and the numbers '0'
  through '9' to be percent encoded. If a &lt;code&gt;Regexp&lt;/code&gt; is passed,
  the value &lt;code&gt;/[^b-zB-Z0-9]/&lt;/code&gt; would have the same effect. A
  set of useful &lt;code&gt;String&lt;/code&gt; values may be found in the
  &lt;code&gt;Addressable::URI::CharacterClasses&lt;/code&gt; module. The default
  value is the reserved plus unreserved character classes specified in
  &lt;a href=&quot;http://www.ietf.org/rfc/rfc3986.txt&quot;&gt;RFC 3986&lt;/a&gt;.
</pre>
<p>
@return [String] The normalized component.
</p>
<p>
@example
</p>
<pre>
  Addressable::URI.normalize_component(&quot;simpl%65/%65xampl%65&quot;, &quot;b-zB-Z&quot;)
  =&gt; &quot;simple%2Fex%61mple&quot;
  Addressable::URI.normalize_component(
    &quot;simpl%65/%65xampl%65&quot;, /[^b-zB-Z]/
  )
  =&gt; &quot;simple%2Fex%61mple&quot;
  Addressable::URI.normalize_component(
    &quot;simpl%65/%65xampl%65&quot;,
    Addressable::URI::CharacterClasses::UNRESERVED
  )
  =&gt; &quot;simple%2Fexample&quot;</pre>
					

					
					<div class="method-source-code"
						id="normalize-component-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 440</span>
440:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize_component</span>(<span class="ruby-identifier">component</span>, <span class="ruby-identifier">character_class</span>=
441:         <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">RESERVED</span> <span class="ruby-operator">+</span> <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>)
442:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">nil?</span>
443: 
444:       <span class="ruby-keyword kw">begin</span>
445:         <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_str</span>
446:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
447:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{component.class} into String.&quot;</span>
448:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">component</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
449: 
450:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-constant">Regexp</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">class</span>)
451:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
452:           <span class="ruby-node">&quot;Expected String or Regexp, got #{character_class.inspect}&quot;</span>
453:       <span class="ruby-keyword kw">end</span>
454:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">character_class</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>)
455:         <span class="ruby-identifier">character_class</span> = <span class="ruby-node">/[^#{character_class}]/</span>
456:       <span class="ruby-keyword kw">end</span>
457:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">component</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
458:         <span class="ruby-comment cmt"># We can't perform regexps on invalid UTF sequences, but</span>
459:         <span class="ruby-comment cmt"># here we need to, so switch to ASCII.</span>
460:         <span class="ruby-identifier">component</span> = <span class="ruby-identifier">component</span>.<span class="ruby-identifier">dup</span>
461:         <span class="ruby-identifier">component</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">ASCII_8BIT</span>)
462:       <span class="ruby-keyword kw">end</span>
463:       <span class="ruby-identifier">unencoded</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">component</span>)
464:       <span class="ruby-keyword kw">begin</span>
465:         <span class="ruby-identifier">encoded</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(
466:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">unicode_normalize_kc</span>(<span class="ruby-identifier">unencoded</span>),
467:           <span class="ruby-identifier">character_class</span>
468:         )
469:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span>
470:         <span class="ruby-identifier">encoded</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">unencoded</span>)
471:       <span class="ruby-keyword kw">end</span>
472:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">encoded</span>
473:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-encode-method" class="method-detail ">
				<a name="method-c-normalized_encode"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_encode</span><span
						class="method-args">(uri, returning=String)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Normalizes the encoding of a <a href="URI.html">URI</a>. Characters within
a hostname are not percent encoded to allow for internationalized domain
names.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri
</p>
<pre>
  The URI to encode.
</pre>
<p>
@param [Class] returning
</p>
<pre>
  The type of object to return.
  This value may only be set to &lt;code&gt;String&lt;/code&gt; or
  &lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
  to &lt;code&gt;String&lt;/code&gt;.
</pre>
<p>
@return [String, Addressable::URI]
</p>
<pre>
  The encoded URI.
  The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
					

					
					<div class="method-source-code"
						id="normalized-encode-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 544</span>
544:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_encode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
545:       <span class="ruby-keyword kw">begin</span>
546:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
547:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
548:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
549:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
550: 
551:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
552:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
553:           <span class="ruby-value str">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
554:           <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
555:       <span class="ruby-keyword kw">end</span>
556:       <span class="ruby-identifier">uri_object</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">uri</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
557:       <span class="ruby-identifier">components</span> = {
558:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">scheme</span>),
559:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">user</span>),
560:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">password</span>),
561:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">host</span>),
562:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">port</span>,
563:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">path</span>),
564:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">query</span>),
565:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">uri_object</span>.<span class="ruby-identifier">fragment</span>)
566:       }
567:       <span class="ruby-identifier">components</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
568:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
569:           <span class="ruby-keyword kw">begin</span>
570:             <span class="ruby-identifier">components</span>[<span class="ruby-identifier">key</span>] =
571:               <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">unicode_normalize_kc</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_str</span>)
572:           <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">ArgumentError</span>
573:             <span class="ruby-comment cmt"># Likely a malformed UTF-8 character, skip unicode normalization</span>
574:             <span class="ruby-identifier">components</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_str</span>
575:           <span class="ruby-keyword kw">end</span>
576:         <span class="ruby-keyword kw">end</span>
577:       <span class="ruby-keyword kw">end</span>
578:       <span class="ruby-identifier">encoded_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
579:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>],
580:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>),
581:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>],
582:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>),
583:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>],
584:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>),
585:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>],
586:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>],
587:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>],
588:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PATH</span>),
589:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>],
590:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>),
591:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">components</span>[<span class="ruby-value">:fragment</span>],
592:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>)
593:       )
594:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
595:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">encoded_uri</span>.<span class="ruby-identifier">to_s</span>
596:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
597:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">encoded_uri</span>
598:       <span class="ruby-keyword kw">end</span>
599:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-method" class="method-detail ">
				<a name="method-c-parse"></a>

				<div class="method-heading">
				
					<span class="method-name">parse</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a <a href="URI.html">URI</a> object based on the parsed string.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri
</p>
<pre>
  The URI string to parse.
  No parsing is performed if the object is already an
  &lt;code&gt;Addressable::URI&lt;/code&gt;.
</pre>
<p>
@return [Addressable::URI] The parsed <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="parse-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 83</span>
 83:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>)
 84:       <span class="ruby-comment cmt"># If we were given nil, return nil.</span>
 85:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">uri</span>
 86:       <span class="ruby-comment cmt"># If a URI object is passed, just return itself.</span>
 87:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-keyword kw">self</span>)
 88: 
 89:       <span class="ruby-comment cmt"># If a URI object of the Ruby standard library variety is passed,</span>
 90:       <span class="ruby-comment cmt"># convert it to a string, then parse the string.</span>
 91:       <span class="ruby-comment cmt"># We do the check this way because we don't want to accidentally</span>
 92:       <span class="ruby-comment cmt"># cause a missing constant exception to be thrown.</span>
 93:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">name</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^URI\b/</span>
 94:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>
 95:       <span class="ruby-keyword kw">end</span>
 96: 
 97:       <span class="ruby-comment cmt"># Otherwise, convert to a String</span>
 98:       <span class="ruby-keyword kw">begin</span>
 99:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
100:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-constant">NoMethodError</span>
101:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
102:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
103: 
104:       <span class="ruby-comment cmt"># This Regexp supplied as an example in RFC 3986, and it works great.</span>
105:       <span class="ruby-identifier">scan</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scan</span>(<span class="ruby-constant">URIREGEX</span>)
106:       <span class="ruby-identifier">fragments</span> = <span class="ruby-identifier">scan</span>[<span class="ruby-value">0</span>]
107:       <span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">1</span>]
108:       <span class="ruby-identifier">authority</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">3</span>]
109:       <span class="ruby-identifier">path</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">4</span>]
110:       <span class="ruby-identifier">query</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">6</span>]
111:       <span class="ruby-identifier">fragment</span> = <span class="ruby-identifier">fragments</span>[<span class="ruby-value">8</span>]
112:       <span class="ruby-identifier">user</span> = <span class="ruby-keyword kw">nil</span>
113:       <span class="ruby-identifier">password</span> = <span class="ruby-keyword kw">nil</span>
114:       <span class="ruby-identifier">host</span> = <span class="ruby-keyword kw">nil</span>
115:       <span class="ruby-identifier">port</span> = <span class="ruby-keyword kw">nil</span>
116:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
117:         <span class="ruby-comment cmt"># The Regexp above doesn't split apart the authority.</span>
118:         <span class="ruby-identifier">userinfo</span> = <span class="ruby-identifier">authority</span>[<span class="ruby-regexp re">/^([^\[\]]*)@/</span>, <span class="ruby-value">1</span>]
119:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
120:           <span class="ruby-identifier">user</span> = <span class="ruby-identifier">userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/^([^:]*):?/</span>, <span class="ruby-value">1</span>]
121:           <span class="ruby-identifier">password</span> = <span class="ruby-identifier">userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/:(.*)$/</span>, <span class="ruby-value">1</span>]
122:         <span class="ruby-keyword kw">end</span>
123:         <span class="ruby-identifier">host</span> = <span class="ruby-identifier">authority</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^([^\[\]]*)@/</span>, <span class="ruby-constant">EMPTY_STR</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/:([^:@\[\]]*?)$/</span>, <span class="ruby-constant">EMPTY_STR</span>)
124:         <span class="ruby-identifier">port</span> = <span class="ruby-identifier">authority</span>[<span class="ruby-regexp re">/:([^:@\[\]]*?)$/</span>, <span class="ruby-value">1</span>]
125:       <span class="ruby-keyword kw">end</span>
126:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">port</span> <span class="ruby-operator">==</span> <span class="ruby-constant">EMPTY_STR</span>
127:         <span class="ruby-identifier">port</span> = <span class="ruby-keyword kw">nil</span>
128:       <span class="ruby-keyword kw">end</span>
129: 
130:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">new</span>(
131:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">scheme</span>,
132:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">user</span>,
133:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">password</span>,
134:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">host</span>,
135:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">port</span>,
136:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">path</span>,
137:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">query</span>,
138:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fragment</span>
139:       )
140:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="port-mapping-method" class="method-detail ">
				<a name="method-c-port_mapping"></a>

				<div class="method-heading">
				
					<span class="method-name">port_mapping</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a hash of common IP-based schemes and their default port numbers.
Adding new schemes to this hash, as necessary, will allow for better <a
href="URI.html">URI</a> normalization.
</p>
					

					
					<div class="method-source-code"
						id="port-mapping-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1144</span>
1144:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port_mapping</span>
1145:       <span class="ruby-constant">PORT_MAPPING</span>
1146:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="unencode-method" class="method-detail ">
				<a name="method-c-unencode"></a>

				<div class="method-heading">
				
					<span class="method-name">unencode</span><span
						class="method-args">(uri, returning=String)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Unencodes any percent encoded characters within a <a
href="URI.html">URI</a> component. This method may be used for unencoding
either components or full URIs, however, it is recommended to use the
<tt>unencode_component</tt> alias when unencoding components.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri
</p>
<pre>
  The URI or component to unencode.
</pre>
<p>
@param [Class] returning
</p>
<pre>
  The type of object to return.
  This value may only be set to &lt;code&gt;String&lt;/code&gt; or
  &lt;code&gt;Addressable::URI&lt;/code&gt;. All other values are invalid. Defaults
  to &lt;code&gt;String&lt;/code&gt;.
</pre>
<p>
@return [String, Addressable::URI]
</p>
<pre>
  The unencoded component or URI.
  The return type is determined by the &lt;code&gt;returning&lt;/code&gt; parameter.</pre>
					

					
					<div class="method-source-code"
						id="unencode-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 377</span>
377:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">unencode</span>(<span class="ruby-identifier">uri</span>, <span class="ruby-identifier">returning</span>=<span class="ruby-constant">String</span>)
378:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">nil?</span>
379: 
380:       <span class="ruby-keyword kw">begin</span>
381:         <span class="ruby-identifier">uri</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>
382:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>, <span class="ruby-constant">TypeError</span>
383:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
384:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
385:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-constant">String</span>, <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">returning</span>)
386:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
387:           <span class="ruby-value str">&quot;Expected Class (String or Addressable::URI), &quot;</span> <span class="ruby-operator">+</span>
388:           <span class="ruby-node">&quot;got #{returning.inspect}&quot;</span>
389:       <span class="ruby-keyword kw">end</span>
390:       <span class="ruby-identifier">result</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/%[0-9a-f]{2}/</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">sequence</span><span class="ruby-operator">|</span>
391:         <span class="ruby-identifier">sequence</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">3</span>].<span class="ruby-identifier">to_i</span>(<span class="ruby-value">16</span>).<span class="ruby-identifier">chr</span>
392:       <span class="ruby-keyword kw">end</span>
393:       <span class="ruby-identifier">result</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-value str">&quot;utf-8&quot;</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
394:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-constant">String</span>
395:         <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">result</span>
396:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">returning</span> <span class="ruby-operator">==</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>
397:         <span class="ruby-keyword kw">return</span> <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">result</span>)
398:       <span class="ruby-keyword kw">end</span>
399:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-class-method-details" class="method-section section">
			<h3 class="section-header">Private Class Methods</h3>

		
			<div id="normalize-path-method" class="method-detail ">
				<a name="method-c-normalize_path"></a>

				<div class="method-heading">
				
					<span class="method-name">normalize_path</span><span
						class="method-args">(path)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Resolves paths to their simplest form.
</p>
<p>
@param [String] path The path to normalize.
</p>
<p>
@return [String] The normalized path.
</p>
					

					
					<div class="method-source-code"
						id="normalize-path-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2210</span>
2210:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">path</span>)
2211:       <span class="ruby-comment cmt"># Section 5.2.4 of RFC 3986</span>
2212: 
2213:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">path</span>.<span class="ruby-identifier">nil?</span>
2214:       <span class="ruby-identifier">normalized_path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>
2215:       <span class="ruby-keyword kw">begin</span>
2216:         <span class="ruby-identifier">mod</span> = <span class="ruby-keyword kw">nil</span>
2217:         <span class="ruby-identifier">mod</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">normalized_path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-constant">RULE_2A</span>, <span class="ruby-constant">SLASH</span>)
2218: 
2219:         <span class="ruby-identifier">pair</span> = <span class="ruby-identifier">normalized_path</span>.<span class="ruby-identifier">match</span>(<span class="ruby-constant">RULE_2B_2C</span>)
2220:         <span class="ruby-identifier">parent</span>, <span class="ruby-identifier">current</span> = <span class="ruby-identifier">pair</span>[<span class="ruby-value">1</span>], <span class="ruby-identifier">pair</span>[<span class="ruby-value">2</span>] <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pair</span>
2221:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pair</span> <span class="ruby-operator">&amp;&amp;</span> ((<span class="ruby-identifier">parent</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SELF_REF</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">parent</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">PARENT</span>) <span class="ruby-operator">||</span>
2222:             (<span class="ruby-identifier">current</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SELF_REF</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">PARENT</span>))
2223:           <span class="ruby-identifier">mod</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">normalized_path</span>.<span class="ruby-identifier">gsub!</span>(
2224:             <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(
2225:               <span class="ruby-node">&quot;/#{Regexp.escape(parent.to_s)}/\\.\\./|&quot;</span> <span class="ruby-operator">+</span>
2226:               <span class="ruby-node">&quot;(/#{Regexp.escape(current.to_s)}/\\.\\.$)&quot;</span>
2227:             ), <span class="ruby-constant">SLASH</span>
2228:           )
2229:         <span class="ruby-keyword kw">end</span>
2230: 
2231:         <span class="ruby-identifier">mod</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">normalized_path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-constant">RULE_2D</span>, <span class="ruby-constant">EMPTY_STR</span>)
2232:         <span class="ruby-comment cmt"># Non-standard, removes prefixed dotted segments from path.</span>
2233:         <span class="ruby-identifier">mod</span> <span class="ruby-operator">||=</span> <span class="ruby-identifier">normalized_path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-constant">RULE_PREFIXED_PARENT</span>, <span class="ruby-constant">SLASH</span>)
2234:       <span class="ruby-keyword kw">end</span> <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">mod</span>.<span class="ruby-identifier">nil?</span>
2235: 
2236:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">normalized_path</span>
2237:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="--method" class="method-detail method-alias">
				<a name="method-i-%2B"></a>

				<div class="method-heading">
				
					<span class="method-name">+</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="URI.html#method-i-join">join</a>
				</div>
				
			</div>

		
			<div id="--method" class="method-detail ">
				<a name="method-i-%3D%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">==</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method normalizes both URIs before doing the comparison.
</p>
<p>
@param [Object] uri The <a href="URI.html">URI</a> to compare.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
  otherwise.</pre>
					

					
					<div class="method-source-code"
						id="--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2036</span>
2036:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">==</span>(<span class="ruby-identifier">uri</span>)
2037:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
2038:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
2039:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="--method" class="method-detail ">
				<a name="method-i-%3D%3D%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">===</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method normalizes both URIs before doing the comparison, and allows
comparison against <tt>Strings</tt>.
</p>
<p>
@param [Object] uri The <a href="URI.html">URI</a> to compare.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
  otherwise.</pre>
					

					
					<div class="method-source-code"
						id="--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2014</span>
2014:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">===</span>(<span class="ruby-identifier">uri</span>)
2015:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:normalize</span>)
2016:         <span class="ruby-identifier">uri_string</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
2017:       <span class="ruby-keyword kw">else</span>
2018:         <span class="ruby-keyword kw">begin</span>
2019:           <span class="ruby-identifier">uri_string</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span>
2020:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">InvalidURIError</span>, <span class="ruby-constant">TypeError</span>
2021:           <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
2022:         <span class="ruby-keyword kw">end</span>
2023:       <span class="ruby-keyword kw">end</span>
2024:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri_string</span>
2025:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="absolute--method" class="method-detail ">
				<a name="method-i-absolute%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">absolute?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Determines if the <a href="URI.html">URI</a> is absolute.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the URI is absolute. &lt;code&gt;false&lt;/code&gt;
  otherwise.</pre>
					

					
					<div class="method-source-code"
						id="absolute--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1683</span>
1683:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">absolute?</span>
1684:       <span class="ruby-keyword kw">return</span> <span class="ruby-operator">!</span><span class="ruby-identifier">relative?</span>
1685:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="authority-method" class="method-detail ">
				<a name="method-i-authority"></a>

				<div class="method-heading">
				
					<span class="method-name">authority</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The authority component for this <a href="URI.html">URI</a>. Combines the
user, password, host, and port components.
</p>
<p>
@return [String] The authority component.
</p>
					

					
					<div class="method-source-code"
						id="authority-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1045</span>
1045:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authority</span>
1046:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@authority</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1047:         <span class="ruby-identifier">authority</span> = <span class="ruby-value str">&quot;&quot;</span>
1048:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1049:           <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.userinfo}@&quot;</span>
1050:         <span class="ruby-keyword kw">end</span>
1051:         <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>
1052:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1053:           <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{self.port}&quot;</span>
1054:         <span class="ruby-keyword kw">end</span>
1055:         <span class="ruby-identifier">authority</span>
1056:       <span class="ruby-keyword kw">end</span>)
1057:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="authority--method" class="method-detail ">
				<a name="method-i-authority%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">authority=</span><span
						class="method-args">(new_authority)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the authority component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_authority The
new authority component.
</p>
					

					
					<div class="method-source-code"
						id="authority--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1081</span>
1081:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">authority=</span>(<span class="ruby-identifier">new_authority</span>)
1082:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_authority</span>
1083:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1084:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_authority.class} into String.&quot;</span>
1085:         <span class="ruby-keyword kw">end</span>
1086:         <span class="ruby-identifier">new_authority</span> = <span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">to_str</span>
1087:         <span class="ruby-identifier">new_userinfo</span> = <span class="ruby-identifier">new_authority</span>[<span class="ruby-regexp re">/^([^\[\]]*)@/</span>, <span class="ruby-value">1</span>]
1088:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_userinfo</span>
1089:           <span class="ruby-identifier">new_user</span> = <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/^([^:]*):?/</span>, <span class="ruby-value">1</span>]
1090:           <span class="ruby-identifier">new_password</span> = <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/:(.*)$/</span>, <span class="ruby-value">1</span>]
1091:         <span class="ruby-keyword kw">end</span>
1092:         <span class="ruby-identifier">new_host</span> =
1093:           <span class="ruby-identifier">new_authority</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/^([^\[\]]*)@/</span>, <span class="ruby-constant">EMPTY_STR</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/:([^:@\[\]]*?)$/</span>, <span class="ruby-constant">EMPTY_STR</span>)
1094:         <span class="ruby-identifier">new_port</span> =
1095:           <span class="ruby-identifier">new_authority</span>[<span class="ruby-regexp re">/:([^:@\[\]]*?)$/</span>, <span class="ruby-value">1</span>]
1096:       <span class="ruby-keyword kw">end</span>
1097: 
1098:       <span class="ruby-comment cmt"># Password assigned first to ensure validity in case of nil</span>
1099:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">new_password</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_password</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1100:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">new_user</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1101:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> = <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">new_host</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_host</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1102:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span> = <span class="ruby-keyword kw">defined?</span>(<span class="ruby-identifier">new_port</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1103: 
1104:       <span class="ruby-comment cmt"># Reset dependant values</span>
1105:       <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword kw">nil</span>
1106:       <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword kw">nil</span>
1107:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1108:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1109: 
1110:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
1111:       <span class="ruby-identifier">validate</span>()
1112:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="basename-method" class="method-detail ">
				<a name="method-i-basename"></a>

				<div class="method-heading">
				
					<span class="method-name">basename</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The basename, if any, of the file in the path component.
</p>
<p>
@return [String] The path&#8217;s basename.
</p>
					

					
					<div class="method-source-code"
						id="basename-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1337</span>
1337:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">basename</span>
1338:       <span class="ruby-comment cmt"># Path cannot be nil</span>
1339:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">basename</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/;[^\/]*$/</span>, <span class="ruby-constant">EMPTY_STR</span>)
1340:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="defer-validation-method" class="method-detail ">
				<a name="method-i-defer_validation"></a>

				<div class="method-heading">
				
					<span class="method-name">defer_validation</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method allows you to make several changes to a <a
href="URI.html">URI</a> simultaneously, which separately would cause
validation errors, but in conjunction, are valid.  The <a
href="URI.html">URI</a> will be revalidated as soon as the entire block has
been executed.
</p>
<p>
@param [Proc] block
</p>
<pre>
  A set of operations to perform on a given URI.</pre>
					

					
					<div class="method-source-code"
						id="defer-validation-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2186</span>
2186:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">defer_validation</span>(&amp;<span class="ruby-identifier">block</span>)
2187:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">LocalJumpError</span>, <span class="ruby-value str">&quot;No block given.&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">block</span>
2188:       <span class="ruby-ivar">@validation_deferred</span> = <span class="ruby-keyword kw">true</span>
2189:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>()
2190:       <span class="ruby-ivar">@validation_deferred</span> = <span class="ruby-keyword kw">false</span>
2191:       <span class="ruby-identifier">validate</span>
2192:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
2193:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="display-uri-method" class="method-detail ">
				<a name="method-i-display_uri"></a>

				<div class="method-heading">
				
					<span class="method-name">display_uri</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Creates a <a href="URI.html">URI</a> suitable for display to users. If
semantic attacks are likely, the application should try to detect these and
warn the user. See <a href=&#8220;<a
href="http://www.ietf.org/rfc/rfc3986.txt">RFC">www.ietf.org/rfc/rfc3986.txt">RFC</a>
3986</a>, section 7.6 for more information.
</p>
<p>
@return [Addressable::URI] A <a href="URI.html">URI</a> suitable for
display purposes.
</p>
					

					
					<div class="method-source-code"
						id="display-uri-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1998</span>
1998:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">display_uri</span>
1999:       <span class="ruby-identifier">display_uri</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize</span>
2000:       <span class="ruby-identifier">display_uri</span>.<span class="ruby-identifier">host</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">to_unicode</span>(<span class="ruby-identifier">display_uri</span>.<span class="ruby-identifier">host</span>)
2001:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">display_uri</span>
2002:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="dup-method" class="method-detail ">
				<a name="method-i-dup"></a>

				<div class="method-heading">
				
					<span class="method-name">dup</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Clones the <a href="URI.html">URI</a> object.
</p>
<p>
@return [Addressable::URI] The cloned <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="dup-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2068</span>
2068:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">dup</span>
2069:       <span class="ruby-identifier">duplicated_uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
2070:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2071:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2072:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2073:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2074:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>,
2075:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2076:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>,
2077:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span>.<span class="ruby-identifier">dup</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
2078:       )
2079:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">duplicated_uri</span>
2080:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="eql--method" class="method-detail ">
				<a name="method-i-eql%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">eql?</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns <tt>true</tt> if the <a href="URI.html">URI</a> objects are equal.
This method does NOT normalize either <a href="URI.html">URI</a> before
doing the comparison.
</p>
<p>
@param [Object] uri The <a href="URI.html">URI</a> to compare.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the URIs are equivalent, &lt;code&gt;false&lt;/code&gt;
  otherwise.</pre>
					

					
					<div class="method-source-code"
						id="eql--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2050</span>
2050:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">eql?</span>(<span class="ruby-identifier">uri</span>)
2051:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
2052:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>
2053:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="extname-method" class="method-detail ">
				<a name="method-i-extname"></a>

				<div class="method-heading">
				
					<span class="method-name">extname</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The extname, if any, of the file in the path component. Empty string if
there is no extension.
</p>
<p>
@return [String] The path&#8217;s extname.
</p>
					

					
					<div class="method-source-code"
						id="extname-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1347</span>
1347:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">extname</span>
1348:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>
1349:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">basename</span>)
1350:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="fragment-method" class="method-detail ">
				<a name="method-i-fragment"></a>

				<div class="method-heading">
				
					<span class="method-name">fragment</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The fragment component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The fragment component.
</p>
					

					
					<div class="method-source-code"
						id="fragment-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1617</span>
1617:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fragment</span>
1618:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@fragment</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@fragment</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1619:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="fragment--method" class="method-detail ">
				<a name="method-i-fragment%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">fragment=</span><span
						class="method-args">(new_fragment)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the fragment component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_fragment The
new fragment component.
</p>
					

					
					<div class="method-source-code"
						id="fragment--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1638</span>
1638:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">fragment=</span>(<span class="ruby-identifier">new_fragment</span>)
1639:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_fragment</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_fragment</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1640:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_fragment.class} into String.&quot;</span>
1641:       <span class="ruby-keyword kw">end</span>
1642:       <span class="ruby-ivar">@fragment</span> = <span class="ruby-identifier">new_fragment</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_fragment</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1643: 
1644:       <span class="ruby-comment cmt"># Reset dependant values</span>
1645:       <span class="ruby-ivar">@normalized_fragment</span> = <span class="ruby-keyword kw">nil</span>
1646:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1647:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1648: 
1649:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
1650:       <span class="ruby-identifier">validate</span>()
1651:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="freeze-method" class="method-detail ">
				<a name="method-i-freeze"></a>

				<div class="method-heading">
				
					<span class="method-name">freeze</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Freeze <a href="URI.html">URI</a>, initializing instance variables.
</p>
<p>
@return [Addressable::URI] The frozen <a href="URI.html">URI</a> object.
</p>
					

					
					<div class="method-source-code"
						id="freeze-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 740</span>
740:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">freeze</span>
741:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_scheme</span>
742:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_user</span>
743:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_password</span>
744:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_userinfo</span>
745:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_host</span>
746:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_port</span>
747:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_authority</span>
748:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_site</span>
749:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_path</span>
750:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_query</span>
751:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_fragment</span>
752:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">hash</span>
753:       <span class="ruby-keyword kw">super</span>
754:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="hash-method" class="method-detail ">
				<a name="method-i-hash"></a>

				<div class="method-heading">
				
					<span class="method-name">hash</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
A hash value that will make a <a href="URI.html">URI</a> equivalent to its
normalized form.
</p>
<p>
@return [Integer] A hash of the <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="hash-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2060</span>
2060:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">hash</span>
2061:       <span class="ruby-keyword kw">return</span> <span class="ruby-ivar">@hash</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">hash</span> * <span class="ruby-value">1</span>)
2062:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="host-method" class="method-detail ">
				<a name="method-i-host"></a>

				<div class="method-heading">
				
					<span class="method-name">host</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The host component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The host component.
</p>
					

					
					<div class="method-source-code"
						id="host-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 983</span>
983:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host</span>
984:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@host</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@host</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
985:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="URI.html#method-i-hostname">hostname</a>
				</div>
				

				
			</div>

		
			<div id="host--method" class="method-detail ">
				<a name="method-i-host%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">host=</span><span
						class="method-args">(new_host)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the host component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_host The new
host component.
</p>
					

					
					<div class="method-source-code"
						id="host--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1016</span>
1016:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">host=</span>(<span class="ruby-identifier">new_host</span>)
1017:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_host</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1018:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_host.class} into String.&quot;</span>
1019:       <span class="ruby-keyword kw">end</span>
1020:       <span class="ruby-ivar">@host</span> = <span class="ruby-identifier">new_host</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_host</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1021: 
1022:       <span class="ruby-comment cmt"># Reset dependant values</span>
1023:       <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword kw">nil</span>
1024:       <span class="ruby-ivar">@normalized_host</span> = <span class="ruby-keyword kw">nil</span>
1025:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1026:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1027: 
1028:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
1029:       <span class="ruby-identifier">validate</span>()
1030:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="URI.html#method-i-hostname%3D">hostname=</a>
				</div>
				

				
			</div>

		
			<div id="hostname-method" class="method-detail method-alias">
				<a name="method-i-hostname"></a>

				<div class="method-heading">
				
					<span class="method-name">hostname</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
@see <a href="URI.html#method-i-host">Addressable::URI#host</a>
</p>
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="URI.html#method-i-host">host</a>
				</div>
				
			</div>

		
			<div id="hostname--method" class="method-detail method-alias">
				<a name="method-i-hostname%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">hostname=</span><span
						class="method-args">(new_host)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
@see <a href="URI.html#method-i-host%3D">Addressable::URI#host=</a>
</p>
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="URI.html#method-i-host%3D">host=</a>
				</div>
				
			</div>

		
			<div id="inferred-port-method" class="method-detail ">
				<a name="method-i-inferred_port"></a>

				<div class="method-heading">
				
					<span class="method-name">inferred_port</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The inferred port component for this <a href="URI.html">URI</a>. This
method will normalize to the default port for the URI&#8217;s scheme if the
port isn&#8217;t explicitly specified in the <a href="URI.html">URI</a>.
</p>
<p>
@return [Integer] The inferred port component.
</p>
					

					
					<div class="method-source-code"
						id="inferred-port-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1202</span>
1202:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inferred_port</span>
1203:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
1204:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>
1205:           <span class="ruby-constant">URI</span>.<span class="ruby-identifier">port_mapping</span>[<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>]
1206:         <span class="ruby-keyword kw">else</span>
1207:           <span class="ruby-keyword kw">nil</span>
1208:         <span class="ruby-keyword kw">end</span>
1209:       <span class="ruby-keyword kw">else</span>
1210:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>.<span class="ruby-identifier">to_i</span>
1211:       <span class="ruby-keyword kw">end</span>
1212:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="inspect-method" class="method-detail ">
				<a name="method-i-inspect"></a>

				<div class="method-heading">
				
					<span class="method-name">inspect</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a <tt>String</tt> representation of the <a href="URI.html">URI</a>
object&#8217;s state.
</p>
<p>
@return [String] The <a href="URI.html">URI</a> object&#8217;s state, as a
<tt>String</tt>.
</p>
					

					
					<div class="method-source-code"
						id="inspect-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2174</span>
2174:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
2175:       <span class="ruby-identifier">sprintf</span>(<span class="ruby-node">&quot;#&lt;%s:%#0x URI:%s&gt;&quot;</span>, <span class="ruby-constant">URI</span>.<span class="ruby-identifier">to_s</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">object_id</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span>)
2176:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="ip-based--method" class="method-detail ">
				<a name="method-i-ip_based%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">ip_based?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Determines if the scheme indicates an IP-based protocol.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the scheme indicates an IP-based protocol.
  &lt;code&gt;false&lt;/code&gt; otherwise.</pre>
					

					
					<div class="method-source-code"
						id="ip-based--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1659</span>
1659:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">ip_based?</span>
1660:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>
1661:         <span class="ruby-keyword kw">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">ip_based_schemes</span>.<span class="ruby-identifier">include?</span>(
1662:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>)
1663:       <span class="ruby-keyword kw">end</span>
1664:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">false</span>
1665:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="join-method" class="method-detail ">
				<a name="method-i-join"></a>

				<div class="method-heading">
				
					<span class="method-name">join</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Joins two URIs together.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] The <a href="URI.html">URI</a> to
join with.
</p>
<p>
@return [Addressable::URI] The joined <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="join-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1693</span>
1693:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join</span>(<span class="ruby-identifier">uri</span>)
1694:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1695:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{uri.class} into String.&quot;</span>
1696:       <span class="ruby-keyword kw">end</span>
1697:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">uri</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">URI</span>)
1698:         <span class="ruby-comment cmt"># Otherwise, convert to a String, then parse.</span>
1699:         <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_str</span>)
1700:       <span class="ruby-keyword kw">end</span>
1701:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">empty?</span>
1702:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dup</span>
1703:       <span class="ruby-keyword kw">end</span>
1704: 
1705:       <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-keyword kw">nil</span>
1706:       <span class="ruby-identifier">joined_user</span> = <span class="ruby-keyword kw">nil</span>
1707:       <span class="ruby-identifier">joined_password</span> = <span class="ruby-keyword kw">nil</span>
1708:       <span class="ruby-identifier">joined_host</span> = <span class="ruby-keyword kw">nil</span>
1709:       <span class="ruby-identifier">joined_port</span> = <span class="ruby-keyword kw">nil</span>
1710:       <span class="ruby-identifier">joined_path</span> = <span class="ruby-keyword kw">nil</span>
1711:       <span class="ruby-identifier">joined_query</span> = <span class="ruby-keyword kw">nil</span>
1712:       <span class="ruby-identifier">joined_fragment</span> = <span class="ruby-keyword kw">nil</span>
1713: 
1714:       <span class="ruby-comment cmt"># Section 5.2.2 of RFC 3986</span>
1715:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1716:         <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>
1717:         <span class="ruby-identifier">joined_user</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>
1718:         <span class="ruby-identifier">joined_password</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span>
1719:         <span class="ruby-identifier">joined_host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
1720:         <span class="ruby-identifier">joined_port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
1721:         <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
1722:         <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
1723:       <span class="ruby-keyword kw">else</span>
1724:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1725:           <span class="ruby-identifier">joined_user</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>
1726:           <span class="ruby-identifier">joined_password</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span>
1727:           <span class="ruby-identifier">joined_host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
1728:           <span class="ruby-identifier">joined_port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
1729:           <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
1730:           <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
1731:         <span class="ruby-keyword kw">else</span>
1732:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span>
1733:             <span class="ruby-identifier">joined_path</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>
1734:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1735:               <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
1736:             <span class="ruby-keyword kw">else</span>
1737:               <span class="ruby-identifier">joined_query</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>
1738:             <span class="ruby-keyword kw">end</span>
1739:           <span class="ruby-keyword kw">else</span>
1740:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-constant">SLASH</span>
1741:               <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
1742:             <span class="ruby-keyword kw">else</span>
1743:               <span class="ruby-identifier">base_path</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">dup</span>
1744:               <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">EMPTY_STR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base_path</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
1745:               <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">base_path</span>)
1746: 
1747:               <span class="ruby-comment cmt"># Section 5.2.3 of RFC 3986</span>
1748:               <span class="ruby-comment cmt">#</span>
1749:               <span class="ruby-comment cmt"># Removes the right-most path segment from the base path.</span>
1750:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base_path</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\//</span>
1751:                 <span class="ruby-identifier">base_path</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-regexp re">/\/[^\/]+$/</span>, <span class="ruby-constant">SLASH</span>)
1752:               <span class="ruby-keyword kw">else</span>
1753:                 <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">EMPTY_STR</span>
1754:               <span class="ruby-keyword kw">end</span>
1755: 
1756:               <span class="ruby-comment cmt"># If the base path is empty and an authority segment has been</span>
1757:               <span class="ruby-comment cmt"># defined, use a base path of SLASH</span>
1758:               <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">base_path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1759:                 <span class="ruby-identifier">base_path</span> = <span class="ruby-constant">SLASH</span>
1760:               <span class="ruby-keyword kw">end</span>
1761: 
1762:               <span class="ruby-identifier">joined_path</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">base_path</span> <span class="ruby-operator">+</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)
1763:             <span class="ruby-keyword kw">end</span>
1764:             <span class="ruby-identifier">joined_query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
1765:           <span class="ruby-keyword kw">end</span>
1766:           <span class="ruby-identifier">joined_user</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>
1767:           <span class="ruby-identifier">joined_password</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>
1768:           <span class="ruby-identifier">joined_host</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>
1769:           <span class="ruby-identifier">joined_port</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>
1770:         <span class="ruby-keyword kw">end</span>
1771:         <span class="ruby-identifier">joined_scheme</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>
1772:       <span class="ruby-keyword kw">end</span>
1773:       <span class="ruby-identifier">joined_fragment</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">fragment</span>
1774: 
1775:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
1776:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_scheme</span>,
1777:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_user</span>,
1778:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_password</span>,
1779:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_host</span>,
1780:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_port</span>,
1781:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_path</span>,
1782:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_query</span>,
1783:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">joined_fragment</span>
1784:       )
1785:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="URI.html#method-i-%2B">+</a>
				</div>
				

				
			</div>

		
			<div id="join--method" class="method-detail ">
				<a name="method-i-join%21"></a>

				<div class="method-heading">
				
					<span class="method-name">join!</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Destructive form of <tt>join</tt>.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] The <a href="URI.html">URI</a> to
join with.
</p>
<p>
@return [Addressable::URI] The joined <a href="URI.html">URI</a>.
</p>
<p>
@see <a href="URI.html#method-i-join">Addressable::URI#join</a>
</p>
					

					
					<div class="method-source-code"
						id="join--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1796</span>
1796:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">join!</span>(<span class="ruby-identifier">uri</span>)
1797:       <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">join</span>(<span class="ruby-identifier">uri</span>))
1798:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="merge-method" class="method-detail ">
				<a name="method-i-merge"></a>

				<div class="method-heading">
				
					<span class="method-name">merge</span><span
						class="method-args">(hash)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Merges a <a href="URI.html">URI</a> with a <tt>Hash</tt> of components.
This method has different behavior from <tt>join</tt>. Any components
present in the <tt>hash</tt> parameter will override the original
components. The path component is not treated specially.
</p>
<p>
@param [Hash, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_hash">#</a>] The components to merge with.
</p>
<p>
@return [Addressable::URI] The merged <a href="URI.html">URI</a>.
</p>
<p>
@see Hash#merge
</p>
					

					
					<div class="method-source-code"
						id="merge-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1811</span>
1811:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge</span>(<span class="ruby-identifier">hash</span>)
1812:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
1813:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{hash.class} into Hash.&quot;</span>
1814:       <span class="ruby-keyword kw">end</span>
1815:       <span class="ruby-identifier">hash</span> = <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">to_hash</span>
1816: 
1817:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
1818:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:userinfo</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>]).<span class="ruby-identifier">any?</span>
1819:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
1820:             <span class="ruby-value str">&quot;Cannot specify both an authority and any of the components &quot;</span> <span class="ruby-operator">+</span>
1821:             <span class="ruby-value str">&quot;within the authority.&quot;</span>
1822:         <span class="ruby-keyword kw">end</span>
1823:       <span class="ruby-keyword kw">end</span>
1824:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
1825:         <span class="ruby-keyword kw">if</span> (<span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span> &amp; [<span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>]).<span class="ruby-identifier">any?</span>
1826:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
1827:             <span class="ruby-value str">&quot;Cannot specify both a userinfo and either the user or password.&quot;</span>
1828:         <span class="ruby-keyword kw">end</span>
1829:       <span class="ruby-keyword kw">end</span>
1830: 
1831:       <span class="ruby-identifier">uri</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>
1832:       <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword kw">do</span>
1833:         <span class="ruby-comment cmt"># Bunch of crazy logic required because of the composite components</span>
1834:         <span class="ruby-comment cmt"># like userinfo and authority.</span>
1835:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span> =
1836:           <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:scheme</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:scheme</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>
1837:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
1838:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span> =
1839:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:authority</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span>
1840:         <span class="ruby-keyword kw">end</span>
1841:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>)
1842:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">userinfo</span> =
1843:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:userinfo</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">userinfo</span>
1844:         <span class="ruby-keyword kw">end</span>
1845:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:userinfo</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
1846:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span> =
1847:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:user</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:user</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>
1848:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span> =
1849:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:password</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:password</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>
1850:         <span class="ruby-keyword kw">end</span>
1851:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:authority</span>)
1852:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span> =
1853:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:host</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:host</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>
1854:           <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span> =
1855:             <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:port</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:port</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>
1856:         <span class="ruby-keyword kw">end</span>
1857:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> =
1858:           <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:path</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:path</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>
1859:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span> =
1860:           <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:query</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:query</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>
1861:         <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">fragment</span> =
1862:           <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">has_key?</span>(<span class="ruby-value">:fragment</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">hash</span>[<span class="ruby-value">:fragment</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span>
1863:       <span class="ruby-keyword kw">end</span>
1864: 
1865:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">uri</span>
1866:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="merge--method" class="method-detail ">
				<a name="method-i-merge%21"></a>

				<div class="method-heading">
				
					<span class="method-name">merge!</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Destructive form of <tt>merge</tt>.
</p>
<p>
@param [Hash, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_hash">#</a>] The components to merge with.
</p>
<p>
@return [Addressable::URI] The merged <a href="URI.html">URI</a>.
</p>
<p>
@see <a href="URI.html#method-i-merge">Addressable::URI#merge</a>
</p>
					

					
					<div class="method-source-code"
						id="merge--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1876</span>
1876:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">merge!</span>(<span class="ruby-identifier">uri</span>)
1877:       <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">uri</span>))
1878:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalize-method" class="method-detail ">
				<a name="method-i-normalize"></a>

				<div class="method-heading">
				
					<span class="method-name">normalize</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a normalized <a href="URI.html">URI</a> object.
</p>
<p>
NOTE: This method does not attempt to fully conform to specifications. It
exists largely to correct other people&#8217;s failures to read the
specifications, and also to deal with caching issues since several
different URIs may represent the same resource and should not be cached
multiple times.
</p>
<p>
@return [Addressable::URI] The normalized <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="normalize-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1961</span>
1961:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalize</span>
1962:       <span class="ruby-comment cmt"># This is a special exception for the frequently misused feed</span>
1963:       <span class="ruby-comment cmt"># URI scheme.</span>
1964:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;feed&quot;</span>
1965:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^feed:\/*http:\/*/</span>
1966:           <span class="ruby-keyword kw">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(
1967:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">to_s</span>[<span class="ruby-regexp re">/^feed:\/*(http:\/*.*)/</span>, <span class="ruby-value">1</span>]
1968:           ).<span class="ruby-identifier">normalize</span>
1969:         <span class="ruby-keyword kw">end</span>
1970:       <span class="ruby-keyword kw">end</span>
1971: 
1972:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
1973:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_scheme</span>,
1974:         <span class="ruby-value">:authority</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_authority</span>,
1975:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_path</span>,
1976:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_query</span>,
1977:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">normalized_fragment</span>
1978:       )
1979:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalize--method" class="method-detail ">
				<a name="method-i-normalize%21"></a>

				<div class="method-heading">
				
					<span class="method-name">normalize!</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Destructively normalizes this <a href="URI.html">URI</a> object.
</p>
<p>
@return [Addressable::URI] The normalized <a href="URI.html">URI</a>.
</p>
<p>
@see <a href="URI.html#method-i-normalize">Addressable::URI#normalize</a>
</p>
					

					
					<div class="method-source-code"
						id="normalize--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1987</span>
1987:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalize!</span>
1988:       <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize</span>)
1989:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-authority-method" class="method-detail ">
				<a name="method-i-normalized_authority"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_authority</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The authority component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The authority component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-authority-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1063</span>
1063:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_authority</span>
1064:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_authority</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1065:         <span class="ruby-identifier">authority</span> = <span class="ruby-value str">&quot;&quot;</span>
1066:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_userinfo</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1067:           <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.normalized_userinfo}@&quot;</span>
1068:         <span class="ruby-keyword kw">end</span>
1069:         <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_host</span>
1070:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1071:           <span class="ruby-identifier">authority</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;:#{self.normalized_port}&quot;</span>
1072:         <span class="ruby-keyword kw">end</span>
1073:         <span class="ruby-identifier">authority</span>
1074:       <span class="ruby-keyword kw">end</span>)
1075:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-fragment-method" class="method-detail ">
				<a name="method-i-normalized_fragment"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_fragment</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The fragment component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The fragment component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-fragment-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1625</span>
1625:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_fragment</span>
1626:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_fragment</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1627:         <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
1628:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span>.<span class="ruby-identifier">strip</span>,
1629:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">FRAGMENT</span>
1630:         )
1631:       <span class="ruby-keyword kw">end</span>)
1632:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-host-method" class="method-detail ">
				<a name="method-i-normalized_host"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_host</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The host component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The host component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-host-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 991</span>
 991:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_host</span>
 992:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_host</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
 993:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
 994:           <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
 995:             <span class="ruby-identifier">result</span> = <span class="ruby-operator">::</span><span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">IDNA</span>.<span class="ruby-identifier">to_ascii</span>(
 996:               <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>)
 997:             )
 998:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;.&quot;</span>
 999:               <span class="ruby-comment cmt"># Trailing dots are unnecessary</span>
1000:               <span class="ruby-identifier">result</span> = <span class="ruby-identifier">result</span>[<span class="ruby-value">0</span><span class="ruby-operator">...</span><span class="ruby-value">1</span>]
1001:             <span class="ruby-keyword kw">end</span>
1002:             <span class="ruby-identifier">result</span>
1003:           <span class="ruby-keyword kw">else</span>
1004:             <span class="ruby-constant">EMPTY_STR</span>
1005:           <span class="ruby-keyword kw">end</span>
1006:         <span class="ruby-keyword kw">else</span>
1007:           <span class="ruby-keyword kw">nil</span>
1008:         <span class="ruby-keyword kw">end</span>
1009:       <span class="ruby-keyword kw">end</span>)
1010:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-password-method" class="method-detail ">
				<a name="method-i-normalized_password"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_password</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The password component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The password component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-password-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 871</span>
871:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_password</span>
872:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_password</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
873:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/https?/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
874:             (<span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>)
875:           <span class="ruby-keyword kw">nil</span>
876:         <span class="ruby-keyword kw">else</span>
877:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
878:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>,
879:             <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
880:           )
881:         <span class="ruby-keyword kw">end</span>
882:       <span class="ruby-keyword kw">end</span>)
883:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-path-method" class="method-detail ">
				<a name="method-i-normalized_path"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_path</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The path component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The path component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-path-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1289</span>
1289:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_path</span>
1290:       <span class="ruby-ivar">@normalized_path</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1291:         <span class="ruby-identifier">path</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>
1292:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">NORMPATH</span>
1293:           <span class="ruby-comment cmt"># Relative paths with colons in the first segment are ambiguous.</span>
1294:           <span class="ruby-identifier">path</span> = <span class="ruby-identifier">path</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;:&quot;</span>, <span class="ruby-value str">&quot;%2F&quot;</span>)
1295:         <span class="ruby-keyword kw">end</span>
1296:         <span class="ruby-comment cmt"># String#split(delimeter, -1) uses the more strict splitting behavior</span>
1297:         <span class="ruby-comment cmt"># found by default in Python.</span>
1298:         <span class="ruby-identifier">result</span> = (<span class="ruby-identifier">path</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">split</span>(<span class="ruby-constant">SLASH</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">segment</span><span class="ruby-operator">|</span>
1299:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
1300:             <span class="ruby-identifier">segment</span>,
1301:             <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">PCHAR</span>
1302:           )
1303:         <span class="ruby-keyword kw">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-constant">SLASH</span>)
1304: 
1305:         <span class="ruby-identifier">result</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_path</span>(<span class="ruby-identifier">result</span>)
1306:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
1307:             [<span class="ruby-value str">&quot;http&quot;</span>, <span class="ruby-value str">&quot;https&quot;</span>, <span class="ruby-value str">&quot;ftp&quot;</span>, <span class="ruby-value str">&quot;tftp&quot;</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_scheme</span>)
1308:           <span class="ruby-identifier">result</span> = <span class="ruby-constant">SLASH</span>
1309:         <span class="ruby-keyword kw">end</span>
1310:         <span class="ruby-identifier">result</span>
1311:       <span class="ruby-keyword kw">end</span>)
1312:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-port-method" class="method-detail ">
				<a name="method-i-normalized_port"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_port</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The port component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [Integer] The port component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-port-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1162</span>
1162:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_port</span>
1163:       <span class="ruby-keyword kw">if</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">port_mapping</span>[<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_scheme</span>] <span class="ruby-operator">==</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>
1164:         <span class="ruby-keyword kw">nil</span>
1165:       <span class="ruby-keyword kw">else</span>
1166:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>
1167:       <span class="ruby-keyword kw">end</span>
1168:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-query-method" class="method-detail ">
				<a name="method-i-normalized_query"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_query</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The query component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The query component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-query-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1364</span>
1364:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_query</span>
1365:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_query</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1366:         (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
1367:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
1368:             <span class="ruby-identifier">pair</span>,
1369:             <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">QUERY</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-value str">&quot;\\&amp;&quot;</span>, <span class="ruby-value str">&quot;&quot;</span>)
1370:           )
1371:         <span class="ruby-keyword kw">end</span>).<span class="ruby-identifier">join</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>)
1372:       <span class="ruby-keyword kw">end</span>)
1373:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-scheme-method" class="method-detail ">
				<a name="method-i-normalized_scheme"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_scheme</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The scheme component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The scheme component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-scheme-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 768</span>
768:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_scheme</span>
769:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_scheme</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
770:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\s*ssh\+svn\s*$/</span>
771:           <span class="ruby-value str">&quot;svn+ssh&quot;</span>
772:         <span class="ruby-keyword kw">else</span>
773:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
774:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">downcase</span>,
775:             <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">SCHEME</span>
776:           )
777:         <span class="ruby-keyword kw">end</span>
778:       <span class="ruby-keyword kw">end</span>)
779:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-site-method" class="method-detail ">
				<a name="method-i-normalized_site"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_site</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The normalized combination of components that represent a site. Combines
the scheme, user, password, host, and port components. Primarily useful for
HTTP and HTTPS.
</p>
<p>
For example, <tt>&quot;<a
href="http://example.com/path?query">example.com/path?query</a>&quot;</tt>
would have a <tt>site</tt> value of <tt>&quot;<a
href="http://example.com">example.com</a>&quot;</tt>.
</p>
<p>
@return [String] The normalized components that identify a site.
</p>
					

					
					<div class="method-source-code"
						id="normalized-site-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1241</span>
1241:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_site</span>
1242:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">site</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_site</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1243:         <span class="ruby-identifier">site_string</span> = <span class="ruby-value str">&quot;&quot;</span>
1244:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1245:           <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.normalized_scheme}:&quot;</span>
1246:         <span class="ruby-keyword kw">end</span>
1247:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1248:           <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.normalized_authority}&quot;</span>
1249:         <span class="ruby-keyword kw">end</span>
1250:         <span class="ruby-identifier">site_string</span>
1251:       <span class="ruby-keyword kw">end</span>)
1252:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-user-method" class="method-detail ">
				<a name="method-i-normalized_user"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_user</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The user component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The user component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-user-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 818</span>
818:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_user</span>
819:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_user</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
820:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_scheme</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/https?/</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
821:             (<span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>)
822:           <span class="ruby-keyword kw">nil</span>
823:         <span class="ruby-keyword kw">else</span>
824:           <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">normalize_component</span>(
825:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>.<span class="ruby-identifier">strip</span>,
826:             <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span><span class="ruby-operator">::</span><span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
827:           )
828:         <span class="ruby-keyword kw">end</span>
829:       <span class="ruby-keyword kw">end</span>)
830:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="normalized-userinfo-method" class="method-detail ">
				<a name="method-i-normalized_userinfo"></a>

				<div class="method-heading">
				
					<span class="method-name">normalized_userinfo</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The userinfo component for this <a href="URI.html">URI</a>, normalized.
</p>
<p>
@return [String] The userinfo component, normalized.
</p>
					

					
					<div class="method-source-code"
						id="normalized-userinfo-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 935</span>
935:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">normalized_userinfo</span>
936:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">userinfo</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@normalized_userinfo</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
937:         <span class="ruby-identifier">current_user</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_user</span>
938:         <span class="ruby-identifier">current_password</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_password</span>
939:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
940:           <span class="ruby-keyword kw">nil</span>
941:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_password</span>
942:           <span class="ruby-node">&quot;#{current_user}:#{current_password}&quot;</span>
943:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
944:           <span class="ruby-node">&quot;#{current_user}&quot;</span>
945:         <span class="ruby-keyword kw">end</span>
946:       <span class="ruby-keyword kw">end</span>)
947:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="omit-method" class="method-detail ">
				<a name="method-i-omit"></a>

				<div class="method-heading">
				
					<span class="method-name">omit</span><span
						class="method-args">(*components)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Omits components from a <a href="URI.html">URI</a>.
</p>
<p>
@param [Symbol] *components The components to be omitted.
</p>
<p>
@return [Addressable::URI] The <a href="URI.html">URI</a> with components
omitted.
</p>
<p>
@example
</p>
<pre>
  uri = Addressable::URI.parse(&quot;http://example.com/path?query&quot;)
  #=&gt; #&lt;Addressable::URI:0xcc5e7a URI:http://example.com/path?query&gt;
  uri.omit(:scheme, :authority)
  #=&gt; #&lt;Addressable::URI:0xcc4d86 URI:/path?query&gt;</pre>
					

					
					<div class="method-source-code"
						id="omit-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2094</span>
2094:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">omit</span>(*<span class="ruby-identifier">components</span>)
2095:       <span class="ruby-identifier">invalid_components</span> = <span class="ruby-identifier">components</span> <span class="ruby-operator">-</span> [
2096:         <span class="ruby-value">:scheme</span>, <span class="ruby-value">:user</span>, <span class="ruby-value">:password</span>, <span class="ruby-value">:userinfo</span>, <span class="ruby-value">:host</span>, <span class="ruby-value">:port</span>, <span class="ruby-value">:authority</span>,
2097:         <span class="ruby-value">:path</span>, <span class="ruby-value">:query</span>, <span class="ruby-value">:fragment</span>
2098:       ]
2099:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">invalid_components</span>.<span class="ruby-identifier">empty?</span>
2100:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
2101:           <span class="ruby-node">&quot;Invalid component names: #{invalid_components.inspect}.&quot;</span>
2102:       <span class="ruby-keyword kw">end</span>
2103:       <span class="ruby-identifier">duplicated_uri</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dup</span>
2104:       <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">defer_validation</span> <span class="ruby-keyword kw">do</span>
2105:         <span class="ruby-identifier">components</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">component</span><span class="ruby-operator">|</span>
2106:           <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">send</span>((<span class="ruby-identifier">component</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">+</span> <span class="ruby-value str">&quot;=&quot;</span>).<span class="ruby-identifier">to_sym</span>, <span class="ruby-keyword kw">nil</span>)
2107:         <span class="ruby-keyword kw">end</span>
2108:         <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">duplicated_uri</span>.<span class="ruby-identifier">normalized_user</span>
2109:       <span class="ruby-keyword kw">end</span>
2110:       <span class="ruby-identifier">duplicated_uri</span>
2111:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="omit--method" class="method-detail ">
				<a name="method-i-omit%21"></a>

				<div class="method-heading">
				
					<span class="method-name">omit!</span><span
						class="method-args">(*components)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Destructive form of omit.
</p>
<p>
@param [Symbol] *components The components to be omitted.
</p>
<p>
@return [Addressable::URI] The <a href="URI.html">URI</a> with components
omitted.
</p>
<p>
@see <a href="URI.html#method-i-omit">Addressable::URI#omit</a>
</p>
					

					
					<div class="method-source-code"
						id="omit--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2121</span>
2121:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">omit!</span>(*<span class="ruby-identifier">components</span>)
2122:       <span class="ruby-identifier">replace_self</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">omit</span>(*<span class="ruby-identifier">components</span>))
2123:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="origin-method" class="method-detail ">
				<a name="method-i-origin"></a>

				<div class="method-heading">
				
					<span class="method-name">origin</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The origin for this <a href="URI.html">URI</a>, serialized to ASCII, as per
draft-ietf-websec-origin-00, section 5.2.
</p>
<p>
@return [String] The serialized origin.
</p>
					

					
					<div class="method-source-code"
						id="origin-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1119</span>
1119:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">origin</span>
1120:       <span class="ruby-keyword kw">return</span> (<span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span>
1121:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalized_port</span>
1122:           (
1123:             <span class="ruby-node">&quot;#{self.normalized_scheme}://#{self.normalized_host}&quot;</span> <span class="ruby-operator">+</span>
1124:             <span class="ruby-node">&quot;:#{self.normalized_port}&quot;</span>
1125:           )
1126:         <span class="ruby-keyword kw">else</span>
1127:           <span class="ruby-node">&quot;#{self.normalized_scheme}://#{self.normalized_host}&quot;</span>
1128:         <span class="ruby-keyword kw">end</span>
1129:       <span class="ruby-keyword kw">else</span>
1130:         <span class="ruby-value str">&quot;null&quot;</span>
1131:       <span class="ruby-keyword kw">end</span>)
1132:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="password-method" class="method-detail ">
				<a name="method-i-password"></a>

				<div class="method-heading">
				
					<span class="method-name">password</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The password component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The password component.
</p>
					

					
					<div class="method-source-code"
						id="password-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 863</span>
863:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">password</span>
864:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@password</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@password</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
865:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="password--method" class="method-detail ">
				<a name="method-i-password%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">password=</span><span
						class="method-args">(new_password)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the password component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_password The
new password component.
</p>
					

					
					<div class="method-source-code"
						id="password--source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 889</span>
889:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">password=</span>(<span class="ruby-identifier">new_password</span>)
890:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_password</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_password</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
891:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_password.class} into String.&quot;</span>
892:       <span class="ruby-keyword kw">end</span>
893:       <span class="ruby-ivar">@password</span> = <span class="ruby-identifier">new_password</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_password</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
894: 
895:       <span class="ruby-comment cmt"># You can't have a nil user with a non-nil password</span>
896:       <span class="ruby-ivar">@password</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
897:       <span class="ruby-ivar">@user</span> <span class="ruby-operator">||=</span> <span class="ruby-keyword kw">nil</span>
898:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@password</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
899:         <span class="ruby-ivar">@user</span> = <span class="ruby-constant">EMPTY_STR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">nil?</span>
900:       <span class="ruby-keyword kw">end</span>
901: 
902:       <span class="ruby-comment cmt"># Reset dependant values</span>
903:       <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword kw">nil</span>
904:       <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword kw">nil</span>
905:       <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword kw">nil</span>
906:       <span class="ruby-ivar">@normalized_password</span> = <span class="ruby-keyword kw">nil</span>
907:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
908:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
909: 
910:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
911:       <span class="ruby-identifier">validate</span>()
912:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="path-method" class="method-detail ">
				<a name="method-i-path"></a>

				<div class="method-heading">
				
					<span class="method-name">path</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The path component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The path component.
</p>
					

					
					<div class="method-source-code"
						id="path-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1280</span>
1280:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">path</span>
1281:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@path</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">EMPTY_STR</span>
1282:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="path--method" class="method-detail ">
				<a name="method-i-path%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">path=</span><span
						class="method-args">(new_path)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the path component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_path The new
path component.
</p>
					

					
					<div class="method-source-code"
						id="path--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1318</span>
1318:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">path=</span>(<span class="ruby-identifier">new_path</span>)
1319:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_path</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_path</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1320:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_path.class} into String.&quot;</span>
1321:       <span class="ruby-keyword kw">end</span>
1322:       <span class="ruby-ivar">@path</span> = (<span class="ruby-identifier">new_path</span> <span class="ruby-operator">||</span> <span class="ruby-constant">EMPTY_STR</span>).<span class="ruby-identifier">to_str</span>
1323:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-ivar">@path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">!=</span> <span class="ruby-constant">SLASH</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">host</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1324:         <span class="ruby-ivar">@path</span> = <span class="ruby-node">&quot;/#{@path}&quot;</span>
1325:       <span class="ruby-keyword kw">end</span>
1326: 
1327:       <span class="ruby-comment cmt"># Reset dependant values</span>
1328:       <span class="ruby-ivar">@normalized_path</span> = <span class="ruby-keyword kw">nil</span>
1329:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1330:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1331:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="port-method" class="method-detail ">
				<a name="method-i-port"></a>

				<div class="method-heading">
				
					<span class="method-name">port</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The port component for this <a href="URI.html">URI</a>. This is the port
number actually given in the <a href="URI.html">URI</a>. This does not
infer port numbers from default values.
</p>
<p>
@return [Integer] The port component.
</p>
					

					
					<div class="method-source-code"
						id="port-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1154</span>
1154:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">port</span>
1155:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@port</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@port</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1156:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="port--method" class="method-detail ">
				<a name="method-i-port%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">port=</span><span
						class="method-args">(new_port)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the port component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, Integer, <a href="URI.html#method-i-to_s">#</a>] new_port
The new port component.
</p>
					

					
					<div class="method-source-code"
						id="port--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1174</span>
1174:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">port=</span>(<span class="ruby-identifier">new_port</span>)
1175:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1176:         <span class="ruby-identifier">new_port</span> = <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_str</span>)
1177:       <span class="ruby-keyword kw">end</span>
1178:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span>(<span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\d+$/</span>)
1179:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
1180:           <span class="ruby-node">&quot;Invalid port number: #{new_port.inspect}&quot;</span>
1181:       <span class="ruby-keyword kw">end</span>
1182: 
1183:       <span class="ruby-ivar">@port</span> = <span class="ruby-identifier">new_port</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">to_i</span>
1184:       <span class="ruby-ivar">@port</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@port</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
1185: 
1186:       <span class="ruby-comment cmt"># Reset dependant values</span>
1187:       <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword kw">nil</span>
1188:       <span class="ruby-ivar">@normalized_port</span> = <span class="ruby-keyword kw">nil</span>
1189:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1190:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1191: 
1192:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
1193:       <span class="ruby-identifier">validate</span>()
1194:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="query-method" class="method-detail ">
				<a name="method-i-query"></a>

				<div class="method-heading">
				
					<span class="method-name">query</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The query component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The query component.
</p>
					

					
					<div class="method-source-code"
						id="query-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1356</span>
1356:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query</span>
1357:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@query</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@query</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1358:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="query--method" class="method-detail ">
				<a name="method-i-query%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">query=</span><span
						class="method-args">(new_query)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the query component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_query The new
query component.
</p>
					

					
					<div class="method-source-code"
						id="query--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1379</span>
1379:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query=</span>(<span class="ruby-identifier">new_query</span>)
1380:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_query</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1381:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_query.class} into String.&quot;</span>
1382:       <span class="ruby-keyword kw">end</span>
1383:       <span class="ruby-ivar">@query</span> = <span class="ruby-identifier">new_query</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_query</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1384: 
1385:       <span class="ruby-comment cmt"># Reset dependant values</span>
1386:       <span class="ruby-ivar">@normalized_query</span> = <span class="ruby-keyword kw">nil</span>
1387:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1388:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1389:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="query-values-method" class="method-detail ">
				<a name="method-i-query_values"></a>

				<div class="method-heading">
				
					<span class="method-name">query_values</span><span
						class="method-args">(options={})</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Converts the query component to a Hash value.
</p>
<p>
@option [Symbol] notation
</p>
<pre>
  May be one of &lt;code&gt;:flat&lt;/code&gt;, &lt;code&gt;:dot&lt;/code&gt;, or
  &lt;code&gt;:subscript&lt;/code&gt;. The &lt;code&gt;:dot&lt;/code&gt; notation is not
  supported for assignment. Default value is &lt;code&gt;:subscript&lt;/code&gt;.
</pre>
<p>
@return [Hash, Array] The query string parsed as a Hash or Array object.
</p>
<p>
@example
</p>
<pre>
  Addressable::URI.parse(&quot;?one=1&amp;two=2&amp;three=3&quot;).query_values
  #=&gt; {&quot;one&quot; =&gt; &quot;1&quot;, &quot;two&quot; =&gt; &quot;2&quot;, &quot;three&quot; =&gt; &quot;3&quot;}
  Addressable::URI.parse(&quot;?one[two][three]=four&quot;).query_values
  #=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; &quot;four&quot;}}}
  Addressable::URI.parse(&quot;?one.two.three=four&quot;).query_values(
    :notation =&gt; :dot
  )
  #=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; &quot;four&quot;}}}
  Addressable::URI.parse(&quot;?one[two][three]=four&quot;).query_values(
    :notation =&gt; :flat
  )
  #=&gt; {&quot;one[two][three]&quot; =&gt; &quot;four&quot;}
  Addressable::URI.parse(&quot;?one.two.three=four&quot;).query_values(
    :notation =&gt; :flat
  )
  #=&gt; {&quot;one.two.three&quot; =&gt; &quot;four&quot;}
  Addressable::URI.parse(
    &quot;?one[two][three][]=four&amp;one[two][three][]=five&quot;
  ).query_values
  #=&gt; {&quot;one&quot; =&gt; {&quot;two&quot; =&gt; {&quot;three&quot; =&gt; [&quot;four&quot;, &quot;five&quot;]}}}
  Addressable::URI.parse(
    &quot;?one=two&amp;one=three&quot;).query_values(:notation =&gt; :flat_array)
  #=&gt; [['one', 'two'], ['one', 'three']]</pre>
					

					
					<div class="method-source-code"
						id="query-values-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1425</span>
1425:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_values</span>(<span class="ruby-identifier">options</span>={})
1426:       <span class="ruby-identifier">defaults</span> = {<span class="ruby-value">:notation</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:subscript</span>}
1427:       <span class="ruby-identifier">options</span> = <span class="ruby-identifier">defaults</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
1428:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span>[<span class="ruby-value">:flat</span>, <span class="ruby-value">:dot</span>, <span class="ruby-value">:subscript</span>, <span class="ruby-value">:flat_array</span>].<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>])
1429:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>,
1430:           <span class="ruby-value str">&quot;Invalid notation. Must be one of: &quot;</span> <span class="ruby-operator">+</span>
1431:           <span class="ruby-value str">&quot;[:flat, :dot, :subscript, :flat_array].&quot;</span>
1432:       <span class="ruby-keyword kw">end</span>
1433:       <span class="ruby-identifier">dehash</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">hash</span><span class="ruby-operator">|</span>
1434:         <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span>(<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
1435:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>)
1436:             <span class="ruby-identifier">hash</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">dehash</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>)
1437:           <span class="ruby-keyword kw">end</span>
1438:         <span class="ruby-keyword kw">end</span>
1439:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">hash</span> <span class="ruby-operator">!=</span> {} <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">all?</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">key</span><span class="ruby-operator">|</span> <span class="ruby-identifier">key</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/^\d+$/</span> }
1440:           <span class="ruby-identifier">hash</span>.<span class="ruby-identifier">sort</span>.<span class="ruby-identifier">inject</span>([]) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accu</span>, (<span class="ruby-identifier">_</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
1441:             <span class="ruby-identifier">accu</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>; <span class="ruby-identifier">accu</span>
1442:           <span class="ruby-keyword kw">end</span>
1443:         <span class="ruby-keyword kw">else</span>
1444:           <span class="ruby-identifier">hash</span>
1445:         <span class="ruby-keyword kw">end</span>
1446:       <span class="ruby-keyword kw">end</span>
1447:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
1448:       <span class="ruby-identifier">empty_accumulator</span> = <span class="ruby-value">:flat_array</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">?</span> [] <span class="ruby-operator">:</span> {}
1449:       <span class="ruby-keyword kw">return</span> ((<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;&amp;&quot;</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">pair</span><span class="ruby-operator">|</span>
1450:         <span class="ruby-identifier">pair</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;=&quot;</span>, <span class="ruby-value">2</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">pair</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">pair</span>.<span class="ruby-identifier">empty?</span>
1451:       <span class="ruby-keyword kw">end</span>).<span class="ruby-identifier">compact</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">empty_accumulator</span>.<span class="ruby-identifier">dup</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accumulator</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
1452:         <span class="ruby-identifier">value</span> = <span class="ruby-keyword kw">true</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">nil?</span>
1453:         <span class="ruby-identifier">key</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">key</span>)
1454:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">true</span>
1455:           <span class="ruby-identifier">value</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">unencode_component</span>(<span class="ruby-identifier">value</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-regexp re">/\+/</span>, <span class="ruby-value str">&quot; &quot;</span>))
1456:         <span class="ruby-keyword kw">end</span>
1457:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat</span>
1458:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>]
1459:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Key was repeated: #{key.inspect}&quot;</span>
1460:           <span class="ruby-keyword kw">end</span>
1461:           <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
1462:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat_array</span>
1463:           <span class="ruby-identifier">accumulator</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
1464:         <span class="ruby-keyword kw">else</span>
1465:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:dot</span>
1466:             <span class="ruby-identifier">array_value</span> = <span class="ruby-keyword kw">false</span>
1467:             <span class="ruby-identifier">subkeys</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;.&quot;</span>)
1468:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:subscript</span>
1469:             <span class="ruby-identifier">array_value</span> = <span class="ruby-operator">!</span><span class="ruby-operator">!</span>(<span class="ruby-identifier">key</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\[\]$/</span>)
1470:             <span class="ruby-identifier">subkeys</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/[\[\]]+/</span>)
1471:           <span class="ruby-keyword kw">end</span>
1472:           <span class="ruby-identifier">current_hash</span> = <span class="ruby-identifier">accumulator</span>
1473:           <span class="ruby-keyword kw">for</span> <span class="ruby-identifier">i</span> <span class="ruby-keyword kw">in</span> <span class="ruby-value">0</span><span class="ruby-operator">...</span>(<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">-</span> <span class="ruby-value">1</span>)
1474:             <span class="ruby-identifier">subkey</span> = <span class="ruby-identifier">subkeys</span>[<span class="ruby-identifier">i</span>]
1475:             <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>] = {} <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>]
1476:             <span class="ruby-identifier">current_hash</span> = <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkey</span>]
1477:           <span class="ruby-keyword kw">end</span>
1478:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">array_value</span>
1479:             <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] = [] <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>]
1480:             <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">value</span>
1481:           <span class="ruby-keyword kw">else</span>
1482:             <span class="ruby-identifier">current_hash</span>[<span class="ruby-identifier">subkeys</span>.<span class="ruby-identifier">last</span>] = <span class="ruby-identifier">value</span>
1483:           <span class="ruby-keyword kw">end</span>
1484:         <span class="ruby-keyword kw">end</span>
1485:         <span class="ruby-identifier">accumulator</span>
1486:       <span class="ruby-keyword kw">end</span>).<span class="ruby-identifier">inject</span>(<span class="ruby-identifier">empty_accumulator</span>.<span class="ruby-identifier">dup</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">accumulator</span>, (<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>)<span class="ruby-operator">|</span>
1487:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>[<span class="ruby-value">:notation</span>] <span class="ruby-operator">==</span> <span class="ruby-value">:flat_array</span>
1488:           <span class="ruby-identifier">accumulator</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
1489:         <span class="ruby-keyword kw">else</span>
1490:           <span class="ruby-identifier">accumulator</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Hash</span>) <span class="ruby-operator">?</span> <span class="ruby-identifier">dehash</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">value</span>) <span class="ruby-operator">:</span> <span class="ruby-identifier">value</span>
1491:         <span class="ruby-keyword kw">end</span>
1492:         <span class="ruby-identifier">accumulator</span>
1493:       <span class="ruby-keyword kw">end</span>
1494:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="query-values--method" class="method-detail ">
				<a name="method-i-query_values%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">query_values=</span><span
						class="method-args">(new_query_values)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the query component for this <a href="URI.html">URI</a> from a Hash
object. This method produces a query string using the :subscript notation.
An empty Hash will result in a nil query.
</p>
<p>
@param [Hash, <a href="URI.html#method-i-to_hash">#</a>, Array]
new_query_values The new query values.
</p>
					

					
					<div class="method-source-code"
						id="query-values--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1502</span>
1502:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">query_values=</span>(<span class="ruby-identifier">new_query_values</span>)
1503:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_query_values</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
1504:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-keyword kw">nil</span>
1505:         <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1506:       <span class="ruby-keyword kw">end</span>
1507: 
1508:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
1509:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_hash</span>)
1510:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>,
1511:             <span class="ruby-node">&quot;Can't convert #{new_query_values.class} into Hash.&quot;</span>
1512:         <span class="ruby-keyword kw">end</span>
1513:         <span class="ruby-identifier">new_query_values</span> = <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">to_hash</span>
1514:         <span class="ruby-identifier">new_query_values</span> = <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1515:           <span class="ruby-identifier">key</span> = <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">Symbol</span>)
1516:           [<span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span>]
1517:         <span class="ruby-keyword kw">end</span>
1518:         <span class="ruby-comment cmt"># Useful default for OAuth and caching.</span>
1519:         <span class="ruby-comment cmt"># Only to be used for non-Array inputs. Arrays should preserve order.</span>
1520:         <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">sort!</span>
1521:       <span class="ruby-keyword kw">end</span>
1522: 
1523:       <span class="ruby-comment cmt">##</span>
1524:       <span class="ruby-comment cmt"># Joins and converts parent and value into a properly encoded and</span>
1525:       <span class="ruby-comment cmt"># ordered URL query.</span>
1526:       <span class="ruby-comment cmt">#</span>
1527:       <span class="ruby-comment cmt"># @private</span>
1528:       <span class="ruby-comment cmt"># @param [String] parent an URI encoded component.</span>
1529:       <span class="ruby-comment cmt"># @param [Array, Hash, Symbol, #to_str] value</span>
1530:       <span class="ruby-comment cmt">#</span>
1531:       <span class="ruby-comment cmt"># @return [String] a properly escaped and ordered URL query.</span>
1532:       <span class="ruby-identifier">to_query</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parent</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1533:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Hash</span>)
1534:           <span class="ruby-identifier">value</span> = <span class="ruby-identifier">value</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
1535:             [
1536:               <span class="ruby-constant">URI</span>.<span class="ruby-identifier">encode_component</span>(<span class="ruby-identifier">key</span>, <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>),
1537:               <span class="ruby-identifier">val</span>
1538:             ]
1539:           <span class="ruby-keyword kw">end</span>
1540:           <span class="ruby-identifier">value</span>.<span class="ruby-identifier">sort!</span>
1541:           <span class="ruby-identifier">buffer</span> = <span class="ruby-value str">&quot;&quot;</span>
1542:           <span class="ruby-identifier">value</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
1543:             <span class="ruby-identifier">new_parent</span> = <span class="ruby-node">&quot;#{parent}[#{key}]&quot;</span>
1544:             <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{to_query.call(new_parent, val)}&amp;&quot;</span>
1545:           <span class="ruby-keyword kw">end</span>
1546:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">chop</span>
1547:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">Array</span>)
1548:           <span class="ruby-identifier">buffer</span> = <span class="ruby-value str">&quot;&quot;</span>
1549:           <span class="ruby-identifier">value</span>.<span class="ruby-identifier">each_with_index</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span>, <span class="ruby-identifier">i</span><span class="ruby-operator">|</span>
1550:             <span class="ruby-identifier">new_parent</span> = <span class="ruby-node">&quot;#{parent}[#{i}]&quot;</span>
1551:             <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{to_query.call(new_parent, val)}&amp;&quot;</span>
1552:           <span class="ruby-keyword kw">end</span>
1553:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">chop</span>
1554:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">value</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">true</span>
1555:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">parent</span>
1556:         <span class="ruby-keyword kw">else</span>
1557:           <span class="ruby-identifier">encoded_value</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">encode_component</span>(
1558:             <span class="ruby-identifier">value</span>, <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
1559:           )
1560:           <span class="ruby-keyword kw">return</span> <span class="ruby-node">&quot;#{parent}=#{encoded_value}&quot;</span>
1561:         <span class="ruby-keyword kw">end</span>
1562:       <span class="ruby-keyword kw">end</span>
1563: 
1564:       <span class="ruby-comment cmt"># new_query_values have form [['key1', 'value1'], ['key2', 'value2']]</span>
1565:       <span class="ruby-identifier">buffer</span> = <span class="ruby-value str">&quot;&quot;</span>
1566:       <span class="ruby-identifier">new_query_values</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">parent</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1567:         <span class="ruby-identifier">encoded_parent</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">encode_component</span>(
1568:           <span class="ruby-identifier">parent</span>, <span class="ruby-constant">CharacterClasses</span><span class="ruby-operator">::</span><span class="ruby-constant">UNRESERVED</span>
1569:         )
1570:         <span class="ruby-identifier">buffer</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{to_query.call(encoded_parent, value)}&amp;&quot;</span>
1571:       <span class="ruby-keyword kw">end</span>
1572:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">buffer</span>.<span class="ruby-identifier">chop</span>
1573:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="relative--method" class="method-detail ">
				<a name="method-i-relative%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">relative?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Determines if the <a href="URI.html">URI</a> is relative.
</p>
<p>
@return [TrueClass, FalseClass]
</p>
<pre>
  &lt;code&gt;true&lt;/code&gt; if the URI is relative. &lt;code&gt;false&lt;/code&gt;
  otherwise.</pre>
					

					
					<div class="method-source-code"
						id="relative--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1673</span>
1673:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">relative?</span>
1674:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>.<span class="ruby-identifier">nil?</span>
1675:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="request-uri-method" class="method-detail ">
				<a name="method-i-request_uri"></a>

				<div class="method-heading">
				
					<span class="method-name">request_uri</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The HTTP request <a href="URI.html">URI</a> for this <a
href="URI.html">URI</a>.  This is the path and the query string.
</p>
<p>
@return [String] The request <a href="URI.html">URI</a> required for an
HTTP request.
</p>
					

					
					<div class="method-source-code"
						id="request-uri-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1580</span>
1580:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_uri</span>
1581:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">absolute?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/^https?$/</span>
1582:       <span class="ruby-keyword kw">return</span> (
1583:         (<span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SLASH</span>) <span class="ruby-operator">+</span>
1584:         (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">?</span> <span class="ruby-node">&quot;?#{self.query}&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-constant">EMPTY_STR</span>)
1585:       )
1586:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="request-uri--method" class="method-detail ">
				<a name="method-i-request_uri%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">request_uri=</span><span
						class="method-args">(new_request_uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the HTTP request <a href="URI.html">URI</a> for this <a
href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_request_uri
The new HTTP request <a href="URI.html">URI</a>.
</p>
					

					
					<div class="method-source-code"
						id="request-uri--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1592</span>
1592:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">request_uri=</span>(<span class="ruby-identifier">new_request_uri</span>)
1593:       <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_request_uri</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1594:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_request_uri.class} into String.&quot;</span>
1595:       <span class="ruby-keyword kw">end</span>
1596:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">absolute?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/^https?$/</span>
1597:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
1598:           <span class="ruby-value str">&quot;Cannot set an HTTP request URI for a non-HTTP URI.&quot;</span>
1599:       <span class="ruby-keyword kw">end</span>
1600:       <span class="ruby-identifier">new_request_uri</span> = <span class="ruby-identifier">new_request_uri</span>.<span class="ruby-identifier">to_str</span>
1601:       <span class="ruby-identifier">path_component</span> = <span class="ruby-identifier">new_request_uri</span>[<span class="ruby-regexp re">/^([^\?]*)\?(?:.*)$/</span>, <span class="ruby-value">1</span>]
1602:       <span class="ruby-identifier">query_component</span> = <span class="ruby-identifier">new_request_uri</span>[<span class="ruby-regexp re">/^(?:[^\?]*)\?(.*)$/</span>, <span class="ruby-value">1</span>]
1603:       <span class="ruby-identifier">path_component</span> = <span class="ruby-identifier">path_component</span>.<span class="ruby-identifier">to_s</span>
1604:       <span class="ruby-identifier">path_component</span> = (<span class="ruby-operator">!</span><span class="ruby-identifier">path_component</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">path_component</span> <span class="ruby-operator">:</span> <span class="ruby-constant">SLASH</span>)
1605:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">path_component</span>
1606:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> = <span class="ruby-identifier">query_component</span>
1607: 
1608:       <span class="ruby-comment cmt"># Reset dependant values</span>
1609:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
1610:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
1611:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="route-from-method" class="method-detail ">
				<a name="method-i-route_from"></a>

				<div class="method-heading">
				
					<span class="method-name">route_from</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the shortest normalized relative form of this <a
href="URI.html">URI</a> that uses the supplied <a href="URI.html">URI</a>
as a base for resolution. Returns an absolute <a href="URI.html">URI</a> if
necessary. This is effectively the opposite of <tt><a
href="URI.html#method-i-route_to">route_to</a></tt>.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri The <a href="URI.html">URI</a>
to route from.
</p>
<p>
@return [Addressable::URI]
</p>
<pre>
  The normalized relative URI that is equivalent to the original URI.</pre>
					

					
					<div class="method-source-code"
						id="route-from-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1889</span>
1889:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">route_from</span>(<span class="ruby-identifier">uri</span>)
1890:       <span class="ruby-identifier">uri</span> = <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">normalize</span>
1891:       <span class="ruby-identifier">normalized_self</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">normalize</span>
1892:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">relative?</span>
1893:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Expected absolute URI, got: #{self.to_s}&quot;</span>
1894:       <span class="ruby-keyword kw">end</span>
1895:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">relative?</span>
1896:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Expected absolute URI, got: #{uri.to_s}&quot;</span>
1897:       <span class="ruby-keyword kw">end</span>
1898:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>
1899:         <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-node">&quot;##{normalized_self.fragment}&quot;</span>)
1900:       <span class="ruby-keyword kw">end</span>
1901:       <span class="ruby-identifier">components</span> = <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">to_hash</span>
1902:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>
1903:         <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>] = <span class="ruby-keyword kw">nil</span>
1904:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">authority</span>
1905:           <span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>] = <span class="ruby-keyword kw">nil</span>
1906:           <span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>] = <span class="ruby-keyword kw">nil</span>
1907:           <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>] = <span class="ruby-keyword kw">nil</span>
1908:           <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>] = <span class="ruby-keyword kw">nil</span>
1909:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
1910:             <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>] = <span class="ruby-keyword kw">nil</span>
1911:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
1912:               <span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>] = <span class="ruby-keyword kw">nil</span>
1913:             <span class="ruby-keyword kw">end</span>
1914:           <span class="ruby-keyword kw">else</span>
1915:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">!=</span> <span class="ruby-constant">SLASH</span>
1916:               <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>].<span class="ruby-identifier">gsub!</span>(
1917:                 <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;^&quot;</span> <span class="ruby-operator">+</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>)), <span class="ruby-constant">EMPTY_STR</span>)
1918:             <span class="ruby-keyword kw">end</span>
1919:           <span class="ruby-keyword kw">end</span>
1920:         <span class="ruby-keyword kw">end</span>
1921:       <span class="ruby-keyword kw">end</span>
1922:       <span class="ruby-comment cmt"># Avoid network-path references.</span>
1923:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>] <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1924:         <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>] = <span class="ruby-identifier">normalized_self</span>.<span class="ruby-identifier">scheme</span>
1925:       <span class="ruby-keyword kw">end</span>
1926:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Addressable</span><span class="ruby-operator">::</span><span class="ruby-constant">URI</span>.<span class="ruby-identifier">new</span>(
1927:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:scheme</span>],
1928:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:user</span>],
1929:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:password</span>],
1930:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:host</span>],
1931:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:port</span>],
1932:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:path</span>],
1933:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:query</span>],
1934:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">components</span>[<span class="ruby-value">:fragment</span>]
1935:       )
1936:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="route-to-method" class="method-detail ">
				<a name="method-i-route_to"></a>

				<div class="method-heading">
				
					<span class="method-name">route_to</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns the shortest normalized relative form of the supplied <a
href="URI.html">URI</a> that uses this <a href="URI.html">URI</a> as a base
for resolution. Returns an absolute <a href="URI.html">URI</a> if
necessary. This is effectively the opposite of <tt><a
href="URI.html#method-i-route_from">route_from</a></tt>.
</p>
<p>
@param [String, <a href="URI.html">Addressable::URI</a>, <a
href="URI.html#method-i-to_str">#</a>] uri The <a href="URI.html">URI</a>
to route to.
</p>
<p>
@return [Addressable::URI]
</p>
<pre>
  The normalized relative URI that is equivalent to the supplied URI.</pre>
					

					
					<div class="method-source-code"
						id="route-to-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1947</span>
1947:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">route_to</span>(<span class="ruby-identifier">uri</span>)
1948:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">uri</span>).<span class="ruby-identifier">route_from</span>(<span class="ruby-keyword kw">self</span>)
1949:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="scheme-method" class="method-detail ">
				<a name="method-i-scheme"></a>

				<div class="method-heading">
				
					<span class="method-name">scheme</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The scheme component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The scheme component.
</p>
					

					
					<div class="method-source-code"
						id="scheme-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 760</span>
760:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scheme</span>
761:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@scheme</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@scheme</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
762:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="scheme--method" class="method-detail ">
				<a name="method-i-scheme%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">scheme=</span><span
						class="method-args">(new_scheme)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the scheme component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_scheme The
new scheme component.
</p>
					

					
					<div class="method-source-code"
						id="scheme--source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 785</span>
785:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">scheme=</span>(<span class="ruby-identifier">new_scheme</span>)
786:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_scheme</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
787:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_scheme.class} into String.&quot;</span>
788:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">new_scheme</span>
789:         <span class="ruby-identifier">new_scheme</span> = <span class="ruby-identifier">new_scheme</span>.<span class="ruby-identifier">to_str</span>
790:       <span class="ruby-keyword kw">end</span>
791:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">new_scheme</span> <span class="ruby-operator">!~</span> <span class="ruby-regexp re">/[a-z][a-z0-9\.\+\-]*/</span>
792:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>, <span class="ruby-value str">&quot;Invalid scheme format.&quot;</span>
793:       <span class="ruby-keyword kw">end</span>
794:       <span class="ruby-ivar">@scheme</span> = <span class="ruby-identifier">new_scheme</span>
795:       <span class="ruby-ivar">@scheme</span> = <span class="ruby-keyword kw">nil</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@scheme</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">strip</span>.<span class="ruby-identifier">empty?</span>
796: 
797:       <span class="ruby-comment cmt"># Reset dependant values</span>
798:       <span class="ruby-ivar">@normalized_scheme</span> = <span class="ruby-keyword kw">nil</span>
799:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
800:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
801: 
802:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
803:       <span class="ruby-identifier">validate</span>()
804:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="site-method" class="method-detail ">
				<a name="method-i-site"></a>

				<div class="method-heading">
				
					<span class="method-name">site</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The combination of components that represent a site. Combines the scheme,
user, password, host, and port components. Primarily useful for HTTP and
HTTPS.
</p>
<p>
For example, <tt>&quot;<a
href="http://example.com/path?query">example.com/path?query</a>&quot;</tt>
would have a <tt>site</tt> value of <tt>&quot;<a
href="http://example.com">example.com</a>&quot;</tt>.
</p>
<p>
@return [String] The components that identify a site.
</p>
					

					
					<div class="method-source-code"
						id="site-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1223</span>
1223:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">site</span>
1224:       (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@site</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
1225:         <span class="ruby-identifier">site_string</span> = <span class="ruby-value str">&quot;&quot;</span>
1226:         <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.scheme}:&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1227:         <span class="ruby-identifier">site_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.authority}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
1228:         <span class="ruby-identifier">site_string</span>
1229:       <span class="ruby-keyword kw">end</span>)
1230:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="site--method" class="method-detail ">
				<a name="method-i-site%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">site=</span><span
						class="method-args">(new_site)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the site value for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_site The new
site value.
</p>
					

					
					<div class="method-source-code"
						id="site--source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 1258</span>
1258:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">site=</span>(<span class="ruby-identifier">new_site</span>)
1259:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_site</span>
1260:         <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_site</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
1261:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_site.class} into String.&quot;</span>
1262:         <span class="ruby-keyword kw">end</span>
1263:         <span class="ruby-identifier">new_site</span> = <span class="ruby-identifier">new_site</span>.<span class="ruby-identifier">to_str</span>
1264:         <span class="ruby-comment cmt"># These two regular expressions derived from the primary parsing</span>
1265:         <span class="ruby-comment cmt"># expression</span>
1266:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-identifier">new_site</span>[<span class="ruby-node">/^(?:([^:\/?#]+):)?(?:\/\/(?:[^\/?#]*))?$/</span>, <span class="ruby-value">1</span>]
1267:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-identifier">new_site</span>[
1268:           <span class="ruby-node">/^(?:(?:[^:\/?#]+):)?(?:\/\/([^\/?#]*))?$/</span>, <span class="ruby-value">1</span>
1269:         ]
1270:       <span class="ruby-keyword kw">else</span>
1271:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> = <span class="ruby-keyword kw">nil</span>
1272:         <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> = <span class="ruby-keyword kw">nil</span>
1273:       <span class="ruby-keyword kw">end</span>
1274:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="to-hash-method" class="method-detail ">
				<a name="method-i-to_hash"></a>

				<div class="method-heading">
				
					<span class="method-name">to_hash</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a Hash of the <a href="URI.html">URI</a> components.
</p>
<p>
@return [Hash] The <a href="URI.html">URI</a> as a <tt>Hash</tt> of
components.
</p>
					

					
					<div class="method-source-code"
						id="to-hash-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2157</span>
2157:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_hash</span>
2158:       <span class="ruby-keyword kw">return</span> {
2159:         <span class="ruby-value">:scheme</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span>,
2160:         <span class="ruby-value">:user</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>,
2161:         <span class="ruby-value">:password</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>,
2162:         <span class="ruby-value">:host</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>,
2163:         <span class="ruby-value">:port</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span>,
2164:         <span class="ruby-value">:path</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>,
2165:         <span class="ruby-value">:query</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span>,
2166:         <span class="ruby-value">:fragment</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span>
2167:       }
2168:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="to-s-method" class="method-detail ">
				<a name="method-i-to_s"></a>

				<div class="method-heading">
				
					<span class="method-name">to_s</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Converts the <a href="URI.html">URI</a> to a <tt>String</tt>.
</p>
<p>
@return [String] The URI&#8217;s <tt>String</tt> representation.
</p>
					

					
					<div class="method-source-code"
						id="to-s-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2129</span>
2129:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_s</span>
2130:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span>
2131:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">=~</span> <span class="ruby-constant">NORMPATH</span>
2132:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
2133:           <span class="ruby-node">&quot;Cannot assemble URI string with ambiguous path: '#{self.path}'&quot;</span>
2134:       <span class="ruby-keyword kw">end</span>
2135:       <span class="ruby-ivar">@uri_string</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
2136:         <span class="ruby-identifier">uri_string</span> = <span class="ruby-value str">&quot;&quot;</span>
2137:         <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;#{self.scheme}:&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2138:         <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;//#{self.authority}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2139:         <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">to_s</span>
2140:         <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;?#{self.query}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">query</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2141:         <span class="ruby-identifier">uri_string</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot;##{self.fragment}&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">fragment</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2142:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">uri_string</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:force_encoding</span>)
2143:           <span class="ruby-identifier">uri_string</span>.<span class="ruby-identifier">force_encoding</span>(<span class="ruby-constant">Encoding</span><span class="ruby-operator">::</span><span class="ruby-constant">UTF_8</span>)
2144:         <span class="ruby-keyword kw">end</span>
2145:         <span class="ruby-identifier">uri_string</span>
2146:       <span class="ruby-keyword kw">end</span>)
2147:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="URI.html#method-i-to_str">to_str</a>
				</div>
				

				
			</div>

		
			<div id="to-str-method" class="method-detail method-alias">
				<a name="method-i-to_str"></a>

				<div class="method-heading">
				
					<span class="method-name">to_str</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
URI&#8217;s are glorified <tt>Strings</tt>. Allow implicit conversion.
</p>
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="URI.html#method-i-to_s">to_s</a>
				</div>
				
			</div>

		
			<div id="user-method" class="method-detail ">
				<a name="method-i-user"></a>

				<div class="method-heading">
				
					<span class="method-name">user</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The user component for this <a href="URI.html">URI</a>.
</p>
<p>
@return [String] The user component.
</p>
					

					
					<div class="method-source-code"
						id="user-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 810</span>
810:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user</span>
811:       <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">instance_variable_defined?</span>(<span class="ruby-value">:@user</span>) <span class="ruby-operator">?</span> <span class="ruby-ivar">@user</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
812:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="user--method" class="method-detail ">
				<a name="method-i-user%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">user=</span><span
						class="method-args">(new_user)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the user component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_user The new
user component.
</p>
					

					
					<div class="method-source-code"
						id="user--source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 836</span>
836:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">user=</span>(<span class="ruby-identifier">new_user</span>)
837:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_user</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
838:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_user.class} into String.&quot;</span>
839:       <span class="ruby-keyword kw">end</span>
840:       <span class="ruby-ivar">@user</span> = <span class="ruby-identifier">new_user</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">new_user</span>.<span class="ruby-identifier">to_str</span> <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
841: 
842:       <span class="ruby-comment cmt"># You can't have a nil user with a non-nil password</span>
843:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">password</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
844:         <span class="ruby-ivar">@user</span> = <span class="ruby-constant">EMPTY_STR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@user</span>.<span class="ruby-identifier">nil?</span>
845:       <span class="ruby-keyword kw">end</span>
846: 
847:       <span class="ruby-comment cmt"># Reset dependant values</span>
848:       <span class="ruby-ivar">@userinfo</span> = <span class="ruby-keyword kw">nil</span>
849:       <span class="ruby-ivar">@normalized_userinfo</span> = <span class="ruby-keyword kw">nil</span>
850:       <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword kw">nil</span>
851:       <span class="ruby-ivar">@normalized_user</span> = <span class="ruby-keyword kw">nil</span>
852:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
853:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
854: 
855:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
856:       <span class="ruby-identifier">validate</span>()
857:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="userinfo-method" class="method-detail ">
				<a name="method-i-userinfo"></a>

				<div class="method-heading">
				
					<span class="method-name">userinfo</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The userinfo component for this <a href="URI.html">URI</a>. Combines the
user and password components.
</p>
<p>
@return [String] The userinfo component.
</p>
					

					
					<div class="method-source-code"
						id="userinfo-source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 919</span>
919:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">userinfo</span>
920:       <span class="ruby-identifier">current_user</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span>
921:       <span class="ruby-identifier">current_password</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span>
922:       (<span class="ruby-identifier">current_user</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">current_password</span>) <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-ivar">@userinfo</span> <span class="ruby-operator">||=</span> (<span class="ruby-keyword kw">begin</span>
923:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">current_password</span>
924:           <span class="ruby-node">&quot;#{current_user}:#{current_password}&quot;</span>
925:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">current_user</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">current_password</span>
926:           <span class="ruby-node">&quot;#{current_user}&quot;</span>
927:         <span class="ruby-keyword kw">end</span>
928:       <span class="ruby-keyword kw">end</span>)
929:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="userinfo--method" class="method-detail ">
				<a name="method-i-userinfo%3D"></a>

				<div class="method-heading">
				
					<span class="method-name">userinfo=</span><span
						class="method-args">(new_userinfo)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sets the userinfo component for this <a href="URI.html">URI</a>.
</p>
<p>
@param [String, <a href="URI.html#method-i-to_str">#</a>] new_userinfo The
new userinfo component.
</p>
					

					
					<div class="method-source-code"
						id="userinfo--source">
<pre>
     <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 953</span>
953:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">userinfo=</span>(<span class="ruby-identifier">new_userinfo</span>)
954:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_userinfo</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:to_str</span>)
955:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">TypeError</span>, <span class="ruby-node">&quot;Can't convert #{new_userinfo.class} into String.&quot;</span>
956:       <span class="ruby-keyword kw">end</span>
957:       <span class="ruby-identifier">new_user</span>, <span class="ruby-identifier">new_password</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">new_userinfo</span>
958:         [
959:           <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/^(.*):/</span>, <span class="ruby-value">1</span>],
960:           <span class="ruby-identifier">new_userinfo</span>.<span class="ruby-identifier">to_str</span>.<span class="ruby-identifier">strip</span>[<span class="ruby-regexp re">/:(.*)$/</span>, <span class="ruby-value">1</span>]
961:         ]
962:       <span class="ruby-keyword kw">else</span>
963:         [<span class="ruby-keyword kw">nil</span>, <span class="ruby-keyword kw">nil</span>]
964:       <span class="ruby-keyword kw">end</span>
965: 
966:       <span class="ruby-comment cmt"># Password assigned first to ensure validity in case of nil</span>
967:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> = <span class="ruby-identifier">new_password</span>
968:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> = <span class="ruby-identifier">new_user</span>
969: 
970:       <span class="ruby-comment cmt"># Reset dependant values</span>
971:       <span class="ruby-ivar">@authority</span> = <span class="ruby-keyword kw">nil</span>
972:       <span class="ruby-ivar">@uri_string</span> = <span class="ruby-keyword kw">nil</span>
973:       <span class="ruby-ivar">@hash</span> = <span class="ruby-keyword kw">nil</span>
974: 
975:       <span class="ruby-comment cmt"># Ensure we haven't created an invalid URI</span>
976:       <span class="ruby-identifier">validate</span>()
977:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="replace-self-method" class="method-detail ">
				<a name="method-i-replace_self"></a>

				<div class="method-heading">
				
					<span class="method-name">replace_self</span><span
						class="method-args">(uri)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Replaces the internal state of self with the specified URI&#8217;s state.
Used in destructive operations to avoid massive code repetition.
</p>
<p>
@param [Addressable::URI] uri The <a href="URI.html">URI</a> to replace
<tt>self</tt> with.
</p>
<p>
@return [Addressable::URI] <tt>self</tt>.
</p>
					

					
					<div class="method-source-code"
						id="replace-self-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2271</span>
2271:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">replace_self</span>(<span class="ruby-identifier">uri</span>)
2272:       <span class="ruby-comment cmt"># Reset dependant values</span>
2273:       <span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
2274:         <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">var</span>, <span class="ruby-keyword kw">nil</span>)
2275:       <span class="ruby-keyword kw">end</span>
2276: 
2277:       <span class="ruby-ivar">@scheme</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">scheme</span>
2278:       <span class="ruby-ivar">@user</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">user</span>
2279:       <span class="ruby-ivar">@password</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">password</span>
2280:       <span class="ruby-ivar">@host</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">host</span>
2281:       <span class="ruby-ivar">@port</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">port</span>
2282:       <span class="ruby-ivar">@path</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">path</span>
2283:       <span class="ruby-ivar">@query</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">query</span>
2284:       <span class="ruby-ivar">@fragment</span> = <span class="ruby-identifier">uri</span>.<span class="ruby-identifier">fragment</span>
2285:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">self</span>
2286:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="validate-method" class="method-detail ">
				<a name="method-i-validate"></a>

				<div class="method-heading">
				
					<span class="method-name">validate</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Ensures that the <a href="URI.html">URI</a> is valid.
</p>
					

					
					<div class="method-source-code"
						id="validate-source">
<pre>
      <span class="ruby-comment cmt"># File lib/addressable/uri.rb, line 2241</span>
2241:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate</span>
2242:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-operator">!</span><span class="ruby-ivar">@validation_deferred</span>
2243:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">scheme</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span>
2244:           (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span>.<span class="ruby-identifier">empty?</span>) <span class="ruby-operator">&amp;&amp;</span>
2245:           (<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span>)
2246:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
2247:           <span class="ruby-node">&quot;Absolute URI missing hierarchical segment: '#{self.to_s}'&quot;</span>
2248:       <span class="ruby-keyword kw">end</span>
2249:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">host</span> <span class="ruby-operator">==</span> <span class="ruby-keyword kw">nil</span>
2250:         <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">port</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span>
2251:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">user</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">||</span>
2252:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">password</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2253:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>, <span class="ruby-node">&quot;Hostname not supplied: '#{self.to_s}'&quot;</span>
2254:         <span class="ruby-keyword kw">end</span>
2255:       <span class="ruby-keyword kw">end</span>
2256:       <span class="ruby-keyword kw">if</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">0</span>] <span class="ruby-operator">!=</span> <span class="ruby-constant">SLASH</span> <span class="ruby-operator">&amp;&amp;</span>
2257:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">authority</span> <span class="ruby-operator">!=</span> <span class="ruby-keyword kw">nil</span>
2258:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">InvalidURIError</span>,
2259:           <span class="ruby-node">&quot;Cannot have a relative path with an authority set: '#{self.to_s}'&quot;</span>
2260:       <span class="ruby-keyword kw">end</span>
2261:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
2262:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

