<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: MiniMagick::Image</title>

	<link rel="stylesheet" href="../rdoc.css" type="text/css" media="screen" />

	<script src="../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../index.html">Home</a>
          <a href="../index.html#classes">Classes</a>
          <a href="../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../lib/mini_magick_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/mini_magick.rb">lib/mini_magick.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-create">::create</a></li>
					
					<li><a href="#method-c-from_blob">::from_blob</a></li>
					
					<li><a href="#method-c-from_file">::from_file</a></li>
					
					<li><a href="#method-c-import_pixels">::import_pixels</a></li>
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-c-open">::open</a></li>
					
					<li><a href="#method-c-read">::read</a></li>
					
					<li><a href="#method-i-%3C%3C">#<<</a></li>
					
					<li><a href="#method-i-%5B%5D">#[]</a></li>
					
					<li><a href="#method-i-collapse%21">#collapse!</a></li>
					
					<li><a href="#method-i-combine_options">#combine_options</a></li>
					
					<li><a href="#method-i-composite">#composite</a></li>
					
					<li><a href="#method-i-destroy%21">#destroy!</a></li>
					
					<li><a href="#method-i-escaped_path">#escaped_path</a></li>
					
					<li><a href="#method-i-format">#format</a></li>
					
					<li><a href="#method-i-format_option">#format_option</a></li>
					
					<li><a href="#method-i-method_missing">#method_missing</a></li>
					
					<li><a href="#method-i-read_character_data">#read_character_data</a></li>
					
					<li><a href="#method-i-run">#run</a></li>
					
					<li><a href="#method-i-run_command">#run_command</a></li>
					
					<li><a href="#method-i-to_blob">#to_blob</a></li>
					
					<li><a href="#method-i-valid%3F">#valid?</a></li>
					
					<li><a href="#method-i-windows%3F">#windows?</a></li>
					
					<li><a href="#method-i-write">#write</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../MiniMagick.html">MiniMagick</a></li>
				
					<li><a href="../MiniMagick/CommandBuilder.html">MiniMagick::CommandBuilder</a></li>
				
					<li><a href="../MiniMagick/Error.html">MiniMagick::Error</a></li>
				
					<li><a href="../MiniMagick/Image.html">MiniMagick::Image</a></li>
				
					<li><a href="../MiniMagick/Invalid.html">MiniMagick::Invalid</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">MiniMagick::Image</h1>

		<div id="description">
			
		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="path-attribute-method" class="method-detail">
				<a name="path"></a>
				
				<a name="path="></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">path</span><span
						class="attribute-access-type">[RW]</span>
				</div>

				<div class="method-description">
				
				<p>
@return [String] The location of the current working file
</p>
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="create-method" class="method-detail ">
				<a name="method-c-create"></a>

				<div class="method-heading">
				
					<span class="method-name">create</span><span
						class="method-args">(ext = nil, validate = true, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Used to create a new <a href="Image.html">Image</a> object data-copy. Not
used to &#8220;paint&#8221; or that kind of thing.
</p>
<p>
Takes an extension in a block and can be used to build a new <a
href="Image.html">Image</a> object. Used by both # and # to create a new
object! Ensures we have a good tempfile!
</p>
<p>
@param ext [String] Specify the extension you want to read it as @param
validate [Boolean] If false, skips validation of the created image.
Defaults to true. @yield [IOStream] You can <a
href="Image.html#method-i-write">#</a> bits to this object to create the
new <a href="Image.html">Image</a> @return [Image] The created image
</p>
					

					
					<div class="method-source-code"
						id="create-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 134</span>
134:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">create</span>(<span class="ruby-identifier">ext</span> = <span class="ruby-keyword kw">nil</span>, <span class="ruby-identifier">validate</span> = <span class="ruby-keyword kw">true</span>, &amp;<span class="ruby-identifier">block</span>)
135:         <span class="ruby-keyword kw">begin</span>
136:           <span class="ruby-identifier">tempfile</span> = <span class="ruby-constant">Tempfile</span>.<span class="ruby-identifier">new</span>([<span class="ruby-value str">'mini_magick'</span>, <span class="ruby-identifier">ext</span>.<span class="ruby-identifier">to_s</span>])
137:           <span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">binmode</span>
138:           <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">tempfile</span>)
139:           <span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">close</span>
140: 
141:           <span class="ruby-identifier">image</span> = <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">path</span>, <span class="ruby-identifier">tempfile</span>)
142: 
143:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">validate</span> <span class="ruby-keyword kw">and</span> <span class="ruby-operator">!</span><span class="ruby-identifier">image</span>.<span class="ruby-identifier">valid?</span>
144:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">MiniMagick</span><span class="ruby-operator">::</span><span class="ruby-constant">Invalid</span>
145:           <span class="ruby-keyword kw">end</span>
146:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">image</span>
147:         <span class="ruby-keyword kw">ensure</span>
148:           <span class="ruby-identifier">tempfile</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">tempfile</span>
149:         <span class="ruby-keyword kw">end</span>
150:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="from-blob-method" class="method-detail ">
				<a name="method-c-from_blob"></a>

				<div class="method-heading">
				
					<span class="method-name">from_blob</span><span
						class="method-args">(blob, ext = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
@deprecated Please use Image.read instead!
</p>
					

					
					<div class="method-source-code"
						id="from-blob-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 61</span>
61:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_blob</span>(<span class="ruby-identifier">blob</span>, <span class="ruby-identifier">ext</span> = <span class="ruby-keyword kw">nil</span>)
62:         <span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;Warning: MiniMagick::Image.from_blob method is deprecated. Instead, please use Image.read&quot;</span>
63:         <span class="ruby-identifier">create</span>(<span class="ruby-identifier">ext</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">blob</span>) }
64:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="from-file-method" class="method-detail ">
				<a name="method-c-from_file"></a>

				<div class="method-heading">
				
					<span class="method-name">from_file</span><span
						class="method-args">(file, ext = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
@deprecated Please use MiniMagick::Image.open(file_or_url) now
</p>
					

					
					<div class="method-source-code"
						id="from-file-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 120</span>
120:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">from_file</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">ext</span> = <span class="ruby-keyword kw">nil</span>)
121:         <span class="ruby-identifier">warn</span> <span class="ruby-value str">&quot;Warning: MiniMagick::Image.from_file is now deprecated. Please use Image.open&quot;</span>
122:         <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file</span>, <span class="ruby-identifier">ext</span>)
123:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="import-pixels-method" class="method-detail ">
				<a name="method-c-import_pixels"></a>

				<div class="method-heading">
				
					<span class="method-name">import_pixels</span><span
						class="method-args">(blob, columns, rows, depth, map, format="png")</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Creates an image object from a binary string blob which contains raw pixel
data (i.e. no header data).
</p>
<h3>Returns</h3>
<ul>
<li><dl>
<dt><a href="Image.html">Image</a></dt><dd><p>
The loaded image.
</p>
</dd>
</dl>
</li>
</ul>
<h3>Parameters</h3>
<ul>
<li><dl>
<dt>blob</dt><dd><p>
<tt>String</tt> &#8212; Binary string blob containing raw pixel data.
</p>
</dd>
</dl>
</li>
<li><dl>
<dt>columns</dt><dd><p>
<tt>Integer</tt> &#8212; Number of columns.
</p>
</dd>
</dl>
</li>
<li><dl>
<dt>rows</dt><dd><p>
<tt>Integer</tt> &#8212; Number of rows.
</p>
</dd>
</dl>
</li>
<li><dl>
<dt>depth</dt><dd><p>
<tt>Integer</tt> &#8212; Bit depth of the encoded pixel data.
</p>
</dd>
</dl>
</li>
<li><dl>
<dt>map</dt><dd><p>
<tt>String</tt> &#8212; A code for the mapping of the pixel data. Example:
&#8216;gray&#8217; or &#8216;rgb&#8217;.
</p>
</dd>
</dl>
</li>
<li><dl>
<dt>format</dt><dd><p>
<tt>String</tt> &#8212; The file extension of the image format to be used
when creating the image object. Defaults to &#8216;png&#8217;.
</p>
</dd>
</dl>
</li>
</ul>
					

					
					<div class="method-source-code"
						id="import-pixels-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 81</span>
81:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">import_pixels</span>(<span class="ruby-identifier">blob</span>, <span class="ruby-identifier">columns</span>, <span class="ruby-identifier">rows</span>, <span class="ruby-identifier">depth</span>, <span class="ruby-identifier">map</span>, <span class="ruby-identifier">format</span>=<span class="ruby-value str">&quot;png&quot;</span>)
82:         <span class="ruby-comment cmt"># Create an image object with the raw pixel data string:</span>
83:         <span class="ruby-identifier">image</span> = <span class="ruby-identifier">create</span>(<span class="ruby-value str">&quot;.dat&quot;</span>, <span class="ruby-identifier">validate</span> = <span class="ruby-keyword kw">false</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span> <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">blob</span>) }
84:         <span class="ruby-comment cmt"># Use ImageMagick to convert the raw data file to an image file of the desired format:</span>
85:         <span class="ruby-identifier">converted_image_path</span> = <span class="ruby-identifier">image</span>.<span class="ruby-identifier">path</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">4</span>] <span class="ruby-operator">+</span> <span class="ruby-identifier">format</span>
86:         <span class="ruby-identifier">argument</span> = <span class="ruby-node">&quot;-size #{columns}x#{rows} -depth #{depth} #{map}:#{image.path} #{converted_image_path}&quot;</span>
87:         <span class="ruby-identifier">cmd</span> = <span class="ruby-constant">CommandBuilder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;convert&quot;</span>, <span class="ruby-identifier">argument</span>) <span class="ruby-comment cmt">#Example: convert -size 256x256 -depth 16 gray:blob.dat blob.png</span>
88:         <span class="ruby-identifier">image</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">cmd</span>)
89:         <span class="ruby-comment cmt"># Update the image instance with the path of the properly formatted image, and return:</span>
90:         <span class="ruby-identifier">image</span>.<span class="ruby-identifier">path</span> = <span class="ruby-identifier">converted_image_path</span>
91:         <span class="ruby-identifier">image</span>
92:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(input_path, tempfile = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Create a new <a href="Image.html">MiniMagick::Image</a> object
</p>
<p>
<em>DANGER</em>: The file location passed in here is the *working copy*.
That is, it gets <b>modified</b>. you can either copy it yourself or use
the MiniMagick::Image.open(path) method which creates a temporary file for
you and protects your original!
</p>
<p>
@param input_path [String] The location of an image file @todo Allow this
to accept a block that can pass off to <a
href="Image.html#method-i-combine_options">Image#combine_options</a>
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 161</span>
161:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">input_path</span>, <span class="ruby-identifier">tempfile</span> = <span class="ruby-keyword kw">nil</span>)
162:       <span class="ruby-ivar">@path</span> = <span class="ruby-identifier">input_path</span>
163:       <span class="ruby-ivar">@tempfile</span> = <span class="ruby-identifier">tempfile</span> <span class="ruby-comment cmt"># ensures that the tempfile will stick around until this image is garbage collected.</span>
164:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-method" class="method-detail ">
				<a name="method-c-open"></a>

				<div class="method-heading">
				
					<span class="method-name">open</span><span
						class="method-args">(file_or_url, ext = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Opens a specific image file either on the local file system or at a URI.
</p>
<p>
Use this if you don&#8217;t want to overwrite the image file.
</p>
<p>
Extension is either guessed from the path or you can specify it as a second
parameter.
</p>
<p>
If you pass in what looks like a URL, we require &#8216;open-uri&#8217;
before opening it.
</p>
<p>
@param file_or_url [String] Either a local file path or a URL that open-uri
can read @param ext [String] Specify the extension you want to read it as
@return [Image] The loaded image
</p>
					

					
					<div class="method-source-code"
						id="open-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 105</span>
105:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_or_url</span>, <span class="ruby-identifier">ext</span> = <span class="ruby-keyword kw">nil</span>)
106:         <span class="ruby-identifier">file_or_url</span> = <span class="ruby-identifier">file_or_url</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-comment cmt"># Force it to be a String... hell or highwater</span>
107:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">file_or_url</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;://&quot;</span>)
108:           <span class="ruby-identifier">require</span> <span class="ruby-value str">'open-uri'</span>
109:           <span class="ruby-identifier">ext</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-constant">URI</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">file_or_url</span>).<span class="ruby-identifier">path</span>)
110:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read</span>(<span class="ruby-constant">Kernel</span><span class="ruby-operator">::</span><span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_or_url</span>), <span class="ruby-identifier">ext</span>)
111:         <span class="ruby-keyword kw">else</span>
112:           <span class="ruby-identifier">ext</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">extname</span>(<span class="ruby-identifier">file_or_url</span>)
113:           <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">file_or_url</span>, <span class="ruby-value str">&quot;rb&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
114:             <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">f</span>, <span class="ruby-identifier">ext</span>)
115:           <span class="ruby-keyword kw">end</span>
116:         <span class="ruby-keyword kw">end</span>
117:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="read-method" class="method-detail ">
				<a name="method-c-read"></a>

				<div class="method-heading">
				
					<span class="method-name">read</span><span
						class="method-args">(stream, ext = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This is the primary loading method used by all of the other class methods.
</p>
<p>
Use this to pass in a stream object. Must respond to Object#read(size) or
be a binary string object (BLOBBBB)
</p>
<p>
As a change from the old API, please try and use IOStream objects. They are
much, much better and more efficient!
</p>
<p>
Probably easier to use the # method if you want to open a file or a URL.
</p>
<p>
@param stream [IOStream, String] Some kind of stream object that needs to
be read or is a binary String blob! @param ext [String] A manual extension
to use for reading the file. Not required, but if you are having issues,
give this a try. @return [Image]
</p>
					

					
					<div class="method-source-code"
						id="read-source">
<pre>
    <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 48</span>
48:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>(<span class="ruby-identifier">stream</span>, <span class="ruby-identifier">ext</span> = <span class="ruby-keyword kw">nil</span>)
49:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">is_a?</span>(<span class="ruby-constant">String</span>)
50:           <span class="ruby-identifier">stream</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">stream</span>)
51:         <span class="ruby-keyword kw">end</span>
52: 
53:         <span class="ruby-identifier">create</span>(<span class="ruby-identifier">ext</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
54:           <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">chunk</span> = <span class="ruby-identifier">stream</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">8192</span>)
55:             <span class="ruby-identifier">f</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">chunk</span>)
56:           <span class="ruby-keyword kw">end</span>
57:         <span class="ruby-keyword kw">end</span>
58:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="--method" class="method-detail ">
				<a name="method-i-%3C%3C"></a>

				<div class="method-heading">
				
					<span class="method-name">&lt;&lt;</span><span
						class="method-args">(*args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sends raw commands to imagemagick&#8217;s `mogrify` command. The image path
is automatically appended to the command.
</p>
<p>
Remember, we are always acting on this instance of the <a
href="Image.html">Image</a> when messing with this.
</p>
<p>
@return [String] Whatever the result from the command line is. May not be
terribly useful.
</p>
					

					
					<div class="method-source-code"
						id="--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 235</span>
235:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>(*<span class="ruby-identifier">args</span>)
236:       <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;mogrify&quot;</span>, *<span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">escaped_path</span>)
237:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="--method" class="method-detail ">
				<a name="method-i-%5B%5D"></a>

				<div class="method-heading">
				
					<span class="method-name">[]</span><span
						class="method-args">(value)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
A rather low-level way to interact with the &#8220;identify&#8221; command.
No nice API here, just the crazy stuff you find in ImageMagick. See the
examples listed!
</p>
<p>
@example
</p>
<pre>
   image[&quot;format&quot;]      #=&gt; &quot;TIFF&quot;
   image[&quot;height&quot;]      #=&gt; 41 (pixels)
   image[&quot;width&quot;]       #=&gt; 50 (pixels)
   image[&quot;colorspace&quot;]  #=&gt; &quot;DirectClassRGB&quot;
   image[&quot;dimensions&quot;]  #=&gt; [50, 41]
   image[&quot;size&quot;]        #=&gt; 2050 (bits)
   image[&quot;original_at&quot;] #=&gt; 2005-02-23 23:17:24 +0000 (Read from Exif data)
   image[&quot;EXIF:ExifVersion&quot;] #=&gt; &quot;0220&quot; (Can read anything from Exif)
</pre>
<p>
@param format [String] A format for the &#8220;identify&#8221; command @see
For reference see <a
href="http://www.imagemagick.org/script/command-line-options.php#format">www.imagemagick.org/script/command-line-options.php#format</a>
@return [String, Numeric, Array, Time, Object] Depends on the method
called! Defaults to String for unknown commands
</p>
					

					
					<div class="method-source-code"
						id="--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 200</span>
200:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">[]</span>(<span class="ruby-identifier">value</span>)
201:       <span class="ruby-comment cmt"># Why do I go to the trouble of putting in newlines? Because otherwise animated gifs screw everything up</span>
202:       <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">value</span>.<span class="ruby-identifier">to_s</span>
203:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;colorspace&quot;</span>
204:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-value str">&quot;-format&quot;</span>, <span class="ruby-identifier">format_option</span>(<span class="ruby-value str">&quot;%r&quot;</span>), <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>]
205:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;format&quot;</span>
206:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-value str">&quot;-format&quot;</span>, <span class="ruby-identifier">format_option</span>(<span class="ruby-value str">&quot;%m&quot;</span>), <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>]
207:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;height&quot;</span>
208:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-value str">&quot;-format&quot;</span>, <span class="ruby-identifier">format_option</span>(<span class="ruby-value str">&quot;%h&quot;</span>), <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
209:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;width&quot;</span>
210:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-value str">&quot;-format&quot;</span>, <span class="ruby-identifier">format_option</span>(<span class="ruby-value str">&quot;%w&quot;</span>), <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">to_i</span>
211:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;dimensions&quot;</span>
212:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-value str">&quot;-format&quot;</span>, <span class="ruby-identifier">format_option</span>(<span class="ruby-value str">&quot;%w %h&quot;</span>), <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>].<span class="ruby-identifier">split</span>.<span class="ruby-identifier">map</span>{<span class="ruby-operator">|</span><span class="ruby-identifier">v</span><span class="ruby-operator">|</span><span class="ruby-identifier">v</span>.<span class="ruby-identifier">to_i</span>}
213:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;size&quot;</span>
214:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">size</span>(<span class="ruby-ivar">@path</span>) <span class="ruby-comment cmt"># Do this because calling identify -format &quot;%b&quot; on an animated gif fails!</span>
215:       <span class="ruby-keyword kw">when</span> <span class="ruby-value str">&quot;original_at&quot;</span>
216:         <span class="ruby-comment cmt"># Get the EXIF original capture as a Time object</span>
217:         <span class="ruby-constant">Time</span>.<span class="ruby-identifier">local</span>(*<span class="ruby-keyword kw">self</span>[<span class="ruby-value str">&quot;EXIF:DateTimeOriginal&quot;</span>].<span class="ruby-identifier">split</span>(<span class="ruby-regexp re">/:|\s+/</span>)) <span class="ruby-keyword kw">rescue</span> <span class="ruby-keyword kw">nil</span>
218:       <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/^EXIF\:/</span>
219:         <span class="ruby-identifier">result</span> = <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">'identify'</span>, <span class="ruby-value str">'-format'</span>, <span class="ruby-node">&quot;\&quot;%[#{value}]\&quot;&quot;</span>, <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">chop</span>
220:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">result</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-value str">&quot;,&quot;</span>)
221:           <span class="ruby-identifier">read_character_data</span>(<span class="ruby-identifier">result</span>)
222:         <span class="ruby-keyword kw">else</span>
223:           <span class="ruby-identifier">result</span>
224:         <span class="ruby-keyword kw">end</span>
225:       <span class="ruby-keyword kw">else</span>
226:         <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">'identify'</span>, <span class="ruby-value str">'-format'</span>, <span class="ruby-node">&quot;\&quot;#{value}\&quot;&quot;</span>, <span class="ruby-identifier">escaped_path</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;\n&quot;</span>)[<span class="ruby-value">0</span>]
227:       <span class="ruby-keyword kw">end</span>
228:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="collapse--method" class="method-detail ">
				<a name="method-i-collapse%21"></a>

				<div class="method-heading">
				
					<span class="method-name">collapse!</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Collapse images with sequences to the first frame (ie. animated gifs) and
preserve quality
</p>
					

					
					<div class="method-source-code"
						id="collapse--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 278</span>
278:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">collapse!</span>
279:       <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;mogrify&quot;</span>, <span class="ruby-value str">&quot;-quality&quot;</span>, <span class="ruby-value str">&quot;100&quot;</span>, <span class="ruby-node">&quot;#{path}[0]&quot;</span>)
280:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="combine-options-method" class="method-detail ">
				<a name="method-i-combine_options"></a>

				<div class="method-heading">
				
					<span class="method-name">combine_options</span><span
						class="method-args">(&block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
You can use multiple commands together using this method. Very easy to use!
</p>
<p>
@example
</p>
<pre>
  image.combine_options do |c|
    c.draw &quot;image Over 0,0 10,10 '#{MINUS_IMAGE_PATH}'&quot;
    c.thumbnail &quot;300x500&gt;&quot;
    c.background background
  end
</pre>
<p>
@yieldparam command [CommandBuilder]
</p>
					

					
					<div class="method-source-code"
						id="combine-options-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 333</span>
333:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">combine_options</span>(&amp;<span class="ruby-identifier">block</span>)
334:       <span class="ruby-identifier">c</span> = <span class="ruby-constant">CommandBuilder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'mogrify'</span>)
335:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">c</span>)
336:       <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@path</span>
337:       <span class="ruby-identifier">run</span>(<span class="ruby-identifier">c</span>)
338:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="composite-method" class="method-detail ">
				<a name="method-i-composite"></a>

				<div class="method-heading">
				
					<span class="method-name">composite</span><span
						class="method-args">(other_image, output_extension = 'jpg', &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="composite-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 345</span>
345:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">composite</span>(<span class="ruby-identifier">other_image</span>, <span class="ruby-identifier">output_extension</span> = <span class="ruby-value str">'jpg'</span>, &amp;<span class="ruby-identifier">block</span>)
346:       <span class="ruby-keyword kw">begin</span>
347:         <span class="ruby-identifier">second_tempfile</span> = <span class="ruby-constant">Tempfile</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">output_extension</span>)
348:         <span class="ruby-identifier">second_tempfile</span>.<span class="ruby-identifier">binmode</span>
349:       <span class="ruby-keyword kw">ensure</span>
350:         <span class="ruby-identifier">second_tempfile</span>.<span class="ruby-identifier">close</span>
351:       <span class="ruby-keyword kw">end</span>
352: 
353:       <span class="ruby-identifier">command</span> = <span class="ruby-constant">CommandBuilder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;composite&quot;</span>)
354:       <span class="ruby-identifier">block</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">command</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>
355:       <span class="ruby-identifier">command</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">other_image</span>.<span class="ruby-identifier">path</span>)
356:       <span class="ruby-identifier">command</span>.<span class="ruby-identifier">push</span>(<span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">path</span>)
357:       <span class="ruby-identifier">command</span>.<span class="ruby-identifier">push</span>(<span class="ruby-identifier">second_tempfile</span>.<span class="ruby-identifier">path</span>)
358: 
359:       <span class="ruby-identifier">run</span>(<span class="ruby-identifier">command</span>)
360:       <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Image</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">second_tempfile</span>.<span class="ruby-identifier">path</span>, <span class="ruby-identifier">second_tempfile</span>)
361:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="destroy--method" class="method-detail ">
				<a name="method-i-destroy%21"></a>

				<div class="method-heading">
				
					<span class="method-name">destroy!</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="destroy--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 399</span>
399:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">destroy!</span>
400:       <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@tempfile</span>.<span class="ruby-identifier">nil?</span>
401:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-ivar">@tempfile</span>.<span class="ruby-identifier">path</span>)
402:       <span class="ruby-ivar">@tempfile</span> = <span class="ruby-keyword kw">nil</span>
403:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="escaped-path-method" class="method-detail ">
				<a name="method-i-escaped_path"></a>

				<div class="method-heading">
				
					<span class="method-name">escaped_path</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="escaped-path-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 166</span>
166:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">escaped_path</span>
167:       <span class="ruby-node">&quot;\&quot;#{Pathname.new(@path).to_s}\&quot;&quot;</span>
168:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="format-method" class="method-detail ">
				<a name="method-i-format"></a>

				<div class="method-heading">
				
					<span class="method-name">format</span><span
						class="method-args">(format, page = 0)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This is used to change the format of the image. That is, from &#8220;tiff
to jpg&#8221; or something like that. Once you run it, the instance is
pointing to a new file with a new extension!
</p>
<p>
<b>DANGER</b>: This renames the file that the instance is pointing to. So,
if you manually opened the file with Image.new(file_path)&#8230; then that
file is DELETED! If you used Image.open(file) then you are ok. The original
file will still be there. But, any changes to it might not be...
</p>
<p>
Formatting an animation into a non-animated type will result in ImageMagick
creating multiple pages (starting with 0).  You can choose which page you
want to manipulate.  We default to the first page.
</p>
<p>
@param format [String] The target format... like &#8216;jpg&#8217;,
&#8216;gif&#8217;, &#8216;tiff&#8217;, etc. @param page [Integer] If this
is an animated gif, say which &#8216;page&#8217; you want with an integer.
Leave as default if you don&#8217;t care. @return [nil]
</p>
					

					
					<div class="method-source-code"
						id="format-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 253</span>
253:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format</span>(<span class="ruby-identifier">format</span>, <span class="ruby-identifier">page</span> = <span class="ruby-value">0</span>)
254:       <span class="ruby-identifier">c</span> = <span class="ruby-constant">CommandBuilder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-value str">'mogrify'</span>, <span class="ruby-value str">'-format'</span>, <span class="ruby-identifier">format</span>)
255:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">c</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
256:       <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@path</span>
257:       <span class="ruby-identifier">run</span>(<span class="ruby-identifier">c</span>)
258: 
259:       <span class="ruby-identifier">old_path</span> = <span class="ruby-ivar">@path</span>.<span class="ruby-identifier">dup</span>
260:       <span class="ruby-ivar">@path</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-regexp re">/(\.\w*)?$/</span>, <span class="ruby-node">&quot;.#{format}&quot;</span>)
261:       <span class="ruby-constant">File</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">old_path</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">old_path</span> <span class="ruby-operator">!=</span> <span class="ruby-ivar">@path</span>
262: 
263:       <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exists?</span>(<span class="ruby-ivar">@path</span>)
264:         <span class="ruby-keyword kw">begin</span>
265:           <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">copy_file</span>(<span class="ruby-ivar">@path</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-node">&quot;.#{format}&quot;</span>, <span class="ruby-node">&quot;-#{page}.#{format}&quot;</span>), <span class="ruby-ivar">@path</span>)
266:         <span class="ruby-keyword kw">rescue</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">ex</span>
267:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">MiniMagick</span><span class="ruby-operator">::</span><span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Unable to format to #{format}; #{ex}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-constant">File</span>.<span class="ruby-identifier">exist?</span>(<span class="ruby-ivar">@path</span>)
268:         <span class="ruby-keyword kw">end</span>
269:       <span class="ruby-keyword kw">end</span>
270:     <span class="ruby-keyword kw">ensure</span>
271:       <span class="ruby-constant">Dir</span>[<span class="ruby-ivar">@path</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/(\.\w+)?$/</span>, <span class="ruby-node">&quot;-[0-9]*.#{format}&quot;</span>)].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">fname</span><span class="ruby-operator">|</span>
272:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">unlink</span>(<span class="ruby-identifier">fname</span>)
273:       <span class="ruby-keyword kw">end</span>
274:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="format-option-method" class="method-detail ">
				<a name="method-i-format_option"></a>

				<div class="method-heading">
				
					<span class="method-name">format_option</span><span
						class="method-args">(format)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Outputs a carriage-return delimited format string for Unix and Windows
</p>
					

					
					<div class="method-source-code"
						id="format-option-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 364</span>
364:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">format_option</span>(<span class="ruby-identifier">format</span>)
365:       <span class="ruby-identifier">windows?</span> <span class="ruby-operator">?</span> <span class="ruby-node">&quot;\&quot;#{format}\\n\&quot;&quot;</span> <span class="ruby-operator">:</span> <span class="ruby-node">&quot;\&quot;#{format}\\\\n\&quot;&quot;</span>
366:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="method-missing-method" class="method-detail ">
				<a name="method-i-method_missing"></a>

				<div class="method-heading">
				
					<span class="method-name">method_missing</span><span
						class="method-args">(symbol, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
If an unknown method is called then it is sent through the morgrify program
Look here to find all the commands (<a
href="http://www.imagemagick.org/script/mogrify.php">www.imagemagick.org/script/mogrify.php</a>)
</p>
					

					
					<div class="method-source-code"
						id="method-missing-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 317</span>
317:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">symbol</span>, *<span class="ruby-identifier">args</span>)
318:       <span class="ruby-identifier">combine_options</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span>
319:         <span class="ruby-identifier">c</span>.<span class="ruby-identifier">method_missing</span>(<span class="ruby-identifier">symbol</span>, *<span class="ruby-identifier">args</span>)
320:       <span class="ruby-keyword kw">end</span>
321:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-method" class="method-detail ">
				<a name="method-i-run"></a>

				<div class="method-heading">
				
					<span class="method-name">run</span><span
						class="method-args">(command_builder)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="run-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 377</span>
377:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run</span>(<span class="ruby-identifier">command_builder</span>)
378:       <span class="ruby-identifier">command</span> = <span class="ruby-identifier">command_builder</span>.<span class="ruby-identifier">command</span>
379: 
380:       <span class="ruby-identifier">sub</span> = <span class="ruby-constant">Subexec</span>.<span class="ruby-identifier">run</span>(<span class="ruby-identifier">command</span>, <span class="ruby-value">:timeout</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">MiniMagick</span>.<span class="ruby-identifier">timeout</span>)
381: 
382:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">exitstatus</span> <span class="ruby-operator">!=</span> <span class="ruby-value">0</span>
383:         <span class="ruby-comment cmt"># Clean up after ourselves in case of an error</span>
384:         <span class="ruby-identifier">destroy!</span>
385: 
386:         <span class="ruby-comment cmt"># Raise the appropriate error</span>
387:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">output</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/no decode delegate/</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">output</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/did not return an image/</span>
388:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Invalid</span>, <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">output</span>
389:         <span class="ruby-keyword kw">else</span>
390:           <span class="ruby-comment cmt"># TODO: should we do something different if the command times out ...?</span>
391:           <span class="ruby-comment cmt"># its definitely better for logging.. otherwise we dont really know</span>
392:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">Error</span>, <span class="ruby-node">&quot;Command (#{command.inspect.gsub(&quot;\\&quot;, &quot;&quot;)}) failed: #{{:status_code =&gt; sub.exitstatus, :output =&gt; sub.output}.inspect}&quot;</span>
393:         <span class="ruby-keyword kw">end</span>
394:       <span class="ruby-keyword kw">else</span>
395:         <span class="ruby-identifier">sub</span>.<span class="ruby-identifier">output</span>
396:       <span class="ruby-keyword kw">end</span>
397:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="run-command-method" class="method-detail ">
				<a name="method-i-run_command"></a>

				<div class="method-heading">
				
					<span class="method-name">run_command</span><span
						class="method-args">(command, *args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="run-command-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 368</span>
368:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">run_command</span>(<span class="ruby-identifier">command</span>, *<span class="ruby-identifier">args</span>)
369:       <span class="ruby-comment cmt"># -ping &quot;efficiently determine image characteristics.&quot;</span>
370:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">command</span> <span class="ruby-operator">==</span> <span class="ruby-value str">'identify'</span>
371:         <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span> <span class="ruby-value str">'-ping'</span>
372:       <span class="ruby-keyword kw">end</span>
373: 
374:       <span class="ruby-identifier">run</span>(<span class="ruby-constant">CommandBuilder</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">command</span>, *<span class="ruby-identifier">args</span>))
375:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="to-blob-method" class="method-detail ">
				<a name="method-i-to_blob"></a>

				<div class="method-heading">
				
					<span class="method-name">to_blob</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Gives you raw image data back @return [String] binary string
</p>
					

					
					<div class="method-source-code"
						id="to-blob-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 307</span>
307:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">to_blob</span>
308:       <span class="ruby-identifier">f</span> = <span class="ruby-constant">File</span>.<span class="ruby-identifier">new</span> <span class="ruby-ivar">@path</span>
309:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">binmode</span>
310:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>
311:     <span class="ruby-keyword kw">ensure</span>
312:       <span class="ruby-identifier">f</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">f</span>
313:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="valid--method" class="method-detail ">
				<a name="method-i-valid%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">valid?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Checks to make sure that <a href="../MiniMagick.html">MiniMagick</a> can
read the file and understand it.
</p>
<p>
This uses the &#8216;identify&#8217; command line utility to check the
file. If you are having issues with this, then please work directly with
the &#8216;identify&#8217; command and see if you can figure out what the
issue is.
</p>
<p>
@return [Boolean]
</p>
					

					
					<div class="method-source-code"
						id="valid--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 177</span>
177:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">valid?</span>
178:       <span class="ruby-identifier">run_command</span>(<span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-ivar">@path</span>)
179:       <span class="ruby-keyword kw">true</span>
180:     <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">MiniMagick</span><span class="ruby-operator">::</span><span class="ruby-constant">Invalid</span>
181:       <span class="ruby-keyword kw">false</span>
182:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="windows--method" class="method-detail ">
				<a name="method-i-windows%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">windows?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Check to see if we are running on win32 &#8212; we need to escape things
differently
</p>
					

					
					<div class="method-source-code"
						id="windows--source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 341</span>
341:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">windows?</span>
342:       <span class="ruby-operator">!</span>(<span class="ruby-constant">RUBY_PLATFORM</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/win32|mswin|mingw/</span>).<span class="ruby-identifier">nil?</span>
343:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="write-method" class="method-detail ">
				<a name="method-i-write"></a>

				<div class="method-heading">
				
					<span class="method-name">write</span><span
						class="method-args">(output_to)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Writes the temporary file out to either a file location (by passing in a
String) or by passing in a Stream that you can # to repeatedly
</p>
<p>
@param output_to [IOStream, String] Some kind of stream object that needs
to be read or a file path as a String @return [IOStream, Boolean] If you
pass in a file location [String] then you get a success boolean. If its a
stream, you get it back. Writes the temporary image that we are using for
processing to the output path
</p>
					

					
					<div class="method-source-code"
						id="write-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 288</span>
288:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">write</span>(<span class="ruby-identifier">output_to</span>)
289:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">output_to</span>.<span class="ruby-identifier">kind_of?</span>(<span class="ruby-constant">String</span>) <span class="ruby-operator">||</span> <span class="ruby-operator">!</span><span class="ruby-identifier">output_to</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:write</span>)
290:         <span class="ruby-constant">FileUtils</span>.<span class="ruby-identifier">copy_file</span> <span class="ruby-ivar">@path</span>, <span class="ruby-identifier">output_to</span>
291:         <span class="ruby-comment cmt"># We need to escape the output path if it contains a space</span>
292:         <span class="ruby-identifier">escaped_output_to</span> = <span class="ruby-identifier">output_to</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">' '</span>, <span class="ruby-value str">'\ '</span>)
293:         <span class="ruby-identifier">run_command</span> <span class="ruby-value str">&quot;identify&quot;</span>, <span class="ruby-identifier">escaped_output_to</span> <span class="ruby-comment cmt"># Verify that we have a good image</span>
294:       <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># stream</span>
295:         <span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(<span class="ruby-ivar">@path</span>, <span class="ruby-value str">&quot;rb&quot;</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">f</span><span class="ruby-operator">|</span>
296:           <span class="ruby-identifier">f</span>.<span class="ruby-identifier">binmode</span>
297:           <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">chunk</span> = <span class="ruby-identifier">f</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">8192</span>)
298:             <span class="ruby-identifier">output_to</span>.<span class="ruby-identifier">write</span>(<span class="ruby-identifier">chunk</span>)
299:           <span class="ruby-keyword kw">end</span>
300:         <span class="ruby-keyword kw">end</span>
301:         <span class="ruby-identifier">output_to</span>
302:       <span class="ruby-keyword kw">end</span>
303:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="read-character-data-method" class="method-detail ">
				<a name="method-i-read_character_data"></a>

				<div class="method-heading">
				
					<span class="method-name">read_character_data</span><span
						class="method-args">(list_of_characters)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Sometimes we get back a list of character values
</p>
					

					
					<div class="method-source-code"
						id="read-character-data-source">
<pre>
     <span class="ruby-comment cmt"># File lib/mini_magick.rb, line 407</span>
407:       <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read_character_data</span>(<span class="ruby-identifier">list_of_characters</span>)
408:         <span class="ruby-identifier">chars</span> = <span class="ruby-identifier">list_of_characters</span>.<span class="ruby-identifier">gsub</span>(<span class="ruby-value str">&quot; &quot;</span>, <span class="ruby-value str">&quot;&quot;</span>).<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;,&quot;</span>)
409:         <span class="ruby-identifier">result</span> = <span class="ruby-value str">&quot;&quot;</span>
410:         <span class="ruby-identifier">chars</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">val</span><span class="ruby-operator">|</span>
411:           <span class="ruby-identifier">result</span> <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-value str">&quot;%c&quot;</span> <span class="ruby-operator">%</span> <span class="ruby-identifier">val</span>.<span class="ruby-identifier">to_i</span>)
412:         <span class="ruby-keyword kw">end</span>
413:         <span class="ruby-identifier">result</span>
414:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

