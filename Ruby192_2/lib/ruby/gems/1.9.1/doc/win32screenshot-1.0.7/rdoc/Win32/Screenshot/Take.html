<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: Win32::Screenshot::Take</title>

	<link rel="stylesheet" href="../../rdoc.css" type="text/css" media="screen" />

	<script src="../../js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="../../js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="../../index.html">Home</a>
          <a href="../../index.html#classes">Classes</a>
          <a href="../../index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="../../lib/win32/screenshot/take_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/win32/screenshot/take.rb">lib/win32/screenshot/take.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-desktop">::desktop</a></li>
					
					<li><a href="#method-c-foreground">::foreground</a></li>
					
					<li><a href="#method-c-of">::of</a></li>
					
					<li><a href="#method-c-take_screenshot">::take_screenshot</a></li>
					
					<li><a href="#method-c-validate_coordinates">::validate_coordinates</a></li>
					
					<li><a href="#method-c-window">::window</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
		</div>

		<div id="project-metadata">
			
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="../../images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="../../Win32.html">Win32</a></li>
				
					<li><a href="../../Win32/Screenshot.html">Win32::Screenshot</a></li>
				
					<li><a href="../../Win32/Screenshot/BitmapMaker.html">Win32::Screenshot::BitmapMaker</a></li>
				
					<li><a href="../../Win32/Screenshot/Image.html">Win32::Screenshot::Image</a></li>
				
					<li><a href="../../Win32/Screenshot/Take.html">Win32::Screenshot::Take</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">Win32::Screenshot::Take</h1>

		<div id="description">
			<p>
Capture Screenshots on Windows with Ruby
</p>

		</div>

		<!-- Constants -->
		

		<!-- Attributes -->
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="of-method" class="method-detail ">
				<a name="method-c-of"></a>

				<div class="method-heading">
				
					<span class="method-name">of</span><span
						class="method-args">(what, opts = {})</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Takes a screenshot of the specified object or it&#8217;s area.
</p>
<p>
@example <a href="Take.html">Take</a> a screenshot of the window with the
specified title
</p>
<pre>
  Win32::Screenshot::Take.of(:window, :title =&gt; &quot;Windows Internet Explorer&quot;)

</pre>
<p>
@example <a href="Take.html">Take</a> a screenshot of the foreground
</p>
<pre>
  Win32::Screenshot::Take.of(:foreground)

</pre>
<p>
@example <a href="Take.html">Take</a> a screenshot of the specified
window&#8217;s top-left corner&#8217;s area
</p>
<pre>
  Win32::Screenshot::Take.of(:window, :title =&gt; /internet/i, :area =&gt; [10, 10, 20, 20])

</pre>
<p>
@example <a href="Take.html">Take</a> a screenshot of the window with the
specified handle
</p>
<pre>
  Win32::Screenshot::Take.of(:window, :hwnd =&gt; 123456)

</pre>
<p>
@example <a href="Take.html">Take</a> a screenshot of the window&#8217;s
client area (e.g. without title bar) with the specified handle
</p>
<pre>
  Win32::Screenshot::Take.of(:window, :hwnd =&gt; 123456, :context =&gt; :client)

</pre>
<p>
@example <a href="Take.html">Take</a> a screenshot of the child window with
the specified internal class name
</p>
<pre>
  Win32::Screenshot::Take.of(:rautomation, RAutomation::Window.new(:hwnd =&gt; 123456).child(:class =&gt; &quot;Internet Explorer_Server&quot;))

</pre>
<p>
@param [Symbol] what the type of the object to take a screenshot of,
</p>
<pre>
  possible values are _:foreground_, _:desktop_ and _:window_.
</pre>
<p>
@param [Hash] opts options are optional for specifying an <em>:area</em>
and/or <em>:context</em> to take a screenshot.
</p>
<pre>
  It is possible to specify as many options as are needed for searching for the unique window.
  By default the first window with matching identifiers will be taken screenshot of.
  It is possible to use in addition to other options a 0-based _:index_ option to search for other windows if multiple
  windows match the specified criteria.
</pre>
<p>
@option opts [String, Symbol] :context Context to take a screenshot of. Can
be <em>:window</em> or <em>:client</em>. Defaults to <em>:window</em>
@option opts [String, Regexp] :title Title of the window @option opts
[String, Regexp] :text Visible text of the window @option opts [String,
Regexp] :class Internal class name of the window @option opts [String,
Fixnum] :hwnd Window handle in decimal format @option opts [String,
Fixnum] :pid Window process ID (PID) @option opts [String, Fixnum] :index
0-based index to specify n-th window to take a screenshot of if
</p>
<pre>
  all other criteria match
</pre>
<p>
@option opts [RAutomation::Window] :rautomation RAutomation::Window object
to take a screenshot of. Useful for
</p>
<pre>
  taking screenshots of the child windows
</pre>
<p>
@return [Image] the {Image} of the specified object
</p>
					

					
					<div class="method-source-code"
						id="of-source">
<pre>
    <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 45</span>
45:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">of</span>(<span class="ruby-identifier">what</span>, <span class="ruby-identifier">opts</span> = {})
46:           <span class="ruby-identifier">valid_whats</span> = [<span class="ruby-value">:foreground</span>, <span class="ruby-value">:desktop</span>, <span class="ruby-value">:window</span>]
47:           <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;It is not possible to take a screenshot of '#{what}', possible values are #{valid_whats.join(&quot;, &quot;)}&quot;</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">valid_whats</span>.<span class="ruby-identifier">include?</span>(<span class="ruby-identifier">what</span>)
48: 
49:           <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">what</span>, {<span class="ruby-value">:context</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:window</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">opts</span>))
50:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="private-class-method-details" class="method-section section">
			<h3 class="section-header">Private Class Methods</h3>

		
			<div id="desktop-method" class="method-detail ">
				<a name="method-c-desktop"></a>

				<div class="method-heading">
				
					<span class="method-name">desktop</span><span
						class="method-args">(opts)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="desktop-source">
<pre>
    <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 61</span>
61:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">desktop</span>(<span class="ruby-identifier">opts</span>)
62:           <span class="ruby-identifier">hwnd</span> = <span class="ruby-constant">BitmapMaker</span>.<span class="ruby-identifier">desktop_window</span>
63:           <span class="ruby-identifier">take_screenshot</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>)
64:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="foreground-method" class="method-detail ">
				<a name="method-c-foreground"></a>

				<div class="method-heading">
				
					<span class="method-name">foreground</span><span
						class="method-args">(opts)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="foreground-source">
<pre>
    <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 56</span>
56:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">foreground</span>(<span class="ruby-identifier">opts</span>)
57:           <span class="ruby-identifier">hwnd</span> = <span class="ruby-constant">BitmapMaker</span>.<span class="ruby-identifier">foreground_window</span>
58:           <span class="ruby-identifier">take_screenshot</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>)
59:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="take-screenshot-method" class="method-detail ">
				<a name="method-c-take_screenshot"></a>

				<div class="method-heading">
				
					<span class="method-name">take_screenshot</span><span
						class="method-args">(hwnd, opts)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="take-screenshot-source">
<pre>
    <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 81</span>
81:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">take_screenshot</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>)
82:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">opts</span>[<span class="ruby-value">:area</span>]
83:             <span class="ruby-identifier">validate_coordinates</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:context</span>], *<span class="ruby-identifier">opts</span>[<span class="ruby-value">:area</span>])
84:             <span class="ruby-constant">BitmapMaker</span>.<span class="ruby-identifier">capture_area</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:context</span>], *<span class="ruby-identifier">opts</span>[<span class="ruby-value">:area</span>])
85:           <span class="ruby-keyword kw">else</span>
86:             <span class="ruby-constant">BitmapMaker</span>.<span class="ruby-identifier">capture_all</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>[<span class="ruby-value">:context</span>])
87:           <span class="ruby-keyword kw">end</span>
88:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="validate-coordinates-method" class="method-detail ">
				<a name="method-c-validate_coordinates"></a>

				<div class="method-heading">
				
					<span class="method-name">validate_coordinates</span><span
						class="method-args">(hwnd, context, x1, y1, x2, y2)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="validate-coordinates-source">
<pre>
     <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 90</span>
 90:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">validate_coordinates</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">context</span>, <span class="ruby-identifier">x1</span>, <span class="ruby-identifier">y1</span>, <span class="ruby-identifier">x2</span>, <span class="ruby-identifier">y2</span>)
 91:           <span class="ruby-identifier">specified_coordinates</span> = <span class="ruby-node">&quot;x1: #{x1}, y1: #{y1}, x2: #{x2}, y2: #{y2}&quot;</span>
 92:           <span class="ruby-keyword kw">if</span> [<span class="ruby-identifier">x1</span>, <span class="ruby-identifier">y1</span>, <span class="ruby-identifier">x2</span>, <span class="ruby-identifier">y2</span>].<span class="ruby-identifier">any?</span> {<span class="ruby-operator">|</span><span class="ruby-identifier">c</span><span class="ruby-operator">|</span> <span class="ruby-identifier">c</span> <span class="ruby-operator">&lt;</span> <span class="ruby-value">0</span>}
 93:             <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;specified coordinates (#{specified_coordinates}) are invalid - cannot be negative!&quot;</span>
 94:           <span class="ruby-keyword kw">end</span>
 95: 
 96:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x1</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">x2</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">y1</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">y2</span>
 97:             <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;specified coordinates (#{specified_coordinates}) are invalid - cannot be x1 &gt;= x2 or y1 &gt;= y2!&quot;</span>
 98:           <span class="ruby-keyword kw">end</span>
 99: 
100:           <span class="ruby-identifier">max_width</span>, <span class="ruby-identifier">max_height</span> = <span class="ruby-constant">BitmapMaker</span>.<span class="ruby-identifier">dimensions_for</span>(<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">context</span>)
101:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">x2</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max_width</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">y2</span> <span class="ruby-operator">&gt;</span> <span class="ruby-identifier">max_height</span>
102:             <span class="ruby-identifier">raise</span> <span class="ruby-node">&quot;specified coordinates (#{specified_coordinates}) are invalid - maximum x2: #{max_width} and y2: #{max_height}!&quot;</span>
103:           <span class="ruby-keyword kw">end</span>
104:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="window-method" class="method-detail ">
				<a name="method-c-window"></a>

				<div class="method-heading">
				
					<span class="method-name">window</span><span
						class="method-args">(opts)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="window-source">
<pre>
    <span class="ruby-comment cmt"># File lib/win32/screenshot/take.rb, line 66</span>
66:         <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">window</span>(<span class="ruby-identifier">opts</span>)
67:           <span class="ruby-identifier">area</span> = {<span class="ruby-value">:area</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:area</span>)}
68:           <span class="ruby-identifier">context</span> = {<span class="ruby-value">:context</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:context</span>)}
69:           <span class="ruby-identifier">win</span> = <span class="ruby-identifier">opts</span>[<span class="ruby-value">:rautomation</span>] <span class="ruby-operator">||</span> <span class="ruby-constant">RAutomation</span><span class="ruby-operator">::</span><span class="ruby-constant">Window</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">opts</span>)
70:           <span class="ruby-identifier">timeout</span> = <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">+</span> <span class="ruby-value">10</span>
71:           <span class="ruby-keyword kw">until</span> <span class="ruby-identifier">win</span>.<span class="ruby-identifier">active?</span>
72:             <span class="ruby-keyword kw">if</span> <span class="ruby-constant">Time</span>.<span class="ruby-identifier">now</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-identifier">timeout</span>
73:               <span class="ruby-constant">Kernel</span>.<span class="ruby-identifier">warn</span> <span class="ruby-node">&quot;Failed to set window '#{win.locators.inspect}' into focus!&quot;</span>
74:               <span class="ruby-keyword kw">break</span>
75:             <span class="ruby-keyword kw">end</span>
76:             <span class="ruby-identifier">win</span>.<span class="ruby-identifier">activate</span>
77:           <span class="ruby-keyword kw">end</span>
78:           <span class="ruby-identifier">take_screenshot</span>(<span class="ruby-identifier">win</span>.<span class="ruby-identifier">hwnd</span>, <span class="ruby-identifier">opts</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">context</span>).<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">area</span> <span class="ruby-operator">||</span> {}))
79:         <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

