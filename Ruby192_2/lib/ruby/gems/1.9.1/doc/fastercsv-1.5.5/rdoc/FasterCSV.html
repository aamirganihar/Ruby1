<?xml version="1.0" encoding="utf-8"?>
<!DOCTYPE html PUBLIC "-//W3C//DTD XHTML 1.0 Strict//EN"
	"http://www.w3.org/TR/xhtml1/DTD/xhtml1-strict.dtd">
<html xmlns="http://www.w3.org/1999/xhtml" xml:lang="en" lang="en">
<head>
	<meta content="text/html; charset=utf-8" http-equiv="Content-Type" />

	<title>Class: FasterCSV</title>

	<link rel="stylesheet" href="./rdoc.css" type="text/css" media="screen" />

	<script src="./js/jquery.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/thickbox-compressed.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/quicksearch.js" type="text/javascript"
		charset="utf-8"></script>
	<script src="./js/darkfish.js" type="text/javascript"
		charset="utf-8"></script>

</head>
<body class="class">

	<div id="metadata">
		<div id="home-metadata">
			<div id="home-section" class="section">
        <h3 class="section-header">
          <a href="./index.html">Home</a>
          <a href="./index.html#classes">Classes</a>
          <a href="./index.html#methods">Methods</a>
        </h3>
			</div>
		</div>

		<div id="file-metadata">
			<div id="file-list-section" class="section">
				<h3 class="section-header">In Files</h3>
				<div class="section-body">
					<ul>
					
						<li><a href="./lib/faster_csv_rb.html?TB_iframe=true&amp;height=550&amp;width=785"
							class="thickbox" title="lib/faster_csv.rb">lib/faster_csv.rb</a></li>
					
					</ul>
				</div>
			</div>

			
		</div>

		<div id="class-metadata">

			<!-- Parent Class -->
			
			<div id="parent-class-section" class="section">
				<h3 class="section-header">Parent</h3>
				
				<p class="link">Object</p>
				
			</div>
			

			<!-- Namespace Contents -->
			
			<div id="namespace-list-section" class="section">
				<h3 class="section-header">Namespace</h3>
				<ul class="link-list">
					
					<li><span class="type">CLASS</span> <a href="FasterCSV/MalformedCSVError.html">FasterCSV::MalformedCSVError</a></li>
					
					<li><span class="type">CLASS</span> <a href="FasterCSV/Row.html">FasterCSV::Row</a></li>
					
					<li><span class="type">CLASS</span> <a href="FasterCSV/Table.html">FasterCSV::Table</a></li>
					
				</ul>
			</div>
			

			<!-- Method Quickref -->
			
			<div id="method-list-section" class="section">
				<h3 class="section-header">Methods</h3>
				<ul class="link-list">
					
					<li><a href="#method-c-build_csv_interface">::build_csv_interface</a></li>
					
					<li><a href="#method-c-const_missing">::const_missing</a></li>
					
					<li><a href="#method-c-dump">::dump</a></li>
					
					<li><a href="#method-c-filter">::filter</a></li>
					
					<li><a href="#method-c-foreach">::foreach</a></li>
					
					<li><a href="#method-c-generate">::generate</a></li>
					
					<li><a href="#method-c-generate_line">::generate_line</a></li>
					
					<li><a href="#method-c-instance">::instance</a></li>
					
					<li><a href="#method-c-load">::load</a></li>
					
					<li><a href="#method-c-method_missing">::method_missing</a></li>
					
					<li><a href="#method-c-new">::new</a></li>
					
					<li><a href="#method-c-open">::open</a></li>
					
					<li><a href="#method-c-parse">::parse</a></li>
					
					<li><a href="#method-c-parse_line">::parse_line</a></li>
					
					<li><a href="#method-c-read">::read</a></li>
					
					<li><a href="#method-c-readlines">::readlines</a></li>
					
					<li><a href="#method-c-table">::table</a></li>
					
					<li><a href="#method-i-%3C%3C">#<<</a></li>
					
					<li><a href="#method-i-add_converter">#add_converter</a></li>
					
					<li><a href="#method-i-add_row">#add_row</a></li>
					
					<li><a href="#method-i-add_unconverted_fields">#add_unconverted_fields</a></li>
					
					<li><a href="#method-i-convert">#convert</a></li>
					
					<li><a href="#method-i-convert_fields">#convert_fields</a></li>
					
					<li><a href="#method-i-each">#each</a></li>
					
					<li><a href="#method-i-gets">#gets</a></li>
					
					<li><a href="#method-i-header_convert">#header_convert</a></li>
					
					<li><a href="#method-i-header_row%3F">#header_row?</a></li>
					
					<li><a href="#method-i-init_converters">#init_converters</a></li>
					
					<li><a href="#method-i-init_headers">#init_headers</a></li>
					
					<li><a href="#method-i-init_parsers">#init_parsers</a></li>
					
					<li><a href="#method-i-init_separators">#init_separators</a></li>
					
					<li><a href="#method-i-inspect">#inspect</a></li>
					
					<li><a href="#method-i-method_missing">#method_missing</a></li>
					
					<li><a href="#method-i-parse_headers">#parse_headers</a></li>
					
					<li><a href="#method-i-puts">#puts</a></li>
					
					<li><a href="#method-i-read">#read</a></li>
					
					<li><a href="#method-i-readline">#readline</a></li>
					
					<li><a href="#method-i-readlines">#readlines</a></li>
					
					<li><a href="#method-i-rewind">#rewind</a></li>
					
					<li><a href="#method-i-shift">#shift</a></li>
					
				</ul>
			</div>
			

			<!-- Included Modules -->
			
			<div id="includes-section" class="section">
				<h3 class="section-header">Included Modules</h3>
				<ul class="link-list">
				
				
					<li><span class="include">Enumerable</span></li>
				
				
				</ul>
			</div>
			
		</div>

		<div id="project-metadata">
			
			
			<div id="fileindex-section" class="section project-section">
				<h3 class="section-header">Files</h3>
				<ul>
				
					<li class="file"><a href="./AUTHORS.html">AUTHORS</a></li>
				
					<li class="file"><a href="./CHANGELOG.html">CHANGELOG</a></li>
				
					<li class="file"><a href="./COPYING.html">COPYING</a></li>
				
					<li class="file"><a href="./INSTALL.html">INSTALL</a></li>
				
					<li class="file"><a href="./LICENSE.html">LICENSE</a></li>
				
					<li class="file"><a href="./README.html">README</a></li>
				
					<li class="file"><a href="./TODO.html">TODO</a></li>
				
				</ul>
			</div>
			

			<div id="classindex-section" class="section project-section">
				<h3 class="section-header">Class Index
					<span class="search-toggle"><img src="./images/find.png"
						height="16" width="16" alt="[+]"
						title="show/hide quicksearch" /></span></h3>
				<form action="#" method="get" accept-charset="utf-8" class="initially-hidden">
				<fieldset>
					<legend>Quicksearch</legend>
					<input type="text" name="quicksearch" value=""
						class="quicksearch-field" />
				</fieldset>
				</form>

				<ul class="link-list">
				
					<li><a href="./FasterCSV.html">FasterCSV</a></li>
				
					<li><a href="./FasterCSV/MalformedCSVError.html">FasterCSV::MalformedCSVError</a></li>
				
					<li><a href="./FasterCSV/Row.html">FasterCSV::Row</a></li>
				
					<li><a href="./FasterCSV/Table.html">FasterCSV::Table</a></li>
				
				</ul>
				<div id="no-class-search-results" style="display: none;">No matching classes.</div>
			</div>

			
		</div>
	</div>

	<div id="documentation">
		<h1 class="class">FasterCSV</h1>

		<div id="description">
			<p>
This class provides a complete interface to CSV files and data.  It offers
tools to enable you to read and write to and from Strings or IO objects, as
needed.
</p>
<h2>Reading</h2>
<h3>From a File</h3>
<h4>A Line at a Time</h4>
<pre>
  FasterCSV.foreach(&quot;path/to/file.csv&quot;) do |row|
    # use row here...
  end
</pre>
<h4>All at Once</h4>
<pre>
  arr_of_arrs = FasterCSV.read(&quot;path/to/file.csv&quot;)
</pre>
<h3>From a String</h3>
<h4>A Line at a Time</h4>
<pre>
  FasterCSV.parse(&quot;CSV,data,String&quot;) do |row|
    # use row here...
  end
</pre>
<h4>All at Once</h4>
<pre>
  arr_of_arrs = FasterCSV.parse(&quot;CSV,data,String&quot;)
</pre>
<h2>Writing</h2>
<h3>To a File</h3>
<pre>
  FasterCSV.open(&quot;path/to/file.csv&quot;, &quot;w&quot;) do |csv|
    csv &lt;&lt; [&quot;row&quot;, &quot;of&quot;, &quot;CSV&quot;, &quot;data&quot;]
    csv &lt;&lt; [&quot;another&quot;, &quot;row&quot;]
    # ...
  end
</pre>
<h3>To a String</h3>
<pre>
  csv_string = FasterCSV.generate do |csv|
    csv &lt;&lt; [&quot;row&quot;, &quot;of&quot;, &quot;CSV&quot;, &quot;data&quot;]
    csv &lt;&lt; [&quot;another&quot;, &quot;row&quot;]
    # ...
  end
</pre>
<h2>Convert a Single Line</h2>
<pre>
  csv_string = [&quot;CSV&quot;, &quot;data&quot;].to_csv   # to CSV
  csv_array  = &quot;CSV,String&quot;.parse_csv   # from CSV
</pre>
<h2>Shortcut Interface</h2>
<pre>
  FCSV             { |csv_out| csv_out &lt;&lt; %w{my data here} }  # to $stdout
  FCSV(csv = &quot;&quot;)   { |csv_str| csv_str &lt;&lt; %w{my data here} }  # to a String
  FCSV($stderr)    { |csv_err| csv_err &lt;&lt; %w{my data here} }  # to $stderr
  FCSV($stdin)     { |csv_in|  csv_in.each { |row| p row } }  # from $stdin
</pre>
<h2>Advanced Usage</h2>
<h3>Wrap an IO Object</h3>
<pre>
  csv = FCSV.new(io, options)
  # ... read (with gets() or each()) from and write (with &lt;&lt;) to csv here ...</pre>

		</div>

		<!-- Constants -->
		
		<div id="constants-list" class="section">
			<h3 class="section-header">Constants</h3>
			<dl>
			
				<dt><a name="VERSION">VERSION</a></dt>
				
				<dd class="description"><p>
The version of the installed library.
</p></dd>
				
			
				<dt><a name="FieldInfo">FieldInfo</a></dt>
				
				<dd class="description"><p>
A <a href="FasterCSV.html#FieldInfo">FieldInfo</a> Struct contains details
about a field&#8217;s position in the data source it was read from.  <a
href="FasterCSV.html">FasterCSV</a> will pass this Struct to some blocks
that make decisions based on field structure.  See  <a
href="FasterCSV.html#method-i-convert_fields">FasterCSV.convert_fields()</a>
for an example.
</p>
<table>
<tr><td valign="top"><b><tt>index</tt></b></td><td><p>
The zero-based index of the field in its row.
</p>
</td></tr>
<tr><td valign="top"><b><tt>line</tt></b></td><td><p>
The line of the data source this row is from.
</p>
</td></tr>
<tr><td valign="top"><b><tt>header</tt></b></td><td><p>
The header for the column, when available.
</p>
</td></tr>
</table></dd>
				
			
				<dt><a name="DateMatcher">DateMatcher</a></dt>
				
				<dd class="description"><p>
A Regexp used to find and convert some common Date formats.
</p></dd>
				
			
				<dt><a name="DateTimeMatcher">DateTimeMatcher</a></dt>
				
				<dd class="description"><p>
A Regexp used to find and convert some common DateTime formats.
</p></dd>
				
			
				<dt><a name="Converters">Converters</a></dt>
				
				<dd class="description"><p>
This Hash holds the built-in converters of <a
href="FasterCSV.html">FasterCSV</a> that can be accessed by name.  You can
select <a href="FasterCSV.html#Converters">Converters</a> with <a
href="FasterCSV.html#method-i-convert">FasterCSV.convert()</a> or through
the <tt>options</tt> Hash passed to <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a>.
</p>
<table>
<tr><td valign="top"><b><tt>:integer</tt></b></td><td><p>
Converts any field Integer() accepts.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:float</tt></b></td><td><p>
Converts any field Float() accepts.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:numeric</tt></b></td><td><p>
A combination of <tt>:integer</tt>  and <tt>:float</tt>.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:date</tt></b></td><td><p>
Converts any field Date::parse() accepts.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:date_time</tt></b></td><td><p>
Converts any field DateTime::parse() accepts.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:all</tt></b></td><td><p>
All built-in converters.  A combination of  <tt>:date_time</tt> and
<tt>:numeric</tt>.
</p>
</td></tr>
</table>
<p>
This Hash is intetionally left unfrozen and users should feel free to add
values to it that can be accessed by all <a
href="FasterCSV.html">FasterCSV</a> objects.
</p>
<p>
To add a combo field, the value should be an Array of names.  Combo fields
can be nested with other combo fields.
</p></dd>
				
			
				<dt><a name="HeaderConverters">HeaderConverters</a></dt>
				
				<dd class="description"><p>
This Hash holds the built-in header converters of <a
href="FasterCSV.html">FasterCSV</a> that can be accessed by name.  You can
select <a href="FasterCSV.html#HeaderConverters">HeaderConverters</a> with
<a
href="FasterCSV.html#method-i-header_convert">FasterCSV.header_convert()</a>
or through the <tt>options</tt> Hash passed to <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a>.
</p>
<table>
<tr><td valign="top"><b><tt>:downcase</tt></b></td><td><p>
Calls downcase() on the header String.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:symbol</tt></b></td><td><p>
The header String is downcased, spaces are replaced with underscores,
non-word characters are dropped, and finally to_sym() is called.
</p>
</td></tr>
</table>
<p>
This Hash is intetionally left unfrozen and users should feel free to add
values to it that can be accessed by all <a
href="FasterCSV.html">FasterCSV</a> objects.
</p>
<p>
To add a combo field, the value should be an Array of names.  Combo fields
can be nested with other combo fields.
</p></dd>
				
			
				<dt><a name="DEFAULT_OPTIONS">DEFAULT_OPTIONS</a></dt>
				
				<dd class="description"><p>
The options used when no overrides are given by calling code.  They are:
</p>
<table>
<tr><td valign="top"><b><tt>:col_sep</tt></b></td><td><p>
<tt>&quot;,&quot;</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:row_sep</tt></b></td><td><p>
<tt>:auto</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:quote_char</tt></b></td><td><p>
<tt>'&quot;'</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:converters</tt></b></td><td><p>
<tt>nil</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:unconverted_fields</tt></b></td><td><p>
<tt>nil</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:headers</tt></b></td><td><p>
<tt>false</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:return_headers</tt></b></td><td><p>
<tt>false</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:header_converters</tt></b></td><td><p>
<tt>nil</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:skip_blanks</tt></b></td><td><p>
<tt>false</tt>
</p>
</td></tr>
<tr><td valign="top"><b><tt>:force_quotes</tt></b></td><td><p>
<tt>false</tt>
</p>
</td></tr>
</table></dd>
				
			
			</dl>
		</div>
		

		<!-- Attributes -->
		
		<div id="attribute-method-details" class="method-section section">
			<h3 class="section-header">Attributes</h3>

			
			<div id="lineno-attribute-method" class="method-detail">
				<a name="lineno"></a>
				
				<div class="method-heading attribute-method-heading">
					<span class="method-name">lineno</span><span
						class="attribute-access-type">[R]</span>
				</div>

				<div class="method-description">
				
				<p>
The line number of the last row read from this file.  Fields with nested 
line-end characters will not affect this count.
</p>
				
				</div>
			</div>
			
		</div>
		

		<!-- Methods -->
		
		<div id="public-class-method-details" class="method-section section">
			<h3 class="section-header">Public Class Methods</h3>

		
			<div id="build-csv-interface-method" class="method-detail ">
				<a name="method-c-build_csv_interface"></a>

				<div class="method-heading">
				
					<span class="method-name">build_csv_interface</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method will build a drop-in replacement for many of the standard CSV
methods.  It allows you to write code like:
</p>
<pre>
  begin
    require &quot;faster_csv&quot;
    FasterCSV.build_csv_interface
  rescue LoadError
    require &quot;csv&quot;
  end
  # ... use CSV here ...
</pre>
<p>
This is not a complete interface with completely identical behavior.
However, it is intended to be close enough that you won&#8217;t notice the
difference in most cases.  CSV methods supported are:
</p>
<ul>
<li><p>
foreach()
</p>
</li>
<li><p>
<a href="FasterCSV.html#method-c-generate_line">generate_line</a>()
</p>
</li>
<li><p>
open()
</p>
</li>
<li><p>
parse()
</p>
</li>
<li><p>
<a href="FasterCSV.html#method-c-parse_line">parse_line</a>()
</p>
</li>
<li><p>
readlines()
</p>
</li>
</ul>
<p>
Be warned that this interface is slower than vanilla <a
href="FasterCSV.html">FasterCSV</a> due to the extra layer of method calls.
Depending on usage, this can slow it down to  near CSV speeds.
</p>
					

					
					<div class="method-source-code"
						id="build-csv-interface-source">
<pre>
     <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 874</span>
874:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">build_csv_interface</span>
875:       <span class="ruby-constant">Object</span>.<span class="ruby-identifier">const_set</span>(<span class="ruby-value">:CSV</span>, <span class="ruby-constant">Class</span>.<span class="ruby-identifier">new</span>).<span class="ruby-identifier">class_eval</span> <span class="ruby-keyword kw">do</span>
876:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value">:auto</span>, &amp;<span class="ruby-identifier">block</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
877:           <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>, &amp;<span class="ruby-identifier">block</span>)
878:         <span class="ruby-keyword kw">end</span>
879: 
880:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate_line</span>(<span class="ruby-identifier">row</span>, <span class="ruby-identifier">fs</span> = <span class="ruby-value str">&quot;,&quot;</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value str">&quot;&quot;</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
881:           <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">generate_line</span>(<span class="ruby-identifier">row</span>, <span class="ruby-value">:col_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fs</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>)
882:         <span class="ruby-keyword kw">end</span>
883: 
884:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">mode</span>, <span class="ruby-identifier">fs</span> = <span class="ruby-value str">&quot;,&quot;</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value">:auto</span>, &amp;<span class="ruby-identifier">block</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
885:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">mode</span>.<span class="ruby-identifier">include?</span> <span class="ruby-value str">&quot;r&quot;</span>
886:             <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">mode</span>, <span class="ruby-value">:col_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fs</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span>
887:               <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
888:             <span class="ruby-keyword kw">end</span>
889:           <span class="ruby-keyword kw">else</span>
890:             <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">mode</span>, <span class="ruby-value">:col_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fs</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>, &amp;<span class="ruby-identifier">block</span>)
891:           <span class="ruby-keyword kw">end</span>
892:         <span class="ruby-keyword kw">end</span>
893: 
894:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">str_or_readable</span>, <span class="ruby-identifier">fs</span> = <span class="ruby-value str">&quot;,&quot;</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value">:auto</span>, &amp;<span class="ruby-identifier">block</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
895:           <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">parse</span>(<span class="ruby-identifier">str_or_readable</span>, <span class="ruby-value">:col_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fs</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>, &amp;<span class="ruby-identifier">block</span>)
896:         <span class="ruby-keyword kw">end</span>
897: 
898:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">src</span>, <span class="ruby-identifier">fs</span> = <span class="ruby-value str">&quot;,&quot;</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value">:auto</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
899:           <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">src</span>, <span class="ruby-value">:col_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">fs</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>)
900:         <span class="ruby-keyword kw">end</span>
901: 
902:         <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">rs</span> = <span class="ruby-value">:auto</span>)  <span class="ruby-comment cmt"># :nodoc:</span>
903:           <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">readlines</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">rs</span>)
904:         <span class="ruby-keyword kw">end</span>
905:       <span class="ruby-keyword kw">end</span>
906:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="const-missing-method" class="method-detail ">
				<a name="method-c-const_missing"></a>

				<div class="method-heading">
				
					<span class="method-name">const_missing</span><span
						class="method-args">(*_)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="const-missing-source">
<pre>
    <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 12</span>
12:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">const_missing</span>(*<span class="ruby-identifier">_</span>)
13:       <span class="ruby-identifier">raise</span> <span class="ruby-constant">NotImplementedError</span>, <span class="ruby-value str">&quot;Please switch to Ruby 1.9's standard CSV &quot;</span>  <span class="ruby-operator">+</span>
14:                                  <span class="ruby-value str">&quot;library.  It's FasterCSV plus support for &quot;</span> <span class="ruby-operator">+</span>
15:                                  <span class="ruby-value str">&quot;Ruby 1.9's m17n encoding engine.&quot;</span>
16:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="dump-method" class="method-detail ">
				<a name="method-c-dump"></a>

				<div class="method-heading">
				
					<span class="method-name">dump</span><span
						class="method-args">(ary_of_objs, io = "", options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method allows you to serialize an Array of Ruby objects to a String or
File of CSV data.  This is not as powerful as Marshal or YAML, but perhaps
useful for spreadsheet and database interaction.
</p>
<p>
Out of the box, this method is intended to work with simple data objects or
Structs.  It will serialize a list of instance variables and/or
Struct.members().
</p>
<p>
If you need need more complicated serialization, you can control the
process by adding methods to the class to be serialized.
</p>
<p>
A class method csv_meta() is responsible for returning the first row of the
document (as an Array).  This row is considered to be a Hash of the form
key_1,value_1,key_2,value_2,&#8230;  <a
href="FasterCSV.html#method-c-load">FasterCSV::load()</a> expects to find a
class key with a value of the stringified class name and <a
href="FasterCSV.html#method-c-dump">FasterCSV::dump()</a> will create this,
if you do not define this method.  This method is only called on the first
object of the Array.
</p>
<p>
The next method you can provide is an instance method called csv_headers().
This method is expected to return the second line of the document (again as
an Array), which is to be used to give each column a header.  By default,
<a href="FasterCSV.html#method-c-load">FasterCSV::load()</a> will set an
instance variable if the field header starts with an @ character or call
send() passing the header as the method name and the field value as an
argument.  This method is only called on the first object of the Array.
</p>
<p>
Finally, you can provide an instance method called csv_dump(), which will
be passed the headers.  This should return an Array of fields that can be
serialized for this object.  This method is called once for every object in
the Array.
</p>
<p>
The <tt>io</tt> parameter can be used to serialize to a File, and
<tt>options</tt> can be anything <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> accepts.
</p>
					

					
					<div class="method-source-code"
						id="dump-source">
<pre>
     <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 943</span>
943:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">dump</span>(<span class="ruby-identifier">ary_of_objs</span>, <span class="ruby-identifier">io</span> = <span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
944:       <span class="ruby-identifier">obj_template</span> = <span class="ruby-identifier">ary_of_objs</span>.<span class="ruby-identifier">first</span>
945: 
946:       <span class="ruby-identifier">csv</span> = <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">io</span>, <span class="ruby-identifier">options</span>)
947: 
948:       <span class="ruby-comment cmt"># write meta information</span>
949:       <span class="ruby-keyword kw">begin</span>
950:         <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">csv_meta</span>
951:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>
952:         <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> [<span class="ruby-value">:class</span>, <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>]
953:       <span class="ruby-keyword kw">end</span>
954: 
955:       <span class="ruby-comment cmt"># write headers</span>
956:       <span class="ruby-keyword kw">begin</span>
957:         <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">csv_headers</span>
958:       <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>
959:         <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">instance_variables</span>.<span class="ruby-identifier">sort</span>
960:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">ancestors</span>.<span class="ruby-identifier">find</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">cls</span><span class="ruby-operator">|</span> <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">to_s</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\AStruct\b/</span> }
961:           <span class="ruby-identifier">headers</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">obj_template</span>.<span class="ruby-identifier">members</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">mem</span><span class="ruby-operator">|</span> <span class="ruby-node">&quot;#{mem}=&quot;</span> }.<span class="ruby-identifier">sort</span>
962:         <span class="ruby-keyword kw">end</span>
963:       <span class="ruby-keyword kw">end</span>
964:       <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">headers</span>
965: 
966:       <span class="ruby-comment cmt"># serialize each object</span>
967:       <span class="ruby-identifier">ary_of_objs</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">obj</span><span class="ruby-operator">|</span>
968:         <span class="ruby-keyword kw">begin</span>
969:           <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">csv_dump</span>(<span class="ruby-identifier">headers</span>)
970:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>
971:           <span class="ruby-identifier">csv</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">var</span><span class="ruby-operator">|</span>
972:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">var</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">@@</span>
973:               <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-identifier">var</span>)
974:             <span class="ruby-keyword kw">else</span>
975:               <span class="ruby-identifier">obj</span>[<span class="ruby-identifier">var</span>[<span class="ruby-value">0</span><span class="ruby-operator">..</span><span class="ruby-value">2</span>]]
976:             <span class="ruby-keyword kw">end</span>
977:           <span class="ruby-keyword kw">end</span>
978:         <span class="ruby-keyword kw">end</span>
979:       <span class="ruby-keyword kw">end</span>
980: 
981:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">io</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
982:         <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">string</span>
983:       <span class="ruby-keyword kw">else</span>
984:         <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
985:       <span class="ruby-keyword kw">end</span>
986:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="filter-method" class="method-detail ">
				<a name="method-c-filter"></a>

				<div class="method-heading">
				
					<span class="method-callseq"> }</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method is a convenience for building Unix-like filters for CSV data.
Each row is yielded to the provided block which can alter it as needed.  
After the block returns, the row is appended to <tt>output</tt> altered or
not.
</p>
<p>
The <tt>input</tt> and <tt>output</tt> arguments can be anything <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> accepts (generally
String or IO objects).  If not given, they default to  <tt>ARGF</tt> and
<tt>$stdout</tt>.
</p>
<p>
The <tt>options</tt> parameter is also filtered down to <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> after some clever
key parsing.  Any key beginning with <tt>:in_</tt> or  <tt>:input_</tt>
will have that leading identifier stripped and will only be used in the
<tt>options</tt> Hash for the <tt>input</tt> object.  Keys starting with
<tt>:out_</tt> or <tt>:output_</tt> affect only <tt>output</tt>.  All other
keys  are assigned to both objects.
</p>
<p>
The <tt>:output_row_sep</tt> <tt>option</tt> defaults to
<tt>$INPUT_RECORD_SEPARATOR</tt> (<tt>$/</tt>).
</p>
					

					
					<div class="method-source-code"
						id="filter-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1012</span>
1012:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">filter</span>(*<span class="ruby-identifier">args</span>)
1013:       <span class="ruby-comment cmt"># parse options for input, output, or both</span>
1014:       <span class="ruby-identifier">in_options</span>, <span class="ruby-identifier">out_options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>, {<span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$INPUT_RECORD_SEPARATOR</span>}
1015:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span>
1016:         <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">key</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1017:           <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">key</span>.<span class="ruby-identifier">to_s</span>
1018:           <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/\Ain(?:put)?_(.+)\Z/</span>
1019:             <span class="ruby-identifier">in_options</span>[<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
1020:           <span class="ruby-keyword kw">when</span> <span class="ruby-regexp re">/\Aout(?:put)?_(.+)\Z/</span>
1021:             <span class="ruby-identifier">out_options</span>[<span class="ruby-node">$1</span>.<span class="ruby-identifier">to_sym</span>] = <span class="ruby-identifier">value</span>
1022:           <span class="ruby-keyword kw">else</span>
1023:             <span class="ruby-identifier">in_options</span>[<span class="ruby-identifier">key</span>]  = <span class="ruby-identifier">value</span>
1024:             <span class="ruby-identifier">out_options</span>[<span class="ruby-identifier">key</span>] = <span class="ruby-identifier">value</span>
1025:           <span class="ruby-keyword kw">end</span>
1026:         <span class="ruby-keyword kw">end</span>
1027:       <span class="ruby-keyword kw">end</span>
1028:       <span class="ruby-comment cmt"># build input and output wrappers</span>
1029:       <span class="ruby-identifier">input</span>   = <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-constant">ARGF</span>,    <span class="ruby-identifier">in_options</span>)
1030:       <span class="ruby-identifier">output</span>  = <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">$stdout</span>, <span class="ruby-identifier">out_options</span>)
1031: 
1032:       <span class="ruby-comment cmt"># read, yield, write</span>
1033:       <span class="ruby-identifier">input</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
1034:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">row</span>
1035:         <span class="ruby-identifier">output</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>
1036:       <span class="ruby-keyword kw">end</span>
1037:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="foreach-method" class="method-detail ">
				<a name="method-c-foreach"></a>

				<div class="method-heading">
				
					<span class="method-name">foreach</span><span
						class="method-args">(path, options = Hash.new, &block)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method is intended as the primary interface for reading CSV files. 
You pass a <tt>path</tt> and any <tt>options</tt> you wish to set for the
read.  Each row of file will be passed to the provided <tt>block</tt> in
turn.
</p>
<p>
The <tt>options</tt> parameter can be anything <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
					

					
					<div class="method-source-code"
						id="foreach-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1046</span>
1046:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">foreach</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>, &amp;<span class="ruby-identifier">block</span>)
1047:       <span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">&quot;rb&quot;</span>, <span class="ruby-identifier">options</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span>
1048:         <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
1049:       <span class="ruby-keyword kw">end</span>
1050:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="generate-method" class="method-detail ">
				<a name="method-c-generate"></a>

				<div class="method-heading">
				
					<span class="method-callseq"> }</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method wraps a String you provide, or an empty default String, in a 
<a href="FasterCSV.html">FasterCSV</a> object which is passed to the
provided block.  You can use the  block to append CSV rows to the String
and when the block exits, the  final String will be returned.
</p>
<p>
Note that a passed String <b>is</b> modfied by this method.  Call dup()
before passing if you need a new String.
</p>
<p>
The <tt>options</tt> parameter can be anthing <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
					

					
					<div class="method-source-code"
						id="generate-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1067</span>
1067:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate</span>(*<span class="ruby-identifier">args</span>)
1068:       <span class="ruby-comment cmt"># add a default empty String, if none was given</span>
1069:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">first</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
1070:         <span class="ruby-identifier">io</span> = <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">args</span>.<span class="ruby-identifier">shift</span>)
1071:         <span class="ruby-identifier">io</span>.<span class="ruby-identifier">seek</span>(<span class="ruby-value">0</span>, <span class="ruby-constant">IO</span><span class="ruby-operator">::</span><span class="ruby-constant">SEEK_END</span>)
1072:         <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-identifier">io</span>)
1073:       <span class="ruby-keyword kw">else</span>
1074:         <span class="ruby-identifier">args</span>.<span class="ruby-identifier">unshift</span>(<span class="ruby-value str">&quot;&quot;</span>)
1075:       <span class="ruby-keyword kw">end</span>
1076:       <span class="ruby-identifier">faster_csv</span> = <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>)  <span class="ruby-comment cmt"># wrap</span>
1077:       <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">faster_csv</span>         <span class="ruby-comment cmt"># yield for appending</span>
1078:       <span class="ruby-identifier">faster_csv</span>.<span class="ruby-identifier">string</span>        <span class="ruby-comment cmt"># return final String</span>
1079:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="generate-line-method" class="method-detail ">
				<a name="method-c-generate_line"></a>

				<div class="method-heading">
				
					<span class="method-name">generate_line</span><span
						class="method-args">(row, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method is a shortcut for converting a single row (Array) into a CSV 
String.
</p>
<p>
The <tt>options</tt> parameter can be anthing <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
<p>
The <tt>:row_sep</tt> <tt>option</tt> defaults to
<tt>$INPUT_RECORD_SEPARATOR</tt> (<tt>$/</tt>) when calling this method.
</p>
					

					
					<div class="method-source-code"
						id="generate-line-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1090</span>
1090:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">generate_line</span>(<span class="ruby-identifier">row</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1091:       <span class="ruby-identifier">options</span> = {<span class="ruby-value">:row_sep</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-identifier">$INPUT_RECORD_SEPARATOR</span>}.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
1092:       (<span class="ruby-identifier">new</span>(<span class="ruby-value str">&quot;&quot;</span>, <span class="ruby-identifier">options</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>).<span class="ruby-identifier">string</span>
1093:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="instance-method" class="method-detail ">
				<a name="method-c-instance"></a>

				<div class="method-heading">
				
					<span class="method-name">instance</span><span
						class="method-args">(data = $stdout, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method will return a <a href="FasterCSV.html">FasterCSV</a> instance,
just like <a href="FasterCSV.html#method-c-new">FasterCSV::new()</a>,  but
the instance will be cached and returned for all future calls to this 
method for the same <tt>data</tt> object (tested by Object#object_id())
with the same <tt>options</tt>.
</p>
<p>
If a block is given, the instance is passed to the block and the return
value becomes the return value of the block.
</p>
					

					
					<div class="method-source-code"
						id="instance-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1104</span>
1104:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">instance</span>(<span class="ruby-identifier">data</span> = <span class="ruby-identifier">$stdout</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1105:       <span class="ruby-comment cmt"># create a _signature_ for this method call, data object and options</span>
1106:       <span class="ruby-identifier">sig</span> = [<span class="ruby-identifier">data</span>.<span class="ruby-identifier">object_id</span>] <span class="ruby-operator">+</span>
1107:             <span class="ruby-identifier">options</span>.<span class="ruby-identifier">values_at</span>(*<span class="ruby-constant">DEFAULT_OPTIONS</span>.<span class="ruby-identifier">keys</span>.<span class="ruby-identifier">sort_by</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">sym</span><span class="ruby-operator">|</span> <span class="ruby-identifier">sym</span>.<span class="ruby-identifier">to_s</span> })
1108: 
1109:       <span class="ruby-comment cmt"># fetch or create the instance for this signature</span>
1110:       <span class="ruby-identifier">@@instances</span> <span class="ruby-operator">||=</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>
1111:       <span class="ruby-identifier">instance</span>    =   (<span class="ruby-identifier">@@instances</span>[<span class="ruby-identifier">sig</span>] <span class="ruby-operator">||=</span> <span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">options</span>))
1112: 
1113:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
1114:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">instance</span>  <span class="ruby-comment cmt"># run block, if given, returning result</span>
1115:       <span class="ruby-keyword kw">else</span>
1116:         <span class="ruby-identifier">instance</span>        <span class="ruby-comment cmt"># or return the instance</span>
1117:       <span class="ruby-keyword kw">end</span>
1118:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="load-method" class="method-detail ">
				<a name="method-c-load"></a>

				<div class="method-heading">
				
					<span class="method-name">load</span><span
						class="method-args">(io_or_str, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method is the reading counterpart to <a
href="FasterCSV.html#method-c-dump">FasterCSV::dump()</a>.  See that method
for a detailed description of the process.
</p>
<p>
You can customize loading by adding a class method called csv_load() which 
will be passed a Hash of meta information, an Array of headers, and an
Array of fields for the object the method is expected to return.
</p>
<p>
Remember that all fields will be Strings after this load.  If you need
something else, use <tt>options</tt> to setup converters or provide a
custom csv_load() implementation.
</p>
					

					
					<div class="method-source-code"
						id="load-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1132</span>
1132:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">load</span>(<span class="ruby-identifier">io_or_str</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1133:       <span class="ruby-identifier">csv</span> = <span class="ruby-constant">FasterCSV</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">io_or_str</span>, <span class="ruby-identifier">options</span>)
1134: 
1135:       <span class="ruby-comment cmt"># load meta information</span>
1136:       <span class="ruby-identifier">meta</span> = <span class="ruby-constant">Hash</span>[*<span class="ruby-identifier">csv</span>.<span class="ruby-identifier">shift</span>]
1137:       <span class="ruby-identifier">cls</span>  = <span class="ruby-identifier">meta</span>[<span class="ruby-value str">&quot;class&quot;</span>].<span class="ruby-identifier">split</span>(<span class="ruby-value str">&quot;::&quot;</span>).<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Object</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">c</span>, <span class="ruby-identifier">const</span><span class="ruby-operator">|</span>
1138:         <span class="ruby-identifier">c</span>.<span class="ruby-identifier">const_get</span>(<span class="ruby-identifier">const</span>)
1139:       <span class="ruby-keyword kw">end</span>
1140: 
1141:       <span class="ruby-comment cmt"># load headers</span>
1142:       <span class="ruby-identifier">headers</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">shift</span>
1143: 
1144:       <span class="ruby-comment cmt"># unserialize each object stored in the file</span>
1145:       <span class="ruby-identifier">results</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">inject</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">all</span>, <span class="ruby-identifier">row</span><span class="ruby-operator">|</span>
1146:         <span class="ruby-keyword kw">begin</span>
1147:           <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">csv_load</span>(<span class="ruby-identifier">meta</span>, <span class="ruby-identifier">headers</span>, <span class="ruby-identifier">row</span>)
1148:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>
1149:           <span class="ruby-identifier">obj</span> = <span class="ruby-identifier">cls</span>.<span class="ruby-identifier">allocate</span>
1150:           <span class="ruby-identifier">headers</span>.<span class="ruby-identifier">zip</span>(<span class="ruby-identifier">row</span>) <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span><span class="ruby-operator">|</span>
1151:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">==</span> <span class="ruby-value">@@</span>
1152:               <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
1153:             <span class="ruby-keyword kw">else</span>
1154:               <span class="ruby-identifier">obj</span>.<span class="ruby-identifier">send</span>(<span class="ruby-identifier">name</span>, <span class="ruby-identifier">value</span>)
1155:             <span class="ruby-keyword kw">end</span>
1156:           <span class="ruby-keyword kw">end</span>
1157:         <span class="ruby-keyword kw">end</span>
1158:         <span class="ruby-identifier">all</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">obj</span>
1159:       <span class="ruby-keyword kw">end</span>
1160: 
1161:       <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">io_or_str</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>
1162: 
1163:       <span class="ruby-identifier">results</span>
1164:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="method-missing-method" class="method-detail ">
				<a name="method-c-method_missing"></a>

				<div class="method-heading">
				
					<span class="method-name">method_missing</span><span
						class="method-args">(*_)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="method-missing-source">
<pre>
    <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 18</span>
18:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">method_missing</span>(*<span class="ruby-identifier">_</span>)
19:       <span class="ruby-identifier">const_missing</span>
20:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="new-method" class="method-detail ">
				<a name="method-c-new"></a>

				<div class="method-heading">
				
					<span class="method-name">new</span><span
						class="method-args">(data, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This constructor will wrap either a String or IO object passed in
<tt>data</tt> for reading and/or writing.  In addition to the <a
href="FasterCSV.html">FasterCSV</a> instance methods,  several IO methods
are delegated.  (See <a
href="FasterCSV.html#method-c-open">FasterCSV::open()</a> for a complete 
list.)  If you pass a String for <tt>data</tt>, you can later retrieve it
(after writing to it, for example) with FasterCSV.string().
</p>
<p>
Note that a wrapped String will be positioned at the beginning (for 
reading).  If you want it at the end (for writing), use  <a
href="FasterCSV.html#method-c-generate">FasterCSV::generate()</a>.  If you
want any other positioning, pass a preset  StringIO object instead.
</p>
<p>
You may set any reading and/or writing preferences in the <tt>options</tt>
Hash.   Available options are:
</p>
<table>
<tr><td valign="top"><b><tt>:col_sep</tt></b></td><td><p>
The String placed between each field.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:row_sep</tt></b></td><td><p>
The String appended to the end of each row.  This can be set to the special
<tt>:auto</tt> setting, which requests that <a
href="FasterCSV.html">FasterCSV</a> automatically discover this from the
data.  Auto-discovery reads ahead in the data looking for the next
<tt>&quot;r\n&quot;</tt>, <tt>&quot;n&quot;</tt>, or <tt>&quot;r&quot;</tt>
sequence.  A sequence will be selected even if it occurs in a quoted field,
assuming that you would have the same line endings there.  If none of those
sequences is found,  or the stream is only available for output, the
default <tt>$INPUT_RECORD_SEPARATOR</tt> (<tt>$/</tt>) is used.  Obviously,
discovery takes a little time.  Set manually if speed is important.  Also
note that IO objects should be opened in binary mode on Windows if this
feature will be used as the line-ending translation can cause problems with
resetting the document position to where it was before the read ahead.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:quote_char</tt></b></td><td><p>
The character used to quote fields. This has to be a single character
String.  This is useful for application that incorrectly use <tt>'</tt> as
the quote character instead of the correct <tt>&quot;</tt>. <a
href="FasterCSV.html">FasterCSV</a> will always consider a double sequence
this character to be an escaped quote.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:encoding</tt></b></td><td><p>
The encoding to use when parsing the file. Defaults to your <tt>$KCODE</tt>
setting. Valid values: <tt>`n</tt> or <tt>`N</tt> for none,
<tt>`e</tt> or <tt>`E</tt> for EUC, <tt>`s</tt> or <tt>`S</tt>
for SJIS, and <tt>`u</tt> or <tt>`U</tt> for UTF-8 (see
Regexp.new()).
</p>
</td></tr>
<tr><td valign="top"><b><tt>:field_size_limit</tt></b></td><td><p>
This is a maximum size <a href="FasterCSV.html">FasterCSV</a> will read
ahead looking for the closing quote for a field.  (In truth, it reads to
the first line ending beyond this size.)  If a quote cannot be found within
the limit <a href="FasterCSV.html">FasterCSV</a> will raise a <a
href="FasterCSV/MalformedCSVError.html">MalformedCSVError</a>, assuming the
data is faulty.  You can use this limit to prevent what are effectively DoS
attacks on the parser.  However, this limit can cause a legitimate parse to
fail and thus is set to <tt>nil</tt>, or off, by default.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:converters</tt></b></td><td><p>
An Array of names from the <a
href="FasterCSV.html#Converters">Converters</a> Hash and/or lambdas that
handle custom conversion.  A single converter doesn&#8217;t have to be in
an Array.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:unconverted_fields</tt></b></td><td><p>
If set to <tt>true</tt>, an unconverted_fields() method will be added to
all returned rows (Array or <a
href="FasterCSV/Row.html">FasterCSV::Row</a>) that will return the fields
as they were before convertion. Note that <tt>:headers</tt> supplied by
Array or String were not fields of the document and thus will have an empty
Array attached.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:headers</tt></b></td><td><p>
If set to <tt>:first_row</tt> or  <tt>true</tt>, the initial row of the CSV
file will be treated as a row of headers.  If set to an Array, the contents
will be used as the headers. If set to a String, the String is run through
a call of <a
href="FasterCSV.html#method-c-parse_line">FasterCSV::parse_line()</a> with
the same <tt>:col_sep</tt>, <tt>:row_sep</tt>, and <tt>:quote_char</tt> as
this instance to produce an Array of headers.  This setting causes <a
href="FasterCSV.html#method-i-shift">FasterCSV.shift()</a> to return rows
as <a href="FasterCSV/Row.html">FasterCSV::Row</a> objects instead of
Arrays and <a href="FasterCSV.html#method-i-read">FasterCSV.read()</a> to
return <a href="FasterCSV/Table.html">FasterCSV::Table</a> objects instead
of an Array of Arrays.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:return_headers</tt></b></td><td><p>
When <tt>false</tt>, header rows are silently swallowed.  If set to
<tt>true</tt>, header rows are returned in a <a
href="FasterCSV/Row.html">FasterCSV::Row</a> object with identical headers
and fields (save that the fields do not go through the converters).
</p>
</td></tr>
<tr><td valign="top"><b><tt>:write_headers</tt></b></td><td><p>
When <tt>true</tt> and <tt>:headers</tt> is set, a header row will be added
to the output. Note that if the table only contains header rows,
<tt>:return_headers</tt> must also be set in order for a header row to be
output.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:header_converters</tt></b></td><td><p>
Identical in functionality to <tt>:converters</tt> save that the
conversions are only made to header rows.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:skip_blanks</tt></b></td><td><p>
When set to a <tt>true</tt> value, <a href="FasterCSV.html">FasterCSV</a>
will skip over any rows with no content.
</p>
</td></tr>
<tr><td valign="top"><b><tt>:force_quotes</tt></b></td><td><p>
When set to a <tt>true</tt> value, <a href="FasterCSV.html">FasterCSV</a>
will quote all CSV fields it creates.
</p>
</td></tr>
</table>
<p>
See FasterCSV::DEFAULT_OPTIONS for the default settings.
</p>
<p>
Options cannot be overriden in the instance methods for performance
reasons, so be sure to set what you want here.
</p>
					

					
					<div class="method-source-code"
						id="new-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1423</span>
1423:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">initialize</span>(<span class="ruby-identifier">data</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1424:       <span class="ruby-comment cmt"># build the options for this read/write</span>
1425:       <span class="ruby-identifier">options</span> = <span class="ruby-constant">DEFAULT_OPTIONS</span>.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>)
1426: 
1427:       <span class="ruby-comment cmt"># create the IO object we will read from</span>
1428:       <span class="ruby-ivar">@io</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">data</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span> <span class="ruby-keyword kw">then</span> <span class="ruby-constant">StringIO</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">data</span>) <span class="ruby-keyword kw">else</span> <span class="ruby-identifier">data</span> <span class="ruby-keyword kw">end</span>
1429: 
1430:       <span class="ruby-identifier">init_separators</span>(<span class="ruby-identifier">options</span>)
1431:       <span class="ruby-identifier">init_parsers</span>(<span class="ruby-identifier">options</span>)
1432:       <span class="ruby-identifier">init_converters</span>(<span class="ruby-identifier">options</span>)
1433:       <span class="ruby-identifier">init_headers</span>(<span class="ruby-identifier">options</span>)
1434: 
1435:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">empty?</span>
1436:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-node">&quot;Unknown options:  #{options.keys.join(', ')}.&quot;</span>
1437:       <span class="ruby-keyword kw">end</span>
1438: 
1439:       <span class="ruby-comment cmt"># track our own lineno since IO gets confused about line-ends is CSV fields</span>
1440:       <span class="ruby-ivar">@lineno</span> = <span class="ruby-value">0</span>
1441:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="open-method" class="method-detail ">
				<a name="method-c-open"></a>

				<div class="method-heading">
				
					<span class="method-callseq">new )</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method opens an IO object, and wraps that with <a
href="FasterCSV.html">FasterCSV</a>.  This is intended as the primary
interface for writing a CSV file.
</p>
<p>
You may pass any <tt>args</tt> Ruby&#8217;s open() understands followed by
an optional Hash containing any <tt>options</tt> <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
<p>
This method works like Ruby&#8217;s open() call, in that it will pass a <a
href="FasterCSV.html">FasterCSV</a> object to a provided block and close it
when the block termminates, or it will return the <a
href="FasterCSV.html">FasterCSV</a> object when no block is provided. 
(<b>Note</b>: This is different from the standard CSV library which passes
rows to the block.   Use <a
href="FasterCSV.html#method-c-foreach">FasterCSV::foreach()</a> for that
behavior.)
</p>
<p>
An opened <a href="FasterCSV.html">FasterCSV</a> object will delegate to
many IO methods, for  convenience.  You may call:
</p>
<ul>
<li><p>
binmode()
</p>
</li>
<li><p>
close()
</p>
</li>
<li><p>
close_read()
</p>
</li>
<li><p>
close_write()
</p>
</li>
<li><p>
closed?()
</p>
</li>
<li><p>
eof()
</p>
</li>
<li><p>
eof?()
</p>
</li>
<li><p>
fcntl()
</p>
</li>
<li><p>
fileno()
</p>
</li>
<li><p>
flush()
</p>
</li>
<li><p>
fsync()
</p>
</li>
<li><p>
ioctl()
</p>
</li>
<li><p>
isatty()
</p>
</li>
<li><p>
pid()
</p>
</li>
<li><p>
pos()
</p>
</li>
<li><p>
reopen()
</p>
</li>
<li><p>
seek()
</p>
</li>
<li><p>
stat()
</p>
</li>
<li><p>
sync()
</p>
</li>
<li><p>
sync=()
</p>
</li>
<li><p>
tell()
</p>
</li>
<li><p>
to_i()
</p>
</li>
<li><p>
to_io()
</p>
</li>
<li><p>
tty?()
</p>
</li>
</ul>
					

					
					<div class="method-source-code"
						id="open-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1211</span>
1211:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">open</span>(*<span class="ruby-identifier">args</span>)
1212:       <span class="ruby-comment cmt"># find the +options+ Hash</span>
1213:       <span class="ruby-identifier">options</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">last</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Hash</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">pop</span> <span class="ruby-keyword kw">else</span> <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span> <span class="ruby-keyword kw">end</span>
1214:       <span class="ruby-comment cmt"># default to a binary open mode</span>
1215:       <span class="ruby-identifier">args</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;rb&quot;</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">args</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>
1216:       <span class="ruby-comment cmt"># wrap a File opened with the remaining +args+</span>
1217:       <span class="ruby-identifier">csv</span>     = <span class="ruby-identifier">new</span>(<span class="ruby-constant">File</span>.<span class="ruby-identifier">open</span>(*<span class="ruby-identifier">args</span>), <span class="ruby-identifier">options</span>)
1218: 
1219:       <span class="ruby-comment cmt"># handle blocks like Ruby's open(), not like the CSV library</span>
1220:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block_given?</span>
1221:         <span class="ruby-keyword kw">begin</span>
1222:           <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">csv</span>
1223:         <span class="ruby-keyword kw">ensure</span>
1224:           <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
1225:         <span class="ruby-keyword kw">end</span>
1226:       <span class="ruby-keyword kw">else</span>
1227:         <span class="ruby-identifier">csv</span>
1228:       <span class="ruby-keyword kw">end</span>
1229:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-method" class="method-detail ">
				<a name="method-c-parse"></a>

				<div class="method-heading">
				
					<span class="method-callseq">new )</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method can be used to easily parse CSV out of a String.  You may
either provide a <tt>block</tt> which will be called with each row of the
String in turn, or just use the returned Array of Arrays (when no
<tt>block</tt> is given).
</p>
<p>
You pass your <tt>str</tt> to read from, and an optional <tt>options</tt>
Hash containing anything <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
					

					
					<div class="method-source-code"
						id="parse-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1243</span>
1243:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse</span>(*<span class="ruby-identifier">args</span>, &amp;<span class="ruby-identifier">block</span>)
1244:       <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">new</span>(*<span class="ruby-identifier">args</span>)
1245:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">block</span>.<span class="ruby-identifier">nil?</span>  <span class="ruby-comment cmt"># slurp contents, if no block is given</span>
1246:         <span class="ruby-keyword kw">begin</span>
1247:           <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">read</span>
1248:         <span class="ruby-keyword kw">ensure</span>
1249:           <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">close</span>
1250:         <span class="ruby-keyword kw">end</span>
1251:       <span class="ruby-keyword kw">else</span>           <span class="ruby-comment cmt"># or pass each row to a provided block</span>
1252:         <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">each</span>(&amp;<span class="ruby-identifier">block</span>)
1253:       <span class="ruby-keyword kw">end</span>
1254:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-line-method" class="method-detail ">
				<a name="method-c-parse_line"></a>

				<div class="method-heading">
				
					<span class="method-name">parse_line</span><span
						class="method-args">(line, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This method is a shortcut for converting a single line of a CSV String into
a into an Array.  Note that if <tt>line</tt> contains multiple rows,
anything  beyond the first row is ignored.
</p>
<p>
The <tt>options</tt> parameter can be anything <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
					

					
					<div class="method-source-code"
						id="parse-line-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1263</span>
1263:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">parse_line</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1264:       <span class="ruby-identifier">new</span>(<span class="ruby-identifier">line</span>, <span class="ruby-identifier">options</span>).<span class="ruby-identifier">shift</span>
1265:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="read-method" class="method-detail ">
				<a name="method-c-read"></a>

				<div class="method-heading">
				
					<span class="method-name">read</span><span
						class="method-args">(path, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Use to slurp a CSV file into an Array of Arrays.  Pass the <tt>path</tt> to
the  file and any <tt>options</tt> <a
href="FasterCSV.html#method-c-new">FasterCSV::new()</a> understands.
</p>
					

					
					<div class="method-source-code"
						id="read-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1271</span>
1271:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1272:       <span class="ruby-identifier">open</span>(<span class="ruby-identifier">path</span>, <span class="ruby-value str">&quot;rb&quot;</span>, <span class="ruby-identifier">options</span>) { <span class="ruby-operator">|</span><span class="ruby-identifier">csv</span><span class="ruby-operator">|</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">read</span> }
1273:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="readlines-method" class="method-detail ">
				<a name="method-c-readlines"></a>

				<div class="method-heading">
				
					<span class="method-name">readlines</span><span
						class="method-args">(*args)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Alias for <a href="FasterCSV.html#method-c-read">FasterCSV::read()</a>.
</p>
					

					
					<div class="method-source-code"
						id="readlines-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1276</span>
1276:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">readlines</span>(*<span class="ruby-identifier">args</span>)
1277:       <span class="ruby-identifier">read</span>(*<span class="ruby-identifier">args</span>)
1278:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="table-method" class="method-detail ">
				<a name="method-c-table"></a>

				<div class="method-heading">
				
					<span class="method-name">table</span><span
						class="method-args">(path, options = Hash.new)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
A shortcut for:
</p>
<pre>
  FasterCSV.read( path, { :headers           =&gt; true,
                          :converters        =&gt; :numeric,
                          :header_converters =&gt; :symbol }.merge(options) )</pre>
					

					
					<div class="method-source-code"
						id="table-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1287</span>
1287:     <span class="ruby-keyword kw">def</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">table</span>(<span class="ruby-identifier">path</span>, <span class="ruby-identifier">options</span> = <span class="ruby-constant">Hash</span>.<span class="ruby-identifier">new</span>)
1288:       <span class="ruby-identifier">read</span>( <span class="ruby-identifier">path</span>, { <span class="ruby-value">:headers</span>           =<span class="ruby-operator">&gt;</span> <span class="ruby-keyword kw">true</span>,
1289:                     <span class="ruby-value">:converters</span>        =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:numeric</span>,
1290:                     <span class="ruby-value">:header_converters</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-value">:symbol</span> }.<span class="ruby-identifier">merge</span>(<span class="ruby-identifier">options</span>) )
1291:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	
		<div id="public-instance-method-details" class="method-section section">
			<h3 class="section-header">Public Instance Methods</h3>

		
			<div id="--method" class="method-detail ">
				<a name="method-i-%3C%3C"></a>

				<div class="method-heading">
				
					<span class="method-name">&lt;&lt;</span><span
						class="method-args">(row)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The primary write method for wrapped Strings and IOs, <tt>row</tt> (an
Array or <a href="FasterCSV/Row.html">FasterCSV::Row</a>) is converted to
CSV and appended to the data source.  When a <a
href="FasterCSV/Row.html">FasterCSV::Row</a> is passed, only the
row&#8217;s fields() are appended to the output.
</p>
<p>
The data source must be open for writing.
</p>
					

					
					<div class="method-source-code"
						id="--source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1475</span>
1475:     <span class="ruby-keyword kw">def</span> <span class="ruby-operator">&lt;&lt;</span>(<span class="ruby-identifier">row</span>)
1476:       <span class="ruby-comment cmt"># make sure headers have been assigned</span>
1477:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">header_row?</span> <span class="ruby-keyword kw">and</span> [<span class="ruby-constant">Array</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@use_headers</span>.<span class="ruby-identifier">class</span>
1478:         <span class="ruby-identifier">parse_headers</span>  <span class="ruby-comment cmt"># won't read data for Array or String</span>
1479:         <span class="ruby-keyword kw">self</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@headers</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@write_headers</span>
1480:       <span class="ruby-keyword kw">end</span>
1481: 
1482:       <span class="ruby-comment cmt"># Handle FasterCSV::Row objects and Hashes</span>
1483:       <span class="ruby-identifier">row</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">row</span>
1484:             <span class="ruby-keyword kw">when</span> <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">fields</span>
1485:             <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Hash</span>            <span class="ruby-keyword kw">then</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">map</span> { <span class="ruby-operator">|</span><span class="ruby-identifier">header</span><span class="ruby-operator">|</span> <span class="ruby-identifier">row</span>[<span class="ruby-identifier">header</span>] }
1486:             <span class="ruby-keyword kw">else</span>                      <span class="ruby-identifier">row</span>
1487:             <span class="ruby-keyword kw">end</span>
1488: 
1489:       <span class="ruby-ivar">@headers</span> =  <span class="ruby-identifier">row</span> <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">header_row?</span>
1490:       <span class="ruby-ivar">@lineno</span>  <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1491: 
1492:       <span class="ruby-ivar">@io</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">map</span>(&amp;<span class="ruby-ivar">@quote</span>).<span class="ruby-identifier">join</span>(<span class="ruby-ivar">@col_sep</span>) <span class="ruby-operator">+</span> <span class="ruby-ivar">@row_sep</span>  <span class="ruby-comment cmt"># quote and separate</span>
1493: 
1494:       <span class="ruby-keyword kw">self</span>  <span class="ruby-comment cmt"># for chaining</span>
1495:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="FasterCSV.html#method-i-add_row">add_row</a>, <a href="FasterCSV.html#method-i-puts">puts</a>
				</div>
				

				
			</div>

		
			<div id="add-row-method" class="method-detail method-alias">
				<a name="method-i-add_row"></a>

				<div class="method-heading">
				
					<span class="method-name">add_row</span><span
						class="method-args">(row)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="FasterCSV.html#method-i-%3C%3C">&lt;&lt;</a>
				</div>
				
			</div>

		
			<div id="convert-method" class="method-detail ">
				<a name="method-i-convert"></a>

				<div class="method-heading">
				
					<span class="method-callseq"> }</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
You can use this method to install a FasterCSV::Converters built-in, or 
provide a block that handles a custom conversion.
</p>
<p>
If you provide a block that takes one argument, it will be passed the field
and is expected to return the converted value or the field itself.  If your
block takes two arguments, it will also be passed a <a
href="FasterCSV.html#FieldInfo">FieldInfo</a> Struct,  containing details
about the field.  Again, the block should return a  converted field or the
field itself.
</p>
					

					
					<div class="method-source-code"
						id="convert-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1514</span>
1514:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">convert</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">converter</span>)
1515:       <span class="ruby-identifier">add_converter</span>(<span class="ruby-value">:converters</span>, <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">Converters</span>, <span class="ruby-identifier">name</span>, &amp;<span class="ruby-identifier">converter</span>)
1516:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="each-method" class="method-detail ">
				<a name="method-i-each"></a>

				<div class="method-heading">
				
					<span class="method-name">each</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Yields each row of the data source in turn.
</p>
<p>
Support for Enumerable.
</p>
<p>
The data source must be open for reading.
</p>
					

					
					<div class="method-source-code"
						id="each-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1545</span>
1545:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">each</span>
1546:       <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">row</span> = <span class="ruby-identifier">shift</span>
1547:         <span class="ruby-keyword kw">yield</span> <span class="ruby-identifier">row</span>
1548:       <span class="ruby-keyword kw">end</span>
1549:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="gets-method" class="method-detail method-alias">
				<a name="method-i-gets"></a>

				<div class="method-heading">
				
					<span class="method-name">gets</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="FasterCSV.html#method-i-shift">shift</a>
				</div>
				
			</div>

		
			<div id="header-convert-method" class="method-detail ">
				<a name="method-i-header_convert"></a>

				<div class="method-heading">
				
					<span class="method-callseq"> }</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Identical to <a
href="FasterCSV.html#method-i-convert">FasterCSV.convert()</a>, but for
header rows.
</p>
<p>
Note that this method must be called before header rows are read to have
any effect.
</p>
					

					
					<div class="method-source-code"
						id="header-convert-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1529</span>
1529:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">header_convert</span>(<span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">converter</span>)
1530:       <span class="ruby-identifier">add_converter</span>( <span class="ruby-value">:header_converters</span>,
1531:                      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span><span class="ruby-operator">::</span><span class="ruby-constant">HeaderConverters</span>,
1532:                      <span class="ruby-identifier">name</span>,
1533:                      &amp;<span class="ruby-identifier">converter</span> )
1534:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="header-row--method" class="method-detail ">
				<a name="method-i-header_row%3F"></a>

				<div class="method-heading">
				
					<span class="method-name">header_row?</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns <tt>true</tt> if the next row read will be a header row.
</p>
					

					
					<div class="method-source-code"
						id="header-row--source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1567</span>
1567:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">header_row?</span>
1568:       <span class="ruby-ivar">@use_headers</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">nil?</span>
1569:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="inspect-method" class="method-detail ">
				<a name="method-i-inspect"></a>

				<div class="method-heading">
				
					<span class="method-name">inspect</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Returns a simplified description of the key <a
href="FasterCSV.html">FasterCSV</a> attributes.
</p>
					

					
					<div class="method-source-code"
						id="inspect-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1696</span>
1696:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">inspect</span>
1697:       <span class="ruby-identifier">str</span> = <span class="ruby-node">&quot;&lt;##{self.class} io_type:&quot;</span>
1698:       <span class="ruby-comment cmt"># show type of wrapped IO</span>
1699:       <span class="ruby-keyword kw">if</span>    <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stdout</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;$stdout&quot;</span>
1700:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stdin</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;$stdin&quot;</span>
1701:       <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@io</span> <span class="ruby-operator">==</span> <span class="ruby-identifier">$stderr</span> <span class="ruby-keyword kw">then</span> <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;$stderr&quot;</span>
1702:       <span class="ruby-keyword kw">else</span>                      <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">to_s</span>
1703:       <span class="ruby-keyword kw">end</span>
1704:       <span class="ruby-comment cmt"># show IO.path(), if available</span>
1705:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">respond_to?</span>(<span class="ruby-value">:path</span>) <span class="ruby-keyword kw">and</span> (<span class="ruby-identifier">p</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">path</span>)
1706:         <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; io_path:#{p.inspect}&quot;</span>
1707:       <span class="ruby-keyword kw">end</span>
1708:       <span class="ruby-comment cmt"># show other attributes</span>
1709:       <span class="ruby-node">] lineno     col_sep     row_sep
1710:           quote_char skip_blanks encoding ]</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">attr_name</span><span class="ruby-operator">|</span>
1711:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">a</span> = <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{attr_name}&quot;</span>)
1712:           <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; #{attr_name}:#{a.inspect}&quot;</span>
1713:         <span class="ruby-keyword kw">end</span>
1714:       <span class="ruby-keyword kw">end</span>
1715:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@use_headers</span>
1716:         <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-node">&quot; headers:#{(@headers || true).inspect}&quot;</span>
1717:       <span class="ruby-keyword kw">end</span>
1718:       <span class="ruby-identifier">str</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-value str">&quot;&gt;&quot;</span>
1719:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="method-missing-method" class="method-detail ">
				<a name="method-i-method_missing"></a>

				<div class="method-heading">
				
					<span class="method-name">method_missing</span><span
						class="method-args">(*_)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
					<div class="method-source-code"
						id="method-missing-source">
<pre>
    <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 22</span>
22:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">method_missing</span>(*<span class="ruby-identifier">_</span>)
23:       <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">const_missing</span>
24:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="puts-method" class="method-detail method-alias">
				<a name="method-i-puts"></a>

				<div class="method-heading">
				
					<span class="method-name">puts</span><span
						class="method-args">(row)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="FasterCSV.html#method-i-%3C%3C">&lt;&lt;</a>
				</div>
				
			</div>

		
			<div id="read-method" class="method-detail ">
				<a name="method-i-read"></a>

				<div class="method-heading">
				
					<span class="method-name">read</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Slurps the remaining rows and returns an Array of Arrays.
</p>
<p>
The data source must be open for reading.
</p>
					

					
					<div class="method-source-code"
						id="read-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1556</span>
1556:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">read</span>
1557:       <span class="ruby-identifier">rows</span> = <span class="ruby-identifier">to_a</span>
1558:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@use_headers</span>
1559:         <span class="ruby-constant">Table</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">rows</span>)
1560:       <span class="ruby-keyword kw">else</span>
1561:         <span class="ruby-identifier">rows</span>
1562:       <span class="ruby-keyword kw">end</span>
1563:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="FasterCSV.html#method-i-readlines">readlines</a>
				</div>
				

				
			</div>

		
			<div id="readline-method" class="method-detail method-alias">
				<a name="method-i-readline"></a>

				<div class="method-heading">
				
					<span class="method-name">readline</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="FasterCSV.html#method-i-shift">shift</a>
				</div>
				
			</div>

		
			<div id="readlines-method" class="method-detail method-alias">
				<a name="method-i-readlines"></a>

				<div class="method-heading">
				
					<span class="method-name">readlines</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					
					

					
				</div>

				

				
				<div class="aliases">
          Alias for: <a href="FasterCSV.html#method-i-read">read</a>
				</div>
				
			</div>

		
			<div id="rewind-method" class="method-detail ">
				<a name="method-i-rewind"></a>

				<div class="method-heading">
				
					<span class="method-name">rewind</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Rewinds the underlying IO object and resets FasterCSV&#8217;s lineno()
counter.
</p>
					

					
					<div class="method-source-code"
						id="rewind-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1458</span>
1458:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">rewind</span>
1459:       <span class="ruby-ivar">@headers</span> = <span class="ruby-keyword kw">nil</span>
1460:       <span class="ruby-ivar">@lineno</span>  = <span class="ruby-value">0</span>
1461: 
1462:       <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">rewind</span>
1463:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="shift-method" class="method-detail ">
				<a name="method-i-shift"></a>

				<div class="method-heading">
				
					<span class="method-name">shift</span><span
						class="method-args">()</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The primary read method for wrapped Strings and IOs, a single row is pulled
from the data source, parsed and returned as an Array of fields (if header
rows are not used) or a <a href="FasterCSV/Row.html">FasterCSV::Row</a>
(when header rows are used).
</p>
<p>
The data source must be open for reading.
</p>
					

					
					<div class="method-source-code"
						id="shift-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1578</span>
1578:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">shift</span>
1579:       <span class="ruby-comment cmt">#########################################################################</span>
1580:       <span class="ruby-comment cmt">### This method is purposefully kept a bit long as simple conditional ###</span>
1581:       <span class="ruby-comment cmt">### checks are faster than numerous (expensive) method calls.         ###</span>
1582:       <span class="ruby-comment cmt">#########################################################################</span>
1583: 
1584:       <span class="ruby-comment cmt"># handle headers not based on document content</span>
1585:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">header_row?</span> <span class="ruby-keyword kw">and</span> <span class="ruby-ivar">@return_headers</span> <span class="ruby-keyword kw">and</span>
1586:          [<span class="ruby-constant">Array</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@use_headers</span>.<span class="ruby-identifier">class</span>
1587:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@unconverted_fields</span>
1588:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-identifier">parse_headers</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
1589:         <span class="ruby-keyword kw">else</span>
1590:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">parse_headers</span>
1591:         <span class="ruby-keyword kw">end</span>
1592:       <span class="ruby-keyword kw">end</span>
1593: 
1594:       <span class="ruby-comment cmt"># begin with a blank line, so we can always add to it</span>
1595:       <span class="ruby-identifier">line</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
1596: 
1597:       <span class="ruby-comment cmt"># </span>
1598:       <span class="ruby-comment cmt"># it can take multiple calls to &lt;tt&gt;@io.gets()&lt;/tt&gt; to get a full line,</span>
1599:       <span class="ruby-comment cmt"># because of \r and/or \n characters embedded in quoted fields</span>
1600:       <span class="ruby-comment cmt"># </span>
1601:       <span class="ruby-identifier">loop</span> <span class="ruby-keyword kw">do</span>
1602:         <span class="ruby-comment cmt"># add another read to the line</span>
1603:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">read_line</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">gets</span>(<span class="ruby-ivar">@row_sep</span>)
1604:          <span class="ruby-identifier">line</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">read_line</span>
1605:         <span class="ruby-keyword kw">else</span>
1606:          <span class="ruby-keyword kw">return</span> <span class="ruby-keyword kw">nil</span>
1607:         <span class="ruby-keyword kw">end</span>
1608:         <span class="ruby-comment cmt"># copy the line so we can chop it up in parsing</span>
1609:         <span class="ruby-identifier">parse</span> =  <span class="ruby-identifier">line</span>.<span class="ruby-identifier">dup</span>
1610:         <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">sub!</span>(<span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:line_end</span>], <span class="ruby-value str">&quot;&quot;</span>)
1611: 
1612:         <span class="ruby-comment cmt"># </span>
1613:         <span class="ruby-comment cmt"># I believe a blank line should be an &lt;tt&gt;Array.new&lt;/tt&gt;, not </span>
1614:         <span class="ruby-comment cmt"># CSV's &lt;tt&gt;[nil]&lt;/tt&gt;</span>
1615:         <span class="ruby-comment cmt"># </span>
1616:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">empty?</span>
1617:           <span class="ruby-ivar">@lineno</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1618:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@skip_blanks</span>
1619:             <span class="ruby-identifier">line</span> = <span class="ruby-value str">&quot;&quot;</span>
1620:             <span class="ruby-keyword kw">next</span>
1621:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@unconverted_fields</span>
1622:             <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
1623:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@use_headers</span>
1624:             <span class="ruby-keyword kw">return</span> <span class="ruby-constant">FasterCSV</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span>.<span class="ruby-identifier">new</span>(<span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
1625:           <span class="ruby-keyword kw">else</span>
1626:             <span class="ruby-keyword kw">return</span> <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
1627:           <span class="ruby-keyword kw">end</span>
1628:         <span class="ruby-keyword kw">end</span>
1629: 
1630:         <span class="ruby-comment cmt"># parse the fields with a mix of String#split and regular expressions</span>
1631:         <span class="ruby-identifier">csv</span>           = <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>
1632:         <span class="ruby-identifier">current_field</span> = <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
1633:         <span class="ruby-identifier">field_quotes</span>  = <span class="ruby-value">0</span>
1634:         <span class="ruby-identifier">parse</span>.<span class="ruby-identifier">split</span>(<span class="ruby-ivar">@col_sep</span>, <span class="ruby-value">1</span>).<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">match</span><span class="ruby-operator">|</span>
1635:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">current_field</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">count</span>(<span class="ruby-ivar">@quote_and_newlines</span>).<span class="ruby-identifier">zero?</span>
1636:             <span class="ruby-identifier">csv</span>           <span class="ruby-operator">&lt;&lt;</span> (<span class="ruby-identifier">match</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-keyword kw">nil</span> <span class="ruby-operator">:</span> <span class="ruby-identifier">match</span>)
1637:           <span class="ruby-keyword kw">elsif</span> (<span class="ruby-identifier">current_field</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-operator">?</span> <span class="ruby-identifier">match</span>[<span class="ruby-value">0</span>] <span class="ruby-operator">:</span> <span class="ruby-identifier">current_field</span>[<span class="ruby-value">0</span>]) <span class="ruby-operator">==</span>
1638:                 <span class="ruby-ivar">@quote_char</span>[<span class="ruby-value">0</span>]
1639:             <span class="ruby-identifier">current_field</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">match</span>
1640:             <span class="ruby-identifier">field_quotes</span> <span class="ruby-operator">+=</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">count</span>(<span class="ruby-ivar">@quote_char</span>)
1641:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field_quotes</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
1642:               <span class="ruby-identifier">in_quotes</span> = <span class="ruby-identifier">current_field</span>[<span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:quoted_field</span>], <span class="ruby-value">1</span>]
1643:               <span class="ruby-keyword kw">if</span> <span class="ruby-operator">!</span><span class="ruby-identifier">in_quotes</span> <span class="ruby-operator">||</span> <span class="ruby-identifier">in_quotes</span>[<span class="ruby-ivar">@parsers</span>[<span class="ruby-value">:stray_quote</span>]]
1644:                 <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>,
1645:                       <span class="ruby-node">&quot;Missing or stray quote in line #{lineno + 1}&quot;</span>
1646:               <span class="ruby-keyword kw">end</span>
1647:               <span class="ruby-identifier">current_field</span> = <span class="ruby-identifier">in_quotes</span>
1648:               <span class="ruby-identifier">current_field</span>.<span class="ruby-identifier">gsub!</span>(<span class="ruby-ivar">@quote_char</span> * <span class="ruby-value">2</span>, <span class="ruby-ivar">@quote_char</span>) <span class="ruby-comment cmt"># unescape contents</span>
1649:               <span class="ruby-identifier">csv</span>           <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">current_field</span>
1650:               <span class="ruby-identifier">current_field</span> =  <span class="ruby-constant">String</span>.<span class="ruby-identifier">new</span>
1651:               <span class="ruby-identifier">field_quotes</span>  =  <span class="ruby-value">0</span>
1652:             <span class="ruby-keyword kw">else</span> <span class="ruby-comment cmt"># we found a quoted field that spans multiple lines</span>
1653:               <span class="ruby-identifier">current_field</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-ivar">@col_sep</span>
1654:             <span class="ruby-keyword kw">end</span>
1655:           <span class="ruby-keyword kw">elsif</span> <span class="ruby-identifier">match</span>.<span class="ruby-identifier">count</span>(<span class="ruby-value str">&quot;\r\n&quot;</span>).<span class="ruby-identifier">zero?</span>
1656:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-node">&quot;Illegal quoting in line #{lineno + 1}.&quot;</span>
1657:           <span class="ruby-keyword kw">else</span>
1658:             <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-value str">&quot;Unquoted fields do not allow &quot;</span> <span class="ruby-operator">+</span>
1659:                                      <span class="ruby-node">&quot;\\r or \\n (line #{lineno + 1}).&quot;</span>
1660:           <span class="ruby-keyword kw">end</span>
1661:         <span class="ruby-keyword kw">end</span>
1662: 
1663:         <span class="ruby-comment cmt"># if parse is empty?(), we found all the fields on the line...</span>
1664:         <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field_quotes</span> <span class="ruby-operator">%</span> <span class="ruby-value">2</span> <span class="ruby-operator">==</span> <span class="ruby-value">0</span>
1665:           <span class="ruby-ivar">@lineno</span> <span class="ruby-operator">+=</span> <span class="ruby-value">1</span>
1666: 
1667:           <span class="ruby-comment cmt"># save fields unconverted fields, if needed...</span>
1668:           <span class="ruby-identifier">unconverted</span> = <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">dup</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@unconverted_fields</span>
1669: 
1670:           <span class="ruby-comment cmt"># convert fields, if needed...</span>
1671:           <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">convert_fields</span>(<span class="ruby-identifier">csv</span>) <span class="ruby-keyword kw">unless</span> <span class="ruby-ivar">@use_headers</span> <span class="ruby-keyword kw">or</span> <span class="ruby-ivar">@converters</span>.<span class="ruby-identifier">empty?</span>
1672:           <span class="ruby-comment cmt"># parse out header rows and handle FasterCSV::Row conversions...</span>
1673:           <span class="ruby-identifier">csv</span> = <span class="ruby-identifier">parse_headers</span>(<span class="ruby-identifier">csv</span>)  <span class="ruby-keyword kw">if</span>     <span class="ruby-ivar">@use_headers</span>
1674: 
1675:           <span class="ruby-comment cmt"># inject unconverted fields and accessor, if requested...</span>
1676:           <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@unconverted_fields</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-identifier">csv</span>.<span class="ruby-identifier">respond_to?</span> <span class="ruby-value">:unconverted_fields</span>
1677:             <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-identifier">csv</span>, <span class="ruby-identifier">unconverted</span>)
1678:           <span class="ruby-keyword kw">end</span>
1679: 
1680:           <span class="ruby-comment cmt"># return the results</span>
1681:           <span class="ruby-keyword kw">break</span> <span class="ruby-identifier">csv</span>
1682:         <span class="ruby-keyword kw">end</span>
1683:         <span class="ruby-comment cmt"># if we're not empty?() but at eof?(), a quoted field wasn't closed...</span>
1684:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
1685:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-node">&quot;Unclosed quoted field on line #{lineno + 1}.&quot;</span>
1686:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-ivar">@field_size_limit</span> <span class="ruby-keyword kw">and</span> <span class="ruby-identifier">current_field</span>.<span class="ruby-identifier">size</span> <span class="ruby-operator">&gt;=</span> <span class="ruby-ivar">@field_size_limit</span>
1687:           <span class="ruby-identifier">raise</span> <span class="ruby-constant">MalformedCSVError</span>, <span class="ruby-node">&quot;Field size exceeded on line #{lineno + 1}.&quot;</span>
1688:         <span class="ruby-keyword kw">end</span>
1689:         <span class="ruby-comment cmt"># otherwise, we need to loop and pull some more data to complete the row</span>
1690:       <span class="ruby-keyword kw">end</span>
1691:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				
				<div class="aliases">
					Also aliased as: <a href="FasterCSV.html#method-i-gets">gets</a>, <a href="FasterCSV.html#method-i-readline">readline</a>
				</div>
				

				
			</div>

		
		</div>
	
		<div id="private-instance-method-details" class="method-section section">
			<h3 class="section-header">Private Instance Methods</h3>

		
			<div id="add-converter-method" class="method-detail ">
				<a name="method-i-add_converter"></a>

				<div class="method-heading">
				
					<span class="method-name">add_converter</span><span
						class="method-args">(var_name, const, name = nil, &converter)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
The actual work method for adding converters, used by both  <a
href="FasterCSV.html#method-i-convert">FasterCSV.convert()</a> and <a
href="FasterCSV.html#method-i-header_convert">FasterCSV.header_convert()</a>.
</p>
<p>
This method requires the <tt>var_name</tt> of the instance variable to
place the converters in, the <tt>const</tt> Hash to lookup named converters
in, and the normal parameters of the <a
href="FasterCSV.html#method-i-convert">FasterCSV.convert()</a> and <a
href="FasterCSV.html#method-i-header_convert">FasterCSV.header_convert()</a>
methods.
</p>
					

					
					<div class="method-source-code"
						id="add-converter-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1905</span>
1905:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_converter</span>(<span class="ruby-identifier">var_name</span>, <span class="ruby-identifier">const</span>, <span class="ruby-identifier">name</span> = <span class="ruby-keyword kw">nil</span>, &amp;<span class="ruby-identifier">converter</span>)
1906:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">name</span>.<span class="ruby-identifier">nil?</span>  <span class="ruby-comment cmt"># custom converter</span>
1907:         <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{var_name}&quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">converter</span>
1908:       <span class="ruby-keyword kw">else</span>          <span class="ruby-comment cmt"># named converter</span>
1909:         <span class="ruby-identifier">combo</span> = <span class="ruby-identifier">const</span>[<span class="ruby-identifier">name</span>]
1910:         <span class="ruby-keyword kw">case</span> <span class="ruby-identifier">combo</span>
1911:         <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>  <span class="ruby-comment cmt"># combo converter</span>
1912:           <span class="ruby-identifier">combo</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">converter_name</span><span class="ruby-operator">|</span>
1913:             <span class="ruby-identifier">add_converter</span>(<span class="ruby-identifier">var_name</span>, <span class="ruby-identifier">const</span>, <span class="ruby-identifier">converter_name</span>)
1914:           <span class="ruby-keyword kw">end</span>
1915:         <span class="ruby-keyword kw">else</span>        <span class="ruby-comment cmt"># individual named converter</span>
1916:           <span class="ruby-identifier">instance_variable_get</span>(<span class="ruby-node">&quot;@#{var_name}&quot;</span>) <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">combo</span>
1917:         <span class="ruby-keyword kw">end</span>
1918:       <span class="ruby-keyword kw">end</span>
1919:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="add-unconverted-fields-method" class="method-detail ">
				<a name="method-i-add_unconverted_fields"></a>

				<div class="method-heading">
				
					<span class="method-name">add_unconverted_fields</span><span
						class="method-args">(row, fields)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Thiw methods injects an instance variable <tt>unconverted_fields</tt> into
<tt>row</tt> and an accessor method for it called unconverted_fields(). 
The variable is set to the contents of <tt>fields</tt>.
</p>
					

					
					<div class="method-source-code"
						id="add-unconverted-fields-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1990</span>
1990:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">add_unconverted_fields</span>(<span class="ruby-identifier">row</span>, <span class="ruby-identifier">fields</span>)
1991:       <span class="ruby-keyword kw">class</span> <span class="ruby-operator">&lt;&lt;</span> <span class="ruby-identifier">row</span>
1992:         <span class="ruby-identifier">attr_reader</span> <span class="ruby-value">:unconverted_fields</span>
1993:       <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="convert-fields-method" class="method-detail ">
				<a name="method-i-convert_fields"></a>

				<div class="method-heading">
				
					<span class="method-name">convert_fields</span><span
						class="method-args">(fields, headers = false)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Processes <tt>fields</tt> with <tt>@converters</tt>, or
<tt>@header_converters</tt> if <tt>headers</tt> is passed as <tt>true</tt>,
returning the converted field set.  Any converter that changes the field
into something other than a String halts the pipeline of conversion for
that field.  This is primarily an efficiency shortcut.
</p>
					

					
					<div class="method-source-code"
						id="convert-fields-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1928</span>
1928:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">convert_fields</span>(<span class="ruby-identifier">fields</span>, <span class="ruby-identifier">headers</span> = <span class="ruby-keyword kw">false</span>)
1929:       <span class="ruby-comment cmt"># see if we are converting headers or fields</span>
1930:       <span class="ruby-identifier">converters</span> = <span class="ruby-identifier">headers</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@header_converters</span> <span class="ruby-operator">:</span> <span class="ruby-ivar">@converters</span>
1931: 
1932:       <span class="ruby-identifier">fields</span>.<span class="ruby-identifier">enum_for</span>(<span class="ruby-value">:each_with_index</span>).<span class="ruby-identifier">map</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span>, <span class="ruby-identifier">index</span><span class="ruby-operator">|</span>  <span class="ruby-comment cmt"># map_with_index</span>
1933:         <span class="ruby-identifier">converters</span>.<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">converter</span><span class="ruby-operator">|</span>
1934:           <span class="ruby-identifier">field</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">converter</span>.<span class="ruby-identifier">arity</span> <span class="ruby-operator">==</span> <span class="ruby-value">1</span>  <span class="ruby-comment cmt"># straight field converter</span>
1935:             <span class="ruby-identifier">converter</span>[<span class="ruby-identifier">field</span>]
1936:           <span class="ruby-keyword kw">else</span>                             <span class="ruby-comment cmt"># FieldInfo converter</span>
1937:             <span class="ruby-identifier">header</span> = <span class="ruby-ivar">@use_headers</span> <span class="ruby-operator">&amp;&amp;</span> <span class="ruby-operator">!</span><span class="ruby-identifier">headers</span> <span class="ruby-operator">?</span> <span class="ruby-ivar">@headers</span>[<span class="ruby-identifier">index</span>] <span class="ruby-operator">:</span> <span class="ruby-keyword kw">nil</span>
1938:             <span class="ruby-identifier">converter</span>[<span class="ruby-identifier">field</span>, <span class="ruby-constant">FieldInfo</span>.<span class="ruby-identifier">new</span>(<span class="ruby-identifier">index</span>, <span class="ruby-identifier">lineno</span>, <span class="ruby-identifier">header</span>)]
1939:           <span class="ruby-keyword kw">end</span>
1940:           <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">field</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">String</span>  <span class="ruby-comment cmt"># short-curcuit pipeline for speed</span>
1941:         <span class="ruby-keyword kw">end</span>
1942:         <span class="ruby-identifier">field</span>  <span class="ruby-comment cmt"># return final state of each field, converted or original</span>
1943:       <span class="ruby-keyword kw">end</span>
1944:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="init-converters-method" class="method-detail ">
				<a name="method-i-init_converters"></a>

				<div class="method-heading">
				
					<span class="method-name">init_converters</span><span
						class="method-args">(options, field_name = :converters)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Loads any converters requested during construction.
</p>
<p>
If <tt>field_name</tt> is set <tt>:converters</tt> (the default) field
converters are set.  When <tt>field_name</tt> is
<tt>:header_converters</tt> header converters are added instead.
</p>
<p>
The <tt>:unconverted_fields</tt> option is also actived for 
<tt>:converters</tt> calls, if requested.
</p>
					

					
					<div class="method-source-code"
						id="init-converters-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1855</span>
1855:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_converters</span>(<span class="ruby-identifier">options</span>, <span class="ruby-identifier">field_name</span> = <span class="ruby-value">:converters</span>)
1856:       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field_name</span> <span class="ruby-operator">==</span> <span class="ruby-value">:converters</span>
1857:         <span class="ruby-ivar">@unconverted_fields</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:unconverted_fields</span>)
1858:       <span class="ruby-keyword kw">end</span>
1859: 
1860:       <span class="ruby-identifier">instance_variable_set</span>(<span class="ruby-node">&quot;@#{field_name}&quot;</span>, <span class="ruby-constant">Array</span>.<span class="ruby-identifier">new</span>)
1861: 
1862:       <span class="ruby-comment cmt"># find the correct method to add the coverters</span>
1863:       <span class="ruby-identifier">convert</span> = <span class="ruby-identifier">method</span>(<span class="ruby-identifier">field_name</span>.<span class="ruby-identifier">to_s</span>.<span class="ruby-identifier">sub</span>(<span class="ruby-regexp re">/ers\Z/</span>, <span class="ruby-value str">&quot;&quot;</span>))
1864: 
1865:       <span class="ruby-comment cmt"># load converters</span>
1866:       <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">field_name</span>].<span class="ruby-identifier">nil?</span>
1867:         <span class="ruby-comment cmt"># allow a single converter not wrapped in an Array</span>
1868:         <span class="ruby-keyword kw">unless</span> <span class="ruby-identifier">options</span>[<span class="ruby-identifier">field_name</span>].<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Array</span>
1869:           <span class="ruby-identifier">options</span>[<span class="ruby-identifier">field_name</span>] = [<span class="ruby-identifier">options</span>[<span class="ruby-identifier">field_name</span>]]
1870:         <span class="ruby-keyword kw">end</span>
1871:         <span class="ruby-comment cmt"># load each converter...</span>
1872:         <span class="ruby-identifier">options</span>[<span class="ruby-identifier">field_name</span>].<span class="ruby-identifier">each</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">converter</span><span class="ruby-operator">|</span>
1873:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">converter</span>.<span class="ruby-identifier">is_a?</span> <span class="ruby-constant">Proc</span>  <span class="ruby-comment cmt"># custom code block</span>
1874:             <span class="ruby-identifier">convert</span>.<span class="ruby-identifier">call</span>(&amp;<span class="ruby-identifier">converter</span>)
1875:           <span class="ruby-keyword kw">else</span>                     <span class="ruby-comment cmt"># by name</span>
1876:             <span class="ruby-identifier">convert</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">converter</span>)
1877:           <span class="ruby-keyword kw">end</span>
1878:         <span class="ruby-keyword kw">end</span>
1879:       <span class="ruby-keyword kw">end</span>
1880: 
1881:       <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-identifier">field_name</span>)
1882:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="init-headers-method" class="method-detail ">
				<a name="method-i-init_headers"></a>

				<div class="method-heading">
				
					<span class="method-name">init_headers</span><span
						class="method-args">(options)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Stores header row settings and loads header converters, if needed.
</p>
					

					
					<div class="method-source-code"
						id="init-headers-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1885</span>
1885:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_headers</span>(<span class="ruby-identifier">options</span>)
1886:       <span class="ruby-ivar">@use_headers</span>    = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:headers</span>)
1887:       <span class="ruby-ivar">@return_headers</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:return_headers</span>)
1888:       <span class="ruby-ivar">@write_headers</span>  = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:write_headers</span>)
1889: 
1890:       <span class="ruby-comment cmt"># headers must be delayed until shift(), in case they need a row of content</span>
1891:       <span class="ruby-ivar">@headers</span> = <span class="ruby-keyword kw">nil</span>
1892: 
1893:       <span class="ruby-identifier">init_converters</span>(<span class="ruby-identifier">options</span>, <span class="ruby-value">:header_converters</span>)
1894:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="init-parsers-method" class="method-detail ">
				<a name="method-i-init_parsers"></a>

				<div class="method-heading">
				
					<span class="method-name">init_parsers</span><span
						class="method-args">(options)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Pre-compiles parsers and stores them by name for access during reads.
</p>
					

					
					<div class="method-source-code"
						id="init-parsers-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1820</span>
1820:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_parsers</span>(<span class="ruby-identifier">options</span>)
1821:       <span class="ruby-comment cmt"># store the parser behaviors</span>
1822:       <span class="ruby-ivar">@skip_blanks</span>      = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:skip_blanks</span>)
1823:       <span class="ruby-ivar">@encoding</span>         = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:encoding</span>)  <span class="ruby-comment cmt"># nil will use $KCODE</span>
1824:       <span class="ruby-ivar">@field_size_limit</span> = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:field_size_limit</span>)
1825: 
1826:       <span class="ruby-comment cmt"># prebuild Regexps for faster parsing</span>
1827:       <span class="ruby-identifier">esc_col_sep</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@col_sep</span>)
1828:       <span class="ruby-identifier">esc_row_sep</span> = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@row_sep</span>)
1829:       <span class="ruby-identifier">esc_quote</span>   = <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">escape</span>(<span class="ruby-ivar">@quote_char</span>)
1830:       <span class="ruby-ivar">@parsers</span> = {
1831:         <span class="ruby-value">:any_field</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;[^#{esc_col_sep}]+&quot;</span>,
1832:                                      <span class="ruby-constant">Regexp</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTILINE</span>,
1833:                                      <span class="ruby-ivar">@encoding</span> ),
1834:         <span class="ruby-value">:quoted_field</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;^#{esc_quote}(.*)#{esc_quote}$&quot;</span>,
1835:                                      <span class="ruby-constant">Regexp</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTILINE</span>,
1836:                                      <span class="ruby-ivar">@encoding</span> ),
1837:         <span class="ruby-value">:stray_quote</span>  =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>( <span class="ruby-node">&quot;[^#{esc_quote}]#{esc_quote}[^#{esc_quote}]&quot;</span>,
1838:                                      <span class="ruby-constant">Regexp</span><span class="ruby-operator">::</span><span class="ruby-constant">MULTILINE</span>,
1839:                                      <span class="ruby-ivar">@encoding</span> ),
1840:         <span class="ruby-comment cmt"># safer than chomp!()</span>
1841:         <span class="ruby-value">:line_end</span>     =<span class="ruby-operator">&gt;</span> <span class="ruby-constant">Regexp</span>.<span class="ruby-identifier">new</span>(<span class="ruby-node">&quot;#{esc_row_sep}\\z&quot;</span>, <span class="ruby-keyword kw">nil</span>, <span class="ruby-ivar">@encoding</span>)
1842:       }
1843:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="init-separators-method" class="method-detail ">
				<a name="method-i-init_separators"></a>

				<div class="method-heading">
				
					<span class="method-name">init_separators</span><span
						class="method-args">(options)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
Stores the indicated separators for later use.
</p>
<p>
If auto-discovery was requested for <tt>@row_sep</tt>, this method will
read ahead in the <tt>@io</tt> and try to find one.  <tt>ARGF</tt>,
<tt>STDIN</tt>, <tt>STDOUT</tt>, <tt>STDERR</tt> and any stream open for
output only with a default <tt>@row_sep</tt> of
<tt>$INPUT_RECORD_SEPARATOR</tt> (<tt>$/</tt>).
</p>
<p>
This method also establishes the quoting rules used for CSV output.
</p>
					

					
					<div class="method-source-code"
						id="init-separators-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1733</span>
1733:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">init_separators</span>(<span class="ruby-identifier">options</span>)
1734:       <span class="ruby-comment cmt"># store the selected separators</span>
1735:       <span class="ruby-ivar">@col_sep</span>            = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:col_sep</span>)
1736:       <span class="ruby-ivar">@row_sep</span>            = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:row_sep</span>)
1737:       <span class="ruby-ivar">@quote_char</span>         = <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:quote_char</span>)
1738:       <span class="ruby-ivar">@quote_and_newlines</span> = <span class="ruby-node">&quot;\r\n#{@quote_char}&quot;</span>
1739: 
1740:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@quote_char</span>.<span class="ruby-identifier">length</span> <span class="ruby-operator">!=</span> <span class="ruby-value">1</span>
1741:         <span class="ruby-identifier">raise</span> <span class="ruby-constant">ArgumentError</span>, <span class="ruby-value str">&quot;:quote_char has to be a single character String&quot;</span>
1742:       <span class="ruby-keyword kw">end</span>
1743: 
1744:       <span class="ruby-comment cmt"># automatically discover row separator when requested</span>
1745:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@row_sep</span> <span class="ruby-operator">==</span> <span class="ruby-value">:auto</span>
1746:         <span class="ruby-keyword kw">begin</span>
1747:           <span class="ruby-comment cmt">#</span>
1748:           <span class="ruby-comment cmt"># remember where we were (pos() will raise an axception if @io is pipe</span>
1749:           <span class="ruby-comment cmt"># or not opened for reading)</span>
1750:           <span class="ruby-comment cmt">#</span>
1751:           <span class="ruby-identifier">saved_pos</span> = <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">pos</span>
1752:           <span class="ruby-keyword kw">while</span> <span class="ruby-ivar">@row_sep</span> <span class="ruby-operator">==</span> <span class="ruby-value">:auto</span>
1753:             <span class="ruby-comment cmt">#</span>
1754:             <span class="ruby-comment cmt"># if we run out of data, it's probably a single line</span>
1755:             <span class="ruby-comment cmt"># (ensure will set default value)</span>
1756:             <span class="ruby-comment cmt">#</span>
1757:             <span class="ruby-keyword kw">break</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
1758: 
1759:             <span class="ruby-comment cmt"># read ahead a bit</span>
1760:             <span class="ruby-identifier">sample</span> =  <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">1024</span>)
1761:             <span class="ruby-identifier">sample</span> <span class="ruby-operator">+=</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">1</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sample</span>[<span class="ruby-value">1</span><span class="ruby-operator">..</span><span class="ruby-value">1</span>] <span class="ruby-operator">==</span> <span class="ruby-value str">&quot;\r&quot;</span> <span class="ruby-keyword kw">and</span> <span class="ruby-keyword kw">not</span> <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">eof?</span>
1762: 
1763:             <span class="ruby-comment cmt"># try to find a standard separator</span>
1764:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">sample</span> <span class="ruby-operator">=~</span> <span class="ruby-regexp re">/\r\n?|\n/</span>
1765:               <span class="ruby-ivar">@row_sep</span> = <span class="ruby-node">$&amp;</span>
1766:               <span class="ruby-keyword kw">break</span>
1767:             <span class="ruby-keyword kw">end</span>
1768:           <span class="ruby-keyword kw">end</span>
1769: 
1770:           <span class="ruby-comment cmt"># tricky seek() clone to work around GzipReader's lack of seek()</span>
1771:           <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">rewind</span>
1772:           <span class="ruby-comment cmt"># reset back to the remembered position</span>
1773:           <span class="ruby-keyword kw">while</span> <span class="ruby-identifier">saved_pos</span> <span class="ruby-operator">&gt;</span> <span class="ruby-value">1024</span>  <span class="ruby-comment cmt"># avoid loading a lot of data into memory</span>
1774:             <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-value">1024</span>)
1775:             <span class="ruby-identifier">saved_pos</span> <span class="ruby-operator">-=</span> <span class="ruby-value">1024</span>
1776:           <span class="ruby-keyword kw">end</span>
1777:           <span class="ruby-ivar">@io</span>.<span class="ruby-identifier">read</span>(<span class="ruby-identifier">saved_pos</span>) <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">saved_pos</span>.<span class="ruby-identifier">nonzero?</span>
1778:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">IOError</span>         <span class="ruby-comment cmt"># not opened for reading</span>
1779:           <span class="ruby-comment cmt"># do nothing:  ensure will set default</span>
1780:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">NoMethodError</span>   <span class="ruby-comment cmt"># Zlib::GzipWriter doesn't have eof?</span>
1781:           <span class="ruby-comment cmt"># do nothing:  ensure will set default</span>
1782:         <span class="ruby-keyword kw">rescue</span> <span class="ruby-constant">SystemCallError</span> <span class="ruby-comment cmt"># pipe</span>
1783:           <span class="ruby-comment cmt"># do nothing:  ensure will set default</span>
1784:         <span class="ruby-keyword kw">ensure</span>
1785:           <span class="ruby-comment cmt">#</span>
1786:           <span class="ruby-comment cmt"># set default if we failed to detect</span>
1787:           <span class="ruby-comment cmt"># (stream not opened for reading, a pipe, or a single line of data)</span>
1788:           <span class="ruby-comment cmt">#</span>
1789:           <span class="ruby-ivar">@row_sep</span> = <span class="ruby-identifier">$INPUT_RECORD_SEPARATOR</span> <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@row_sep</span> <span class="ruby-operator">==</span> <span class="ruby-value">:auto</span>
1790:         <span class="ruby-keyword kw">end</span>
1791:       <span class="ruby-keyword kw">end</span>
1792: 
1793:       <span class="ruby-comment cmt"># establish quoting rules</span>
1794:       <span class="ruby-identifier">do_quote</span> = <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>
1795:         <span class="ruby-ivar">@quote_char</span>                                      <span class="ruby-operator">+</span>
1796:         <span class="ruby-constant">String</span>(<span class="ruby-identifier">field</span>).<span class="ruby-identifier">gsub</span>(<span class="ruby-ivar">@quote_char</span>, <span class="ruby-ivar">@quote_char</span> * <span class="ruby-value">2</span>) <span class="ruby-operator">+</span>
1797:         <span class="ruby-ivar">@quote_char</span>
1798:       <span class="ruby-keyword kw">end</span>
1799:       <span class="ruby-ivar">@quote</span> = <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">options</span>.<span class="ruby-identifier">delete</span>(<span class="ruby-value">:force_quotes</span>)
1800:         <span class="ruby-identifier">do_quote</span>
1801:       <span class="ruby-keyword kw">else</span>
1802:         <span class="ruby-identifier">lambda</span> <span class="ruby-keyword kw">do</span> <span class="ruby-operator">|</span><span class="ruby-identifier">field</span><span class="ruby-operator">|</span>
1803:           <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field</span>.<span class="ruby-identifier">nil?</span>  <span class="ruby-comment cmt"># represent +nil+ fields as empty unquoted fields</span>
1804:             <span class="ruby-value str">&quot;&quot;</span>
1805:           <span class="ruby-keyword kw">else</span>
1806:             <span class="ruby-identifier">field</span> = <span class="ruby-constant">String</span>(<span class="ruby-identifier">field</span>)  <span class="ruby-comment cmt"># Stringify fields</span>
1807:             <span class="ruby-comment cmt"># represent empty fields as empty quoted fields</span>
1808:             <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">field</span>.<span class="ruby-identifier">empty?</span> <span class="ruby-keyword kw">or</span>
1809:                <span class="ruby-identifier">field</span>.<span class="ruby-identifier">count</span>(<span class="ruby-node">&quot;\r\n#{@col_sep}#{@quote_char}&quot;</span>).<span class="ruby-identifier">nonzero?</span>
1810:               <span class="ruby-identifier">do_quote</span>.<span class="ruby-identifier">call</span>(<span class="ruby-identifier">field</span>)
1811:             <span class="ruby-keyword kw">else</span>
1812:               <span class="ruby-identifier">field</span>  <span class="ruby-comment cmt"># unquoted field</span>
1813:             <span class="ruby-keyword kw">end</span>
1814:           <span class="ruby-keyword kw">end</span>
1815:         <span class="ruby-keyword kw">end</span>
1816:       <span class="ruby-keyword kw">end</span>
1817:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
			<div id="parse-headers-method" class="method-detail ">
				<a name="method-i-parse_headers"></a>

				<div class="method-heading">
				
					<span class="method-name">parse_headers</span><span
						class="method-args">(row = nil)</span>
					<span class="method-click-advice">click to toggle source</span>
				
				</div>

				<div class="method-description">
					
					<p>
This methods is used to turn a finished <tt>row</tt> into a <a
href="FasterCSV/Row.html">FasterCSV::Row</a>.  Header rows are also dealt
with here, either by returning a <a
href="FasterCSV/Row.html">FasterCSV::Row</a> with identical headers and
fields (save that the fields do not go through the converters) or by
reading past them to return a field row. Headers are also saved in
<tt>@headers</tt> for use in future rows.
</p>
<p>
When <tt>nil</tt>, <tt>row</tt> is assumed to be a header row not based on
an actual row of the stream.
</p>
					

					
					<div class="method-source-code"
						id="parse-headers-source">
<pre>
      <span class="ruby-comment cmt"># File lib/faster_csv.rb, line 1956</span>
1956:     <span class="ruby-keyword kw">def</span> <span class="ruby-identifier">parse_headers</span>(<span class="ruby-identifier">row</span> = <span class="ruby-keyword kw">nil</span>)
1957:       <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@headers</span>.<span class="ruby-identifier">nil?</span>                <span class="ruby-comment cmt"># header row</span>
1958:         <span class="ruby-ivar">@headers</span> = <span class="ruby-keyword kw">case</span> <span class="ruby-ivar">@use_headers</span>  <span class="ruby-comment cmt"># save headers</span>
1959:                    <span class="ruby-comment cmt"># Array of headers</span>
1960:                    <span class="ruby-keyword kw">when</span> <span class="ruby-constant">Array</span>  <span class="ruby-keyword kw">then</span> <span class="ruby-ivar">@use_headers</span>
1961:                    <span class="ruby-comment cmt"># CSV header String</span>
1962:                    <span class="ruby-keyword kw">when</span> <span class="ruby-constant">String</span>
1963:                      <span class="ruby-keyword kw">self</span>.<span class="ruby-identifier">class</span>.<span class="ruby-identifier">parse_line</span>( <span class="ruby-ivar">@use_headers</span>,
1964:                                             <span class="ruby-value">:col_sep</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@col_sep</span>,
1965:                                             <span class="ruby-value">:row_sep</span>    =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@row_sep</span>,
1966:                                             <span class="ruby-value">:quote_char</span> =<span class="ruby-operator">&gt;</span> <span class="ruby-ivar">@quote_char</span> )
1967:                    <span class="ruby-comment cmt"># first row is headers</span>
1968:                    <span class="ruby-keyword kw">else</span>             <span class="ruby-identifier">row</span>
1969:                    <span class="ruby-keyword kw">end</span>
1970: 
1971:         <span class="ruby-comment cmt"># prepare converted and unconverted copies</span>
1972:         <span class="ruby-identifier">row</span>      = <span class="ruby-ivar">@headers</span>                       <span class="ruby-keyword kw">if</span> <span class="ruby-identifier">row</span>.<span class="ruby-identifier">nil?</span>
1973:         <span class="ruby-ivar">@headers</span> = <span class="ruby-identifier">convert_fields</span>(<span class="ruby-ivar">@headers</span>, <span class="ruby-keyword kw">true</span>)
1974: 
1975:         <span class="ruby-keyword kw">if</span> <span class="ruby-ivar">@return_headers</span>                                     <span class="ruby-comment cmt"># return headers</span>
1976:           <span class="ruby-keyword kw">return</span> <span class="ruby-constant">FasterCSV</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@headers</span>, <span class="ruby-identifier">row</span>, <span class="ruby-keyword kw">true</span>)
1977:         <span class="ruby-keyword kw">elsif</span> <span class="ruby-keyword kw">not</span> [<span class="ruby-constant">Array</span>, <span class="ruby-constant">String</span>].<span class="ruby-identifier">include?</span> <span class="ruby-ivar">@use_headers</span>.<span class="ruby-identifier">class</span>  <span class="ruby-comment cmt"># skip to field row</span>
1978:           <span class="ruby-keyword kw">return</span> <span class="ruby-identifier">shift</span>
1979:         <span class="ruby-keyword kw">end</span>
1980:       <span class="ruby-keyword kw">end</span>
1981: 
1982:       <span class="ruby-constant">FasterCSV</span><span class="ruby-operator">::</span><span class="ruby-constant">Row</span>.<span class="ruby-identifier">new</span>(<span class="ruby-ivar">@headers</span>, <span class="ruby-identifier">convert_fields</span>(<span class="ruby-identifier">row</span>))  <span class="ruby-comment cmt"># field row</span>
1983:     <span class="ruby-keyword kw">end</span></pre>
					</div>
					
				</div>

				

				
			</div>

		
		</div>
	

	</div>


	<div id="rdoc-debugging-section-dump" class="debugging-section">
	
		<p>Disabled; run with --debug to generate this.</p>
	
	</div>

	<div id="validator-badges">
		<p><small><a href="http://validator.w3.org/check/referer">[Validate]</a></small></p>
		<p><small>Generated with the <a href="http://deveiate.org/projects/Darkfish-Rdoc/">Darkfish
			Rdoc Generator</a> 1.1.6</small>.</p>
	</div>

</body>
</html>

